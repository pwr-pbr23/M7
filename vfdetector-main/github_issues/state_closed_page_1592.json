[{"number": 5152, "title": "cmake build doesn't work for debug build", "body": "On Windows, cmake build work fine for release build.\n\nBut for debug build, some projects are still using Release settings, for example:\n\nprotobuf\\src\\protobuf\\Release\\protoc.exe is used, should be protobuf\\src\\protobuf\\Debug\\protoc.exe\nzlib.lib is used, should be zlibd.lib\n", "comments": ["Thanks for the report @cg31 \nI'm not sure whether the intention with the Debug build is to use the debug build of external dependencies as well, or restrict the  debug build to apply to TensorFlow code.\n\n@mrry will have more insight.\n", "Hi, thanks for reponse.\n\nLooks like the tool/lib being used in build are specified by the option to invokde cmake, -DCMAKE_BUILD_TYPE=Release or -DCMAKE_BUILD_TYPE=Debug.\n\nWhen -DCMAKE_BUILD_TYPE=Release (or Debug) is used, the generated projects can only used to build that type. Ideally, the projects should be able to build both Debug and Release build.\n", "OK, the readme states clearly that Debug type is not supportly not.\n\nThis is not an issue. I am going to close this.\n", "Just to follow up on this, as you realized there's no current support for Debug builds using TensorFlow-on-Windows, and the recommended workaround is to use RelWithDebInfo, so that you can use the VS debugger etc.\n\nIf anybody wanted to contribute support for the Debug build, that'd be great!\n"]}, {"number": 5151, "title": "Error with running tensorflow/tensorflow/examples/tutorials/mnist/fully_connected_feed.py", "body": "I am not able to run the example for mnist\n$ python fully_connected_feed.py \nExtracting data/train-images-idx3-ubyte.gz\nExtracting data/train-labels-idx1-ubyte.gz\nExtracting data/t10k-images-idx3-ubyte.gz\nExtracting data/t10k-labels-idx1-ubyte.gz\nError Log: Traceback (most recent call last):\n  File \"fully_connected_feed.py\", line 268, in <module>\n    tf.app.run()\n  File \"/home/aashishk/anaconda2/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv))\n  File \"fully_connected_feed.py\", line 219, in main\n    run_training()\n  File \"fully_connected_feed.py\", line 143, in run_training\n    **summary = tf.summary.merge_all()\nAttributeError: 'module' object has no attribute 'merge_all'**\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n\nhttp://stackoverflow.com/questions/33772833/error-while-merging-summaries-for-tensorboard\n### Environment info\n\nOperating System: Ubuntu\n\nInstalled version of CUDA and cuDNN: \n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`): none\n\n**Tensorflow** **0.10.0** installed using **conda** **4.2.9**\nI am only taking the examples folder from here to test with the above version\n", "comments": ["@aashish-kumar : It seems you're running `fully_connected_feed.py` from the HEAD of the git repository, which is incompatible with the release version (in particular because of change https://github.com/tensorflow/tensorflow/commit/8532897352ada1d8ecd3ca1dd17aaa869a42d4b8)\n\nMany examples are installed with the release, so you would find some files in:\n`/home/aashishk/anaconda2/envs/tensorflow/lib/python2.7/site-packages/tensorflow/examples/tutorials/mnist`\n\nHowever, since `fully_connected_feed.py` is not used in the website tutorials, we don't include it with the release. That said, you can find the versions that work with the release in the release branches on git.\n- [For 0.10](https://github.com/tensorflow/tensorflow/tree/r0.10/tensorflow/examples/tutorials/mnist)\n- [For 0.11](https://github.com/tensorflow/tensorflow/tree/r0.11/tensorflow/examples/tutorials/mnist)\n\nHope that explains the situation and helps you get out of it :)\nI'm going to close this issue since I believe it is resolved, but if not, feel free to reopen it.\n\nThanks!\n"]}, {"number": 5150, "title": "Revert \"extend tf.select to broadcast a scalar condition #3945\"", "body": "Reverts tensorflow/tensorflow#5127\n", "comments": ["@drpngx, thanks for your PR! By analyzing the history of the files in this pull request, we identified @Mistobaan, @keveman and @tensorflower-gardener to be potential reviewers.\n", "Jenkins, test this please.\n", "Jenkins, test this please.\n"]}, {"number": 5149, "title": "Error installing from source", "body": "In the procedure of installing from source, \nwhen I try to do \"bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\"\n\nthen an error occurs and the message is like this:\n\"error: can't copy 'tensorflow/models/embedding/gen_word2vec.py': doesn't exist or not a regular file\"\n\nIn the directory of '_tensorflow/models/embedding/_', there does not exist named \"gen_word2vec.py\", only \"word2vec.py\" is in there.\n(Changing the file name \"word2vec.py\" as \"gen_word2vec.py\", but it does not make it.)\n\nOS : OS X El Capitan(10.11.6)\nTensorFlow : r0.11(Same problem occurs r0.10)\n\nIn #4234, recommended method is installing the TF's branch r0.10, but it does not work for me.\nHow can I solve it?\n\n<img width=\"656\" alt=\"2016-10-23 8 05 16\" src=\"https://cloud.githubusercontent.com/assets/22737703/19625753/111ae2aa-995c-11e6-93c0-464fb1443589.png\">\n", "comments": ["@qlqqkq : `gen_word2vec.py` is a generated file that will be created when you run `bazel build -c opt //tensorflow/tools/pip_package:build_pip_package` and ends up in `bazel-genfiles/tensorflow/models/embedding/gen_word2vec.py`. The `build_pip_package` tool should be able to pick it up from there.\n\nI was unable to reproduce your issue.\nCould you please provide some more details, like\n- Which version of bazel are you using? (`bazel version`). If less than 0.3.2, then could you upgrade to 0.3.2?\n- Which git commit are you synced to when building from sources (`git rev-parse HEAD && git branch`)?\n- What would be the exact sequence of steps to reproduce the problem? Were you following the instructions from [the website](https://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#installing-from-sources) verbatim, or were there some commands inserted in the middle? (That might have caused the generated file to be cleaned up)\n\nLet us know and we can try to figure this out.\n", "@asimshankar :\na. Currently, I use bazel ver. 0.3.2\nb. I use git branch(_git clone -b r.0.11 ..._ I use) to build from source.\nc. describe below.\n\nI followed instruction on the \"https://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#installing-from-sources\"\n\npre-installed : xcode - 7.2, Nvidia webdriver : 346.03.15f02\n1. install pip\n2. git clone -b r.0.11 https://github.com/tensorflow/tensorflow\n3. install java\n4. install bazel and swig\n5. install python dependencies(like wheel, numpy, six)\n6. install coreutils & cuda(ver. 8.0.46)\n7. Add Env to bash_profile\n8. about cudnn\n9. configuration\n10. bazel build -c opt --config=cuda ...\n11. bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\n\nand made an error in 11.(There is no other command inserted between the procedures above.)\n\nThank you for your help and tell me what you want to know more about my installation procedures and details.\n", "@qlqqkq : Could you run the following set of commands and provide all the output?\n\n``` sh\nls bazel-genfiles/tensorflow/models/embedding/\nbazel query --config=cuda 'somepath(//tensorflow/tools/pip_package:build_pip_package, //tensorflow/models/embedding:gen_word2vec)'\nbazel build -c opt --config=cuda //tensorflow/tools/pip_backage:build_pip_package\nbazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nls bazel-genfiles/tensorflow/models/embedding/\n```\n", "@asimshankar :\n\n1st command\n`ls bazel-genfiles/tensorflow/models/embedding/`\noutput is\n`ls: bazel-genfiles/tensorflow/models/embedding/: No such file or directory`\n\n2nd line\n`bazel query --config=cuda 'somepath(//tensorflow/tools/pip_package:build_pip_package, //tensorflow/models/embedding:gen_word2vec)'`\noutput is\n`WARNING: Config values are not defined in any .rc file: cuda`\n`WARNING: /private/var/tmp/_bazel_Kusu/e92c2cbd4935130908d79abb3c6104b0/external/protobuf/protobuf.bzl:90:19: Variables HOST_CFG and DATA_CFG are deprecated in favor of string \"host\" and \"data correspondingly.`\n`WARNING: /private/var/tmp/_bazel_Kusu/e92c2cbd4935130908d79abb3c6104b0/external/protobuf/protobuf.bzl:96:28: Variables HOST_CFG and DATA_CFG are deprecated in favor of string \"host\" and \"data correspondingly`\n`//tensorflow/tools/pip_package:build_pip_package`\n`//tensorflow/models/embedding:package`\n`//tensorflow/models/embedding:gen_word2vec`\n\n3rd line\n`bazel build -c opt --config=cuda //tensorflow/tools/pip_backage:build_pip_package`\noutput is\n`ERROR: /Users/Kusu/tensorflow/tensorflow/python/BUILD:612:1: Executing genrule //tensorflow/python:nn_ops_pygenrule failed: bash failed: error executing command /bin/bach-c ... (remaining 1 argument(s) skipped): com.google.devtools.build.lib.shell.AbnormalTerminationException: Process terminated by signal 5.`\n`dyld: Library not loaded: @rpath/libcudart.8.0.dylib`\n`Referenced from: /private/var/tmp/_bazel_Kusu/e92c2cbd4935130908d79abb3c6104b0/execroot/tensorflow/bazel-out/hos/bin/tensorflow/python/gen_nn_ops_py_wrappers_cc`\n`Reason: image not found`\n`/bin/bach: line 1: 15171 Trace/BPT trap:5        bazel-out/host/bin/tensorflow/python/gen_nn_ops_py_wrappers_cc @tensorflow/python/ops/hidden_ops.txt 1 > bazel-out/local_darwin-opt/genfiles/tensorflow/python/ops/gen_nn_ops.py`\n`Target //tensorflow/tools/pip_package:build_pip_package failed to build`\n`Use --verbose_failures to see the command lines of failed build steps`\n\n4th line made an error I asked first.\n\nThese are all I've done.\nThank you for your help.\n", "@qlqqkq : From the commands you've described above, it seems step 3 failed (it prints out a bunch of errors). So, the `build_pip_package` binary you end up with in `bazel-bin/` is not ready to use.\n\nStep 3 seems to be failing because of `dyld: Library not loaded: @rpath/libcudart.8.0.dylib`, which suggests that the build process is unable to find the CUDA shared libraries to link against.\n\nDid you follow the instructions from: https://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#prepare-environment-for-mac-os-x\nin particular, is the `DYLD_LIBRARY_PATH` environment variable set? \n", "@asimshankar :\n\nI think I correctly followed instruction on\nhttps://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#prepare-environment-for-mac-os-x\n\nAfter the `$ brew cask install cuda`\nI added Env to my bash_profile like this\n\n<img width=\"629\" alt=\"2016-10-24 4 44 41\" src=\"https://cloud.githubusercontent.com/assets/22737703/19637377/bacaebda-9a09-11e6-91bd-557b8a135e57.png\">\n\nI don't know what the problem is. Trying to re-install tensorflow is my only solution I can use?\nThank you for your help.\n", "What does `echo $DYLD_LIBRARY_PATH` say?\n", "@asimshankar :\n\n`echo $DYLD_LIBRARY_PATH`\nsays\n`:/usr/local/cuda/lib`\n", "Hmm...this seems like #5141 where `DYLD_LIBRARY_PATH` is being ignored. Marking this as a duplicate.\n\nWe will look into a robust solution, in the mean time I don't suppose you can get by your immediate needs without using the GPU? \n", "I remember one of my friend installed with v0.10.0rc0(He installed it on Os X). He said tensorflow is successfully installed and imported. I don't know for sure actually work by using GPU.\nAnyway, I really appreciate your help.\nThanks.\n"]}, {"number": 5148, "title": "Fix merging of summaries to match the tutorial \"TensorFlow Mechanics 101\"", "body": "The example does not work with `tf.summary.merge_all()`. Changing it to `tf.merge_all_summaries()` like in the [tutorial](https://www.tensorflow.org/versions/r0.11/tutorials/mnist/tf/index.html#train-loop) fixes the issue.\n", "comments": ["Can one of the admins verify this patch?\n", "@nikikilbertus, thanks for your PR! By analyzing the history of the files in this pull request, we identified @danmane, @vrv and @tensorflower-gardener to be potential reviewers.\n", "Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit https://cla.developers.google.com/ to sign.**\n\nOnce you've signed, please reply here (e.g. `I signed it!`) and we'll verify.  Thanks.\n\n---\n- If you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n- If you signed the CLA as a corporation, please let us know the company's name.\n\n<!-- need_sender_cla -->\n", "@googlebot  I signed it.\n", "CLAs look good, thanks!\n\n<!-- ok -->\n", "@tensorflow-jenkins test this please\n", "I made this change originally. Using tf.summary.merge_all() is definitely intended, as for tf1.0 we are moving all the summary ops into the tf.summary namespace. I will dig into why the example is broken and fix it while keeping usage of tf.summary.merge_all()\n"]}, {"number": 5147, "title": "Add 'dynamic_pad' flag to `shuffle_batch` as implemented in `batch`", "body": "The `tf.train.batch()` function had a nice `dynamic_pad` flag:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/input.py#L567\nIs there anything holding us batch from implementing it in `tf.train.shuffle_batch()`:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/input.py#L778\n", "comments": ["@ebrevdo : What do you think?\n", "Alternatively, is there a reason shuffle isnt just a flag for 'batch'?\n", "This is nontrivial because the c++ logic for dynamic_pad is implemented by adding a new queue type (PaddingFIFOQueue) in addition to the standard FIFOQueue.  The same amount of work should be required to extend the shuttle queue c++ class.  Contributions welcome.\n", "Is there a recommended way to handle this right now, strictly within tensorflow?  Or is the answer to wait for https://github.com/tensorflow/tensorflow/pull/5463 to get completed.\r\n\r\nI.e., to use tf.train.shuffle_batch to get inputs--e.g., sentences--of varying lengths, and then pad them (as if dynamic_pad=True was passed)?  I'm unclear if the dynamic padding operation can be elegantly implemented from within TF.", "@cbockman, I use the following workaround:\r\n\r\n```\r\n# Imagine inputs is a list or tuple of tensors representing single training example.\r\n# In my case, inputs is a tuple (features, label) obtained by reading TFRecords.\r\n\r\ndtypes = list(map(lambda x: x.dtype, inputs))\r\nshapes = list(map(lambda x: x.get_shape(), inputs))\r\nqueue = tf.RandomShuffleQueue(CAPACITY, MIN_AFTER_DEQUEUE, dtypes)\r\nenqueue_op = queue.enqueue(inputs)\r\nqr = tf.train.QueueRunner(queue, [enqueue_op] * NUM_THREADS)\r\ntf.add_to_collection(tf.GraphKeys.QUEUE_RUNNERS, qr)\r\ninputs = queue.dequeue()\r\nfor tensor, shape in zip(inputs, shapes):\r\n    tensor.set_shape(shape)\r\n\r\n# Now you can use tf.train.batch with dynamic_pad=True, and the order in which\r\n# it enqueues elements will be permuted because of RandomShuffleQueue.\r\ninputs_batch = tf.train.batch(inputs, batch_size, capacity=capacity,\r\n                              dynamic_pad=True, name=name)\r\n```\r\n\r\nDon't forget to start queue runners. If you use SparseTensors there is some extra work of packing and unpacking them into a list of plain tensors.", "Hi @standy66 , thanks, I may not be fully following this, but does this work when using TFRecords format w/ very large data sets which are loaded incrementally?\r\n\r\nThe above solution looks like we're loading everything into memory, which isn't viable with large data sets--but maybe I'm not interpreting it correctly.", "@cbockman, no, we are not loading everything into memory. I use this solution myself for a research problem employing large datasets (100GB+ of raw data) serialized in TFRecords format.\r\n\r\nI should clarify: _inputs_ is a list or tuple of tensors, representing a single training example, (in my case they are obtained by reading a TFRecord file format with TFRecorReader). Maybe this can help:\r\n\r\n```\r\nreader = TFRecordReader()\r\nkey, value = reader.read(filename_queue)\r\n\r\n# deserialize is a custom function that deserializes string\r\n# representation of a single tf.train.Example into tensors\r\n# (features, label) representing single training example\r\nfeatures, label = deserialize(value)\r\n\r\ninputs = [features, label]\r\n...\r\n```\r\n\r\nI updated the solution above.", "@standy66 in my case, a workaround like that had a bottleneck between `ShuffleFIFOQueue` and `batch` operations. One thread over there could not keep up with the training itself.\r\n\r\nHowever, increasing the number of threads of `batch` caused contention on queueing and decreased throughput compared to one thread for ~20% for even two threads. \r\n\r\nSequence processing with tensorflow is not still as good as it can be.\r\n", "Closing as a duplicate of #2354", "Thanks @standy66", "Thank you very much @standy66! "]}, {"number": 5146, "title": "Cherrypicks and rc2.", "body": "", "comments": ["@gunan, thanks for your PR! By analyzing the history of the files in this pull request, we identified @yifeif, @tensorflower-gardener and @zheng-xq to be potential reviewers.\n", "We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n\n<!-- need_author_consent -->\n", "@tensorflow-jenkins test this please.\n"]}, {"number": 5145, "title": "for completeness that if the tarball from Alex's website is already i\u2026", "body": "\u2026n /tmp/cifar10_data/\n\nuser could download it before.\n", "comments": ["@youyou3, thanks for your PR! By analyzing the history of the files in this pull request, we identified @keveman, @benoitsteiner and @vrv to be potential reviewers.\n", "Can one of the admins verify this patch?\n", "Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit https://cla.developers.google.com/ to sign.**\n\nOnce you've signed, please reply here (e.g. `I signed it!`) and we'll verify.  Thanks.\n\n---\n- If you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n- If you signed the CLA as a corporation, please let us know the company's name.\n\n<!-- need_sender_cla -->\n", "CLAs look good, thanks!\n\n<!-- ok -->\n", "@tensorflow-jenkins , test this please.\n", "@youyou3 Can you please squash your two commits into one?\n", "@caisq Could you show how to squash those two commits?\nBTW, the checks are almost done now  \" 2 pending and 8 successful checks\"\n", "@youyou3 Please see example about how to squash git commits at: http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html\n", "Ping @youyou3 regarding squashing. We'll test this PR again and merge it once the squashing is done.\n", "@caisq OK, I will squash it later in my free time. The network connection is too bad. Thanks\n", "@caisq The squashing is done. Thanks.\n", "@youyou3, thank you!\n\n@tensorflow-jenkins test this please.\n", "Merged. Thanks, @youyou3 \n"]}, {"number": 5144, "title": "Fix #5143: Remove dependencies on test libraries", "body": "tensorflow/python:tf_session_helper has dependencies on some\ntest libraries. I don't believe these dependencies should have\never existed.\n\nRegardless, removing them now. In particular because recent\nchanges to bazel\n(https://github.com/bazelbuild/bazel/commit/5f026f96118e76c8a6357c61e5710e0bd1bf0f54)\nsuggest that these dependencies will cause build failures in the next\nrelease of bazel (or if bazel is built from source).\n\nFixes #5143 \n", "comments": ["@asimshankar, thanks for your PR! By analyzing the history of the files in this pull request, we identified @keveman, @vrv and @tensorflower-gardener to be potential reviewers.\n", "Nevermind, this fix doesn't work. Need something else.\n", "It works\n"]}, {"number": 5143, "title": "Error building from source", "body": "Hi all, \n\nI'm trying to build TF from source so that I can run it in development mode and be able to expand the functionality of some of the modules, but am running into some snags with the bazel building. \n### Environment info\n\nOperating System:\n\nMac OSX Yosemite\n\nIf installed from source, provide \n1. The commit hash (`git rev-parse HEAD`)\n   \n   ec7f37e40fedb23435bfb7e28668e5fa63ff52f3\n2. The output of `bazel version`\n   \n   Build label: 0.3.2-2016-10-22 (@088bbc6)\n   Build target: bazel-out/local-    opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\n   Build time: Sun Oct 23 00:04:18 2016 (1477181058)\n   Build timestamp: 1477181058\n   Build timestamp as int: 1477181058\n\nRunning: `bazel build -c opt //tensorflow/tools/pip_package:build_pip_package --verbose_failures`\ngives\n\n```\nWARNING: Sandboxed execution is not supported on your system and thus hermeticity of actions cannot be guaranteed. See http://bazel.io/docs/bazel-user-manual.html#sandboxing for more information. You can turn off this warning via --ignore_unsupported_sandboxing.\nERROR: /Users/mihaileric/Documents/Research/tensorflow/tensorflow/python/BUILD:1806:1: in cc_library rule //tensorflow/python:tf_session_helper: non-test target '//tensorflow/python:tf_session_helper' depends on testonly target '//tensorflow/python:construction_fails_op' and doesn't have testonly attribute set.\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted.\nINFO: Elapsed time: 0.848s\n```\n\nI'm having a lot of difficulty interpreting these error messages  and am not finding too much on Stack Overflow or other TF git threads. Any help would be greatly appreciated!\n", "comments": ["@mihail911 : Thanks for the error report. There indeed seems to be an error in the BUILD file, where the `//tensorflow/python:tf_session_helper` target has a dependency on a library meant only for tests. That dependency shouldn't exist and I'll try to clear that up.\n\nAmusingly though, this was not an error till very very recently. Since you're using bazel built from source, it includes the change https://github.com/bazelbuild/bazel/commit/5f026f96118e76c8a6357c61e5710e0bd1bf0f54 , which makes this an error.\n\nAs a short term workaround for you, can you use the release version of bazel (0.3.2?) instead of from head. I'm going to try to fix the TensorFlow BUILD file regardless\n", "> Amusingly though, this was not an error till very very recently. Since you're using bazel built from source, it includes the change bazelbuild/bazel@5f026f9 , which makes this an error.\n\nAh. I have the same issue :-)\n", "(and, yes, doing `git checkout 0.3.2` before building bazel does indeed workaround the issue)\n", "I can confirm that the above fix by @asimshankar does work. Thanks for the help!\n", "can confirm @asimshankar fix. Thanks!\n", "I have same issue using bazel 0.4.0 on Ubuntu 16.0.4\n", "Please update to a recent tenorflow.\n", "@drpngx Hello, which TF version would that be?\n\nI'm also having this issue with the current v0.11.0 RC2 release. Also using bazel 0.4.0 on Ubuntu 16.04.\n\nNote that @asimshankar closed his merge request https://github.com/tensorflow/tensorflow/pull/5144 stating \n\n> Nevermind, this fix doesn't work. Need something else.\n", "@jart I think fixed this, I think. Can you confirm?\n", "@drpngx Ok, it works with a more recent version than v0.11.0 RC2 (I used SHA 9d045888a3b565e856287381b581eed02750f976). It also compiles in v0.11.0 RC2 by just commenting out \"testonly = 1\" in tensorflow/python/BUILD like you did it in your branch a few posts above.\n", "Great, thanks!\n", "I'm having the same problem on the latest release v0.11.0, which was released just two days ago. Did the fix not make it to the latest release? I'm using bazel 0.4.0\n", "@waleedka : The fix (https://github.com/tensorflow/tensorflow/commit/c8929e2e6e1dcb7e8e0feda6f917bf9b61d851b1) was not included in 0.11. You'll have to manually remove `testonly=1` from `tensorflow/python/BUILD` as mentioned above.\n", "I am still having this issue, same error code ;[i followed this guide](https://github.com/tensorflow/models/tree/master/syntaxnet#getting-started).\nThe error persists after deleting `testonly = 1`.\n", "@Ecolow : Unfortunately, the syntaxnet model that you're using is currently pinned to a specific snapshot of the TensorFlow repository and it does not update with changes to the TensorFlow repository. So, the workaround for now would be to remove `testonly=1` from the snapshot of the TensorFlow repository it uses - (inside `tensorflow/models/syntaxnet/tensorflow/tensorflow/python/BUILD`)\n", "I just tested with the master branch and got the same error. I confirmed that the `testonly = 1` flag has been removed, so there might be another issue.\n\nI did find another fix, though. Adding the bazel option `--spawn_strategy=standalone`  solves the problem for me. It worked when I compiled inside a Docker container, and it also worked when compiling on a native linux box. \n\nAnd in case it's relevant, I should also mention that I'm not compiling tensorflow itself, but rather compiling a C++ app that has tensorflow as a dependency, and this app is in a separate folder and links to tensorflow in the WORKSPACE file. \n", "For me, deleting `testonly=1` from `BUILD` fixed the problem.", "I have the same issue with a fresh clone from today (commit=821d3da7b4bffc199553d3adc46b706fb7794f91)\r\n\r\nRunning Fedora 25 and bazel 0.4.2"]}, {"number": 5142, "title": "dynamic_rnn time_major=False transpose fixed for inputs of rank>3", "body": "Fix for [dynamic_rnn](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L682) for inputs of rank > 3 when time_major=False, as discussed in issue #3882.\n", "comments": ["Can one of the admins verify this patch?\n", "@ankush-me, thanks for your PR! By analyzing the history of the files in this pull request, we identified @kosklain, @ebrevdo and @tensorflower-gardener to be potential reviewers.\n", "Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit https://cla.developers.google.com/ to sign.**\n\nOnce you've signed, please reply here (e.g. `I signed it!`) and we'll verify.  Thanks.\n\n---\n- If you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n- If you signed the CLA as a corporation, please let us know the company's name.\n\n<!-- need_sender_cla -->\n", "CLA signed.\n", "CLAs look good, thanks!\n\n<!-- ok -->\n", "(please add unit tests with both known and unknown input rank)\n\nOn Sat, Oct 22, 2016 at 3:58 PM, Ankush Gupta notifications@github.com\nwrote:\n\n> CLA signed.\n> \n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-255559000,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/ABtim3J3Z6S_C07lpz7k4u0zm7Kxch8iks5q2pUFgaJpZM4Kd_s4\n> .\n", "@ebrevdo -- yes, will do.\n", "Any update on this?\n", "@ebrevdo : Since dynamic_rnn calls _dynamic_rnn_loop which requires that all inputs have [well defined shapes at the graph construction time](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L917), it is not clear if dynamic_rnn should handle this case where the rank is unknown. \n\nI patched it as suggested, but then there is no good way of unit-testing it for inputs with unknown shapes, due to the above requirement; please correct me if I am wrong. What do you suggest?\n", "You can probably remove that check. The rnncells themselves can check for\nstatic shape info if needed.\n\nOn Nov 12, 2016 5:55 PM, \"Ankush Gupta\" notifications@github.com wrote:\n\n> @ebrevdo https://github.com/ebrevdo : Since dynamic_rnn calls\n> _dynamic_rnn_loop which requires that all inputs have well defined shapes\n> at the graph construction time\n> https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L917,\n> it is not clear if dynamic_rnn should handle this case where the rank is\n> unknown.\n> \n> I patched it as suggested, but then there is no good way of unit-testing\n> it for inputs with unknown shapes, due to the above requirement. What do\n> you suggest?\n> \n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-260161255,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/ABtim4wgEUruDdhSPsm4NVouJh7dcH-Uks5q9m31gaJpZM4Kd_s4\n> .\n", "I removed the shape checks (a2ff968) and added some unit tests (68c874a) -- both with known and unknown ranks of the inputs and outputs at the graph construction time and it seems to work. However, again this required taking out a lot of the shape-checking -- so not sure if we want to keep it as it is, or bring the checks back in. The unit tests would error out if the shape checks are included, hence the tests were not added to to the rnn_test.py file.\n", "The only shape checks you need to remove are the lines:\n\n if not shape[2:].is_fully_defined():\n      raise ValueError(\n          \"Input size (depth of inputs) must be accessible via shape\ninference,\"\n          \" but saw value None.\")\n\nand these lines (redundant and buggy?):\n\nfor input_ in input_shape:\n      if input_[1].get_shape() != batch_size.get_shape():\n        raise ValueError(\"All inputs should have the same batch size\")\n\n_everything else can stay_\n\nOn Tue, Nov 15, 2016 at 10:42 AM, Ankush Gupta notifications@github.com\nwrote:\n\n> I removed the shape checks (a2ff968\n> https://github.com/tensorflow/tensorflow/commit/a2ff968643512b50ea074edcd0561337dad427e2)\n> and added some unit tests (68c874a\n> https://github.com/tensorflow/tensorflow/commit/68c874a507498863b14e06af05fa512d97d38455)\n> -- both with known and unknown ranks of the inputs and outputs at the graph\n> construction time and it seems to work. However, again this required taking\n> out a lot of the shape-checking -- so not sure if we want to keep it as it\n> is, or bring the checks back in. The unit tests would error out if the\n> shape checks are included, hence the tests were not added to to the\n> rnn_test.py file.\n> \n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-260728417,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/ABtimzqlqR0frGBjKmxwZQJTxNBpHFLCks5q-f0CgaJpZM4Kd_s4\n> .\n", "Correct regarding [this](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L830); should not have been commented out.\n\nBut everything else, due to [line 923](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L923):\n\n``` python\nconst_time_steps, const_batch_size = inputs_got_shape[0].as_list()[:2]\n```\n\nwhere static shape is required, needs to be taken out (?), i.e.: \n1. Lines [930](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L930) - [938](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L938):\n   \n   ``` python\n   got_time_steps = shape[0].value\n   got_batch_size = shape[1].value\n   if const_time_steps != got_time_steps:\n     raise ValueError(\n         \"Time steps is not the same for all the elements in the input in a \"\n         \"batch.\")\n   if const_batch_size != got_batch_size:\n     raise ValueError(\n         \"Batch_size is not the same for all the elements in the input.\")\n   ```\n2. And, lines [1026](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L1026) - [1030](https://github.com/tensorflow/tensorflow/blob/a2ff968643512b50ea074edcd0561337dad427e2/tensorflow/python/ops/rnn.py#L1030)\n   \n   ``` python\n   # Restore some shape information\n   for output, output_size in zip(final_outputs, flat_output_size):\n       shape = _state_size_with_prefix(output_size, prefix=[const_time_steps, const_batch_size])\n       output.set_shape(shape)\n   ```\n", "@ebrevdo, @ankush-me whose turn?", "@martinwicke: @ebrevdo, I guess.", "He's on vacation, many people are. I suppose this will have to wait a little longer.", "Happy New Year everyone!\r\n\r\n@ankush-me could you sync and push again?", "@drpngx Sorry for the delay. I've synced with master.", "Jenkins, test this please.", "This fails tests. Could you fix?", "@tensorflow-jenkins test this please", "@ankush-me will you have time to look at this again any time soon?  I'll close by the end of the week if not.  Thanks again for your contribution.", "@vrv: there are some assumptions about shapes being fully defined at graph construction time in ` _dynamic_rnn_loop`, as highlighted in my comment posed on Nov 15, 2016 above. Due to these assumptions, I cannot write unit tests with inputs with unknown shapes at graph construction time, as is desired by @ebrevdo. Can I take out these checks (as pointed out in the comment above)? Please let me know. Thanks.", "Can you modify the checks to only run it the static values are available?\n\nOn Feb 13, 2017 1:50 PM, \"Ankush Gupta\" <notifications@github.com> wrote:\n\n> @vrv <https://github.com/vrv>: there are some assumptions about shapes\n> being fully defined at graph construction time in _dynamic_rnn_loop, as\n> highlighted in my comment posed on Nov 15, 2016 above. Due to these\n> assumptions, I cannot write unit tests with inputs with unknown shapes at\n> graph construction time, as is desired by @ebrevdo\n> <https://github.com/ebrevdo>. Can I take out these checks (as pointed out\n> in the comment above)? Please let me know. Thanks.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-279533867>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim6KJgbAKLvSO99hiVBmtGtVFcE2Fks5rcNAegaJpZM4Kd_s4>\n> .\n>\n", "@ankush-me any updates?  I'm going to close by the end of the day to keep the PR list small, but feel free to send a new PR if you get around to fixing this.", "@vrv I should find time over the weekend to fix this. If you can wait till Monday, that'll be great.", "Done: removed the unnecessary shape checks and added unit tests for input tensors of rank > 3 in kernel_tests/rnn_test.py for both known and unknown static rank. Can you please test this?", "Jenkins, test this please.", "Jenkins, test this please.\r\n\r\nAre you done pushing?", "Yes.", "Fixed bugs. Tests seem to pass locally. Can you please test this again?", "@ebrevdo Thanks for the review! Will make these changes soon.", "Jenkins, test this please.", "We actually have an internal piece of code we're gonna move over here to\nfix this problem; if that's OK:\n\nhttps://github.com/tensorflow/tensorflow/blob/34df7ee6f5a8f931d2433dc7e6e739bc880a35ea/tensorflow/contrib/seq2seq/python/ops/decoder.py#L41\n\nSo perhaps we can hold off on this PR until that code is moved internally?\nBecause then it can be used here and in the dynamic decoder.\n\nOn Wed, Mar 1, 2017 at 3:44 PM, drpngx <notifications@github.com> wrote:\n\n> Jenkins, test this please.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-283509050>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim0tyX4lD-RtlngZzfuU2khTRC1Wnks5rhgLYgaJpZM4Kd_s4>\n> .\n>\n", "Ok. ", "any update on this PR? When do you think it's going to be merged? \r\nfor reference: @carlthome ", "I just pushed a fix internally; it should show up on master\ntoday/tomorrow.  It's safe to close this PR.\n\nOn Thu, Apr 6, 2017 at 1:57 AM, Marco Ciccone <notifications@github.com>\nwrote:\n\n> any update on this PR? When do you think it's going to be merged?\n> for reference: @carlthome <https://github.com/carlthome>\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/5142#issuecomment-292111462>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim1vInJjXe2cpiF8tBF8uARZqyqDjks5rtKjpgaJpZM4Kd_s4>\n> .\n>\n", "Wonderful! Hope this makes it onto PyPI ASAP! Thanks for notifying @marcociccone."]}, {"number": 5141, "title": "ipython ImportError: Library not loaded: @rpath/libcudart.8.0.dylib", "body": "I just installed 0.11rc1 from pip (`TF_BINARY_URL=https://storage.googleapis.com/tensorflow/mac/gpu/tensorflow-0.11.0rc1-py2-none-any.whl`), with a brand-new CUDA 8.0 installation, and got this error:\n\n```\nIn [1]: import tensorflow as tf\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-41389fad42b5> in <module>()\n----> 1 import tensorflow as tf\n\n/Users/me/anaconda/lib/python2.7/site-packages/tensorflow/__init__.py in <module>()\n     21 from __future__ import print_function\n     22\n---> 23 from tensorflow.python import *\n     24\n     25\n\n/Users/me/anaconda/lib/python2.7/site-packages/tensorflow/python/__init__.py in <module>()\n     47 _default_dlopen_flags = sys.getdlopenflags()\n     48 sys.setdlopenflags(_default_dlopen_flags | ctypes.RTLD_GLOBAL)\n---> 49 from tensorflow.python import pywrap_tensorflow\n     50 sys.setdlopenflags(_default_dlopen_flags)\n     51\n\n/Users/me/anaconda/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py in <module>()\n     26                 fp.close()\n     27             return _mod\n---> 28     _pywrap_tensorflow = swig_import_helper()\n     29     del swig_import_helper\n     30 else:\n\n/Users/me/anaconda/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py in swig_import_helper()\n     22         if fp is not None:\n     23             try:\n---> 24                 _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\n     25             finally:\n     26                 fp.close()\n\nImportError: dlopen(/Users/me/anaconda/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\n  Referenced from: /Users/me/anaconda/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so\n  Reason: image not found\n```\n\n(Similar to https://github.com/tensorflow/tensorflow/issues/4187 but different error.)\nLooks like a [path issue](http://stackoverflow.com/questions/37933890/tensorflow-gpu-setup-error-with-cuda-on-pycharm) but I don't see a problem:\n\n```\n\u279c  ~ echo $PATH\n/Users/me/anaconda/bin:/usr/local/cuda/bin:/Developer/NVIDIA/CUDA-8.0/bin:/opt/local/bin:/opt/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin\n\u279c  ~ echo $DYLD_LIBRARY_PATH\n/usr/local/cuda/lib:/Developer/NVIDIA/CUDA-8.0/lib:\n\u279c  ~ ll /Developer/NVIDIA/CUDA-8.0/lib/libcudart*\n-rwxr-xr-x 1 root wheel 285K Sep 27 00:59 /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\nlrwxr-xr-x 1 root wheel   19 Sep 27 00:59 /Developer/NVIDIA/CUDA-8.0/lib/libcudart.dylib -> libcudart.8.0.dylib\n-rw-r--r-- 1 root wheel 599K Sep 27 00:59 /Developer/NVIDIA/CUDA-8.0/lib/libcudart_static.a\n```\n\nI also get a segfault when importing in python:\n\n```\n\u279c  ~ python -c \"import tensorflow;\"\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.dylib locally\n[1]    60723 segmentation fault  python -c \"import tensorflow;\"\n```\n\nTried the [suggestion from the docs](https://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#mac-os-x-segmentation-fault-when-import-tensorflow), didn't work:\n\n```\nln -sf /usr/local/cuda/lib/libcuda.dylib /usr/local/cuda/lib/libcuda.1.dylib\n```\n\nOn OSX 10.11.6, CUDA 8.0.46, no CUDNN installed yet.\n\nIs this a SIP issue? Should the install procedure be updated?\nI don't know if I can turn off SIP, this is a work computer.\n", "comments": ["Apparently SIP prevents you from overriding `DYLD_LIBRARY_PATH` which would explain why the library is not found -- https://groups.google.com/forum/#!topic/caffe-users/waugt62RQMU\n", "Is it just that variable? Can TF be set up to use another variable (`TF_LIBRARY_PATH`)?\nIf not I'll see what I can do about SIP.\n", "That variable is not used by TF, but by `dlopen` which is a system call. PS: only older macs support CUDA, which means that GPUs are old/slow and don't give a performance advantage over CPU. The main reason for using GPU tensorflow on Mac is for debugging a model that you'll eventually deploy on linux GPU\n", "Well I got a pretty awesome speedup by using the mac (2014, 750M) with Theano :)\nLet me know if I should close this issue, or leave it for the docs.\n", "Sorry, I don't have a mac to try here, but could you give me the backtrace using gdb? If it's the tensorflow so lib loading the library, could you try to rebuild using -Wl,--rpath and/or using patchelf to see if that fixes it?\n", "Strange.\nI installed CUDNN. Now TF seems to run fine called from python:\n\n```\n\u279c  ~ python -c \"import tensorflow;\"\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.dylib locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcudnn.dylib locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcufft.dylib locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcuda.1.dylib locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcurand.dylib locally\n```\n\n(more complex example [here](https://gist.github.com/ohadle/5c73237d337f2b955d00c9ec857ab0a8))\nBut running from ipython (either REPL or script file \"`ipython test.py`\") still gives the error above.\n\nHow to I use gdb on ipython?\n", "You can just say \"gdb ipython\" instead of just python.\n\nAt this point you might want to use strace to figure out whether it's loading the same files on both ends.\n", "When I try `gdb ipython` I get:\n\n```\n\"/Users/me/anaconda/bin/ipython\": not in executable format: File format not recognized\n```\n\nApparently the OSX version of strace is dtrace. Results (/meaningless gibberish?) here:\nhttps://gist.github.com/ohadle/5c73237d337f2b955d00c9ec857ab0a8\n", "[Here](https://github.com/tensorflow/tensorflow/issues/2940#issuecomment-230186665)'s a similar-looking crash that only happens in IPython and not in Python. The solution is to run `python <my anaconda virtual environment path>/bin/ipython` instead of `ipython`\n\nPS, you can also get stack traces on MacOS from diagnostics reports folder, as shown here: https://github.com/tensorflow/tensorflow/issues/3494#issuecomment-239081963\n\n\"gdb ipython\" doesn't work because \"ipython\" is a shell script, an alternative way is to start ipython, then \"gdb -p <process id>\", then do import tensorflow.\n", "Nice!! Do you know why the difference? I wonder if that's something we could work around on our end.\n\n@ohadle does that work for you?\n", "Yep, works for me.\nLet me know if gdb / traces are still needed.\n", "@drpngx My first guess would be that `IPython.start_ipython()` doesn't propagate the environment variables from the parent process\n", "@drpngx My first guess would be that `IPython.start_ipython()` doesn't\npropagate the environment variables from the parent process\n\nOn Mon, Oct 24, 2016 at 3:28 PM, drpngx notifications@github.com wrote:\n\n> Nice!! Do you know why the difference? I wonder if that's something we\n> could work around on our end.\n> \n> @ohadle https://github.com/ohadle does that work for you?\n> \n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/5141#issuecomment-255884333,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/AABaHC7KzjbVWpA920oQwaazuGDMPjU_ks5q3TD2gaJpZM4Kd-hc\n> .\n", "Thanks! Closing this ticket, as it is \"solved\". Looping internally.\n", "I disabled SIP, but still get the error\nLibrary not loaded: @rpath/libcudart.8.0.dylib\n  Referenced from: /Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/site-packages/tensorflow/python/_pywrap_tensorflow.so\n\nwhat else do I try?\n", "Good to know.\n1. Make sure you have cuDNN installed.\n2. Try running from python (not ipython). E.g. `python -c \"import tensorflow\"`\n", "Does your DYLD_LIBRARY_PATH contain a path which has /libcudart.8.0.dylib?\n\nOn Tue, Nov 1, 2016 at 12:17 AM, Ohad Levinkron notifications@github.com\nwrote:\n\n> Good to know.\n> 1. Make sure you have cuDNN installed.\n> 2. Try running from python (not ipython). E.g. python -c \"import\n> tensorflow\"\n> \n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/5141#issuecomment-257503594,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/AABaHIJj0afKwfOsxp0S5P2Ok4gfTPFNks5q5ueOgaJpZM4Kd-hc\n> .\n", "/libcudart.8.0.dylib definitely is there. \n\nI went thru this instruction ending with the test\n\nhttps://www.tensorflow.org/versions/r0.11/get_started/os_setup.html#optional-setup-gpu-for-mac\n\nso cuDNN must be installed \n", "I met this problem right now , and I don't know how to fix it ...:(\n", "Add the following to your bash profile. This will provide Tensorflow the path needed to get to this dylib.\n\nexport DYLD_LIBRARY_PATH=\"/Developer/NVIDIA/CUDA-8.0/lib:$DYLD_LIBRARY_PATH\"\n", "Exactly the same issue. `libcudart.8.0.dylib` is available on the `DYLD_LIBRARY_PATH`:\n\n```\n$ python -c \"import tensorflow\"\ndyld: warning, LC_RPATH $ORIGIN/../../_solib_darwin/_U@local_Uconfig_Ucuda_S_Scuda_Ccudart___Uexternal_Slocal_Uconfig_    Ucuda_Scuda_Slib in /usr/local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so being ignored in restricted program because it is a relative path\ndyld: warning, LC_RPATH ../local_config_cuda/cuda/lib in /usr/local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so being ignored in restricted program because it is a relative path\ndyld: warning, LC_RPATH ../local_config_cuda/cuda/extras/CUPTI/lib in /usr/local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so being ignored in restricted program because it is a relative path\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/__init__.py\", line 23, in <module>\nfrom tensorflow.python import *\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/__init__.py\", line 49, in <module>\nfrom tensorflow.python import pywrap_tensorflow\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\n    _pywrap_tensorflow = swig_import_helper()\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\nImportError: dlopen(/usr/local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\n  Referenced from: /usr/local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so\n  Reason: image not found\n\n\n$ echo $DYLD_LIBRARY_PATH\n:/usr/local/cuda/lib\n\n$ ls -all /usr/local/cuda/lib/libcudart.8.0.dylib\nlrwxr-xr-x@ 1 root  wheel  50 Sep 27 00:00 /usr/local/cuda/lib/libcudart.8.0.dylib -> /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\n\n$ ls -all /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\n-rwxr-xr-x@ 1 root  wheel  291712 Sep 26 23:59 /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\n```\n\nAny input is appreciated.\n", "FYI, it works with ipython after the applying the hack in issue #2910 (`ln -s libcuda.dylib libcuda.1.dylib`). How could this be?\n", "Yes this is interesting indeed. I have had to create the sym link as well\nas fix DYLD_PATH for tensor flow GPU to work.\n\nOn Tue, Nov 8, 2016 at 5:42 PM, Freddy Snijder notifications@github.com\nwrote:\n\n> FYI, it works with ipython after the applying the hack in issue #2910\n> https://github.com/tensorflow/tensorflow/issues/2910 (ln -s\n> libcuda.dylib libcuda.1.dylib). How could this be?\n> \n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/5141#issuecomment-259313863,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/AAycfEH-JsXsmRAcqnrPvQS8JhOSVGRiks5q8SUjgaJpZM4Kd-hc\n> .\n", "I have this issue as well.\r\nMacOS using an external GPU.\r\nDYLD_LIBRARY_PATH is set (to /usr/local/cuda/lib)\r\n/usr/local/cuda/lib/libcudart.8.0.dylib exists\r\n\r\nIt works when I disable SIP. But something turns SIP on on a regular basis. Annoying.", "I suspect installing macos security updates enables sip\n\nOn Jan 25, 2017 6:32 AM, \"martin-gorner\" <notifications@github.com> wrote:\n\n> I have this issue as well.\n> MacOS using an external GPU.\n> DYLD_LIBRARY_PATH is set (to /usr/local/cuda/lib)\n> /usr/local/cuda/lib/libcudart.8.0.dylib exists\n>\n> It works when I disable SIP. But something turns SIP on on a regular\n> basis. Annoying.\n>\n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/5141#issuecomment-275122573>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AABaHA7am_lNemOV9kB7MS4XP-gTK9OQks5rV10RgaJpZM4Kd-hc>\n> .\n>\n", "Actually, SIP seems to be re-enabled on every reboot of the machine.", "Not for me (10.12.2 (16C67)), do you have security update installed every\ntime you rebooted machine?\n\nOn Wed, Feb 15, 2017 at 4:27 AM, martin-gorner <notifications@github.com>\nwrote:\n\n> Actually, SIP seems to be re-enabled on every reboot of the machine.\n>\n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/5141#issuecomment-279998072>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AABaHBHktSOS_Bw2VJF8NpIQCgN8zI-Kks5rcu8tgaJpZM4Kd-hc>\n> .\n>\n", "I have the same issue. @martin-gorner . Do you resolve it\uff1f", "<img width=\"586\" alt=\"2017-02-19 10 10 56\" src=\"https://cloud.githubusercontent.com/assets/870777/23103101/55600106-f6f0-11e6-8fde-06a34c6dcc05.png\">\r\n", "Same issue here. Building on Mac Pro with custom Nvidia Titan Black instead of factory AMD card, macOS Sierra, trying to build r1.0 branch with bazel and SSE4.2 enabled. /usr/local/cuda/lib/libcudart.8.0.dylib exists, DYLIB_LIBRARY_PATH and DYLIB_FALLBACK_LIBRARY_PATH are set to include /usr/local/cuda/lib. Even tried using LD_LIBRARY_PATH and LIBRARY_PATH but issue persists. Also restarted OS with SIP disabled, which `csrutil status` shows it still is. \r\n\r\nTo be noted I already have a running installation in a virtualenv and pre-compiled package with GPU support but no support for SSE4.2 and I validated this one is working well, therefore confirming my bash profile environment variables are somewhat right.\r\n\r\n**Edit** I created a symlink to libcudart.8.0.dylib in /usr/local/lib and the `@rpath` build failure disappeared - now the final step of bazel build fails on a similar error : \r\n`clang: warning: argument unused during compilation: '-pthread'\r\nld: file not found: -lcudart.8.0\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build`\r\n\r\nHaving a version number in a library flag seems odd, I would expect -lcudart instead. I tried reconfiguring the build without specifying the CUDA toolkit version and leaving system default but \r\nit still builds that name for us and therefore fails on it. \r\n\r\n", "```\r\nimport tensorflow\r\nTraceback (most recent call last):\r\n\r\n  File \"<ipython-input-1-a649b509054f>\", line 1, in <module>\r\n    import tensorflow\r\n\r\n  File \"/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import *\r\n\r\n  File \"/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/__init__.py\", line 72, in <module>\r\n    raise ImportError(msg)\r\n\r\nImportError: Traceback (most recent call last):\r\n  File \"/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/__init__.py\", line 61, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\r\n    _pywrap_tensorflow = swig_import_helper()\r\n  File \"/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\r\n  File \"/Users/g**s/anaconda/lib/python3.5/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/Users/g**/anaconda/lib/python3.5/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: dlopen(/Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /Users/g**/anaconda/lib/python3.5/site-packages/tensorflow/python/_pywrap_tensorflow.so\r\n  Reason: image not found\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n```\r\n\r\nI have the same issue. Can someone please re-open the ticket? I would really like to be able to code using spyder and ipython due to the familiar environment.", "@lelayf the issue is https://github.com/tensorflow/tensorflow/issues/7227 the solution is to build bazel from head or downgrade to 0.4.3\r\n\r\n@DolanDack can you use it from outside of Spyder but not inside of Spyder? Most likely the issue is that your spider environment is not setting PATH, DYLD_LIBRARY_PATH, LD_LIBRARY_PATH properly", "Exactly the same situation as @visionscaper.  Originally:\r\n```\r\nSocrates:~ bRad$ python -c \"import tensorflow as tf\"\r\nTraceback (most recent call last):\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 61, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\r\n    _pywrap_tensorflow = swig_import_helper()\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: dlopen(/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so\r\n  Reason: image not found\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import *\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 72, in <module>\r\n    raise ImportError(msg)\r\nImportError: Traceback (most recent call last):\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 61, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\r\n    _pywrap_tensorflow = swig_import_helper()\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: dlopen(/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so\r\n  Reason: image not found\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\nSee https://github.com/tensorflow/tensorflow/blob/master/tensorflow/g3doc/get_started/os_setup.md#import_error\r\n\r\nfor some common reasons and solutions.  Include the entire stack trace\r\nabove this error message when asking for help.\r\n```\r\n\r\nBased on this thread, I then created  a symlink:\r\n```\r\nSocrates:~ cd /usr/local/lib\r\nSocrates:lib ln -s ../cuda/lib/ libcudart.8.0.dylib\r\n```\r\n\r\nBut with the symlink I get a \"not a file\" error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 61, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\r\n    _pywrap_tensorflow = swig_import_helper()\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: dlopen(/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so\r\n  Reason: no suitable image found.  Did find:\r\n\t/usr/local/lib/libcudart.8.0.dylib: not a file\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import *\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 72, in <module>\r\n    raise ImportError(msg)\r\nImportError: Traceback (most recent call last):\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py\", line 61, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 28, in <module>\r\n    _pywrap_tensorflow = swig_import_helper()\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/Users/bRad/anaconda3/lib/python3.6/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: dlopen(/Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so, 10): Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /Users/bRad/anaconda3/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow.so\r\n  Reason: no suitable image found.  Did find:\r\n\t/usr/local/lib/libcudart.8.0.dylib: not a file\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\nSee https://github.com/tensorflow/tensorflow/blob/master/tensorflow/g3doc/get_started/os_setup.md#import_error\r\n\r\nfor some common reasons and solutions.  Include the entire stack trace\r\nabove this error message when asking for help.\r\n```\r\n\r\nMy environment:\r\n```\r\nSocrates:~ bRad$ echo $DYLD_LIBRARY_PATH\r\n/usr/local/cuda/lib:/Developer/NVIDIA/CUDA-8.0/lib:\r\n\r\nSocrates:~ bRad$ l /usr/local/cuda/lib/libcudart.8.0.dylib\r\nlrwxr-xr-x@ 1 root  wheel  50 Jan 11 17:33 /usr/local/cuda/lib/libcudart.8.0.dylib -> /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\r\n\r\nSocrates:~ bRad$ l  /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\r\n-rwxr-xr-x@ 1 root  wheel   285K Jan 11 17:32 /Developer/NVIDIA/CUDA-8.0/lib/libcudart.8.0.dylib\r\n```\r\n\r\nSimply copying the library in question doesn't work either:\r\n```\r\nSocrates:~ cd /usr/local/lib\r\nSocrates:lib bRad$ cp ../cuda/lib/libcudart.8.0.dylib .\r\nSocrates:lib bRad$ python -c \"import tensorflow as tf\"\r\nSegmentation fault: 11\r\n```\r\n\r\nNote that the CUDA sample apps build and run fine:\r\n```\r\nSocrates:~ bRad$ cd /usr/local/cuda/bin/x86_64/darwin/release\r\nSocrates:release bRad$ ./vectorAdd\r\n[Vector addition of 50000 elements]\r\nCopy input data from the host memory to the CUDA device\r\nCUDA kernel launch with 196 blocks of 256 threads\r\nCopy output data from the CUDA device to the host memory\r\nTest PASSED\r\nDone\r\n```\r\n\r\nAny ideas? ", "The solution presented in https://github.com/tensorflow/tensorflow/issues/6729 resolved my issue.  Namely, setting the following environment variables:\r\n```\r\nexport CUDA_HOME=/usr/local/cuda\r\nexport DYLD_LIBRARY_PATH=${CUDA_HOME}/lib:${CUDA_HOME}/extras/CUPTI/lib:/Developer/NVIDIA/CUDA-8.0/lib\r\nexport LD_LIBRARY_PATH=$DYLD_LIBRARY_PATH\r\nexport PATH=$DYLD_LIBRARY_PATH:$PATH\r\n```\r\n+ plus symlinking libcuda.1 (`cd /usr/local/cuda/lib && sudo ln -s libcuda.dylib libcuda.1.dylib`)\r\n+ and ensuring that pyenv is not active (remove `eval \"$(pyenv init -)\"` from `~/.bash_profile` if you have it).\r\n\r\nThis now yields:\r\n\r\n```\r\nSocrates:~ bRad$ python -c \"import tensorflow as tf\"\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.8.0.dylib locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.5.dylib locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.8.0.dylib locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.1.dylib locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.8.0.dylib locally```\r\n", "@bradleygibson Worked! Thank you so much. I think setting the environment variables helped me because I had done everything else beforehand and it still was not working for me.\r\n\r\nEDIT: See comment update below", "@laoyao No solution yet, just a workaround, reboot on recovery partition, disable SIP.Again and again... Fortunately a mac is quick to boot these days.", "UPDATE: I have to update the path variables each time I activate/deactivate the tensorflow environment before launching jupyter notebook using:\r\n\r\nexport DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/usr/local/cuda/lib\r\nexport DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/Developer/NVIDIA/CUDA-8.0/lib\r\nexport PATH=$PATH:/Developer/NVIDIA/CUDA-8.0/lib\r\n\r\nAfter doing this, tensorflow imports fine inside jupyter.", "I am on El Capitain, have SIP disabled and set the paths as above. but still see the build error on master:\r\n\r\nERROR: /Users/alexeysimonov/dev/tensorflow/tensorflow/cc/BUILD:312:1: Executing genrule //tensorflow/cc:logging_ops_genrule failed: bash failed: error executing command /bin/bash -c ... (remaining 1 argument(s) skipped): com.google.devtools.build.lib.shell.AbnormalTerminationException: Process terminated by signal 5.\r\ndyld: Library not loaded: @rpath/libcudart.8.0.dylib\r\n  Referenced from: /private/var/tmp/_bazel_root/9a8b7d02e7f6ce832d52efe09806ba70/execroot/tensorflow/bazel-out/host/bin/tensorflow/cc/ops/logging_ops_gen_cc\r\n  Reason: image not found\r\n/bin/bash: line 1: 15710 Trace/BPT trap: 5       bazel-out/host/bin/tensorflow/cc/ops/logging_ops_gen_cc bazel-out/local_darwin-py3-opt/genfiles/tensorflow/cc/ops/logging_ops.h bazel-out/local_darwin-py3-opt/genfiles/tensorflow/cc/ops/logging_ops.cc tensorflow/cc/ops/op_gen_overrides.pbtxt 0\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\n\r\n", "@asimonov Please refer to mine  and @bradleygibson 's comment above. You need to set the PATH and DYLD_LIBRARY_PATH environment variables from within the tensorflow virtual environment. I had to do this each time I source-activated tensorflow.", "i do not use virtualenv. I try to install to default conda environment", "I made it work -- see my comment at https://github.com/tensorflow/tensorflow/issues/7633\r\n", "my system keeps persistently looking for @rpath/libcudart.7.5.dylib even though i've uninstalled 7.5 completely and installed 8.0.  i've also done a complete wipe and reinstall of tensorflow.  none of the suggestions here have solved this.", "@bradleygibson you da man! Worked great for me as well! W00p W00p!"]}, {"number": 5140, "title": "Do not use non-portable `cp --parents`", "body": "Mac OS `cp` command does not support the `--parents` option, so\nuse `mkdir -p` + `cp` instead.\n", "comments": ["Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit https://cla.developers.google.com/ to sign.**\n\nOnce you've signed, please reply here (e.g. `I signed it!`) and we'll verify.  Thanks.\n\n---\n- If you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n- If you signed the CLA as a corporation, please let us know the company's name.\n\n<!-- need_sender_cla -->\n", "I signed it!\n", "CLAs look good, thanks!\n\n<!-- ok -->\n", "@caisq As suggested, but without extra variable\n\n```\n...\n++ find protobuf -name '*.h'\n+ for header in $(find protobuf -name \\*.h)\n++ dirname protobuf/src/google/protobuf/any.h\n+ mkdir -p /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wrghdibj/google/protobuf/src/google/protobuf\n+ cp protobuf/src/google/protobuf/any.h /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wrghdibj/google\n+ for header in $(find protobuf -name \\*.h)\n++ dirname protobuf/src/google/protobuf/any.pb.h\n+ mkdir -p /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wrghdibj/google/protobuf/src/google/protobuf\n...\n```\n", "@caisq apologies for that. now it should do the right thing:\n\n```\n...\n++ find protobuf -name '*.h'\n+ for header in $(find protobuf -name \\*.h)\n++ dirname protobuf/src/google/protobuf/any.h\n+ mkdir -p /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wMGQ1CqG/google/protobuf/src/google/protobuf\n++ dirname protobuf/src/google/protobuf/any.h\n+ cp protobuf/src/google/protobuf/any.h /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wMGQ1CqG/google/protobuf/src/google/protobuf/\n+ for header in $(find protobuf -name \\*.h)\n++ dirname protobuf/src/google/protobuf/any.pb.h\n+ mkdir -p /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wMGQ1CqG/google/protobuf/src/google/protobuf\n++ dirname protobuf/src/google/protobuf/any.pb.h\n+ cp protobuf/src/google/protobuf/any.pb.h /var/folders/kf/thhjvp791mj9vh08w165m2jw0000gp/T/tmp.XXXXXXXXXX.wMGQ1CqG/google/protobuf/src/google/protobuf/\n...\n```\n", "@gunan who pointed out the issue.\n\nYou should change the title since it no longer matches the change.\n", "Thank you very much for the fix.\n@meteorcloudy FYI.\nThe change looks good to me except for the one nit.\nI will leave the approval to @caisq as I am more confident with his bash-fu :)\n", "@tensorflow-jenkins , test this please.\n", "@fp  Thanks for the fix!\n@gunan Can you also make ci run `build_pip_package.sh` so that we can catch the breakage earlier?\n", "@meteorcloudy The reason why this was not caught before merging was because we do not test PIP install on Mac in PR tests. We test that only in nightly builds. The PR tests test only PIP install on Linux. It's a tradeoff between the speed of testing and thoroughness of testing. @gunan may have other thoughts, but I think our current mac resource doesn't allow us to test Mac PIP install for every PR.\n"]}, {"number": 5139, "title": "Revert \"extend tf.select to broadcast a scalar condition #3945\"", "body": "Reverts tensorflow/tensorflow#5127\n", "comments": ["@drpngx, thanks for your PR! By analyzing the history of the files in this pull request, we identified @Mistobaan, @keveman and @tensorflower-gardener to be potential reviewers.\n", "Original PR might have broken the build.\n", "@guschmue working on a forward fix. See discussion in #5103.\n"]}, {"number": 5138, "title": "failed to install tensorflow while doing \"pip install\"", "body": "I am using ubuntu with GPU and follow the tutorial \"Installing from sources\". I successfully go through previous steps, but have trouble at the final step. After running: \n\"sudo bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\"\nI got this:\n\"......\nSun Oct 23 00:22:33 CST 2016 : === **Output wheel file is in: /tmp/tensorflow_pkg**\"\n\nHowever, when I run the last step:\n\"sudo pip install /tmp/tensorflow_pkg/tensorflow-0.11.0rc1-py2-none-any.whl\"\nI got:\n\"**IOError: [Errno 2] No such file or directory: '/tmp/tensorflow_pkg/tensorflow-0.11.0rc1-py2-none-any.whl**'\"\nI knew that the name of the .whl file will depend on your platform. But there is **no folder called tmp**, and I also **cannot find the .whl file** in my tensorflow folder.\nI am a beginer, could anyone tells me how to solve it ?\n", "comments": ["leave me alone. I'a fool .I have solved it.\n"]}, {"number": 5137, "title": "tf.train.batch does not work with tf.train.string_input_producer", "body": "When I try to batch results from `tf.train.string_input_producer` nothing happens and timeouts occur on a regular basis. Identical code is located at [tensorflow documentation](https://www.tensorflow.org/versions/r0.11/how_tos/reading_data/index.html#batching). Please see the code below.\n### Environment info\n\nOperating System:\nElementaryOS Freya\n\nInstalled version of CUDA and cuDNN: \n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\n\n```\n ~ \ue0b0  ls -l /usr/local/cuda-7.5/lib64/libcud*\n\n-rw-r--r-- 1 root root 322936 \u0430\u0432\u0433.  15  2015 /usr/local/cuda-7.5/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root     16 \u0430\u0432\u0433.  15  2015 /usr/local/cuda-7.5/lib64/libcudart.so -> libcudart.so.7.5\nlrwxrwxrwx 1 root root     19 \u0430\u0432\u0433.  15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5 -> libcudart.so.7.5.18\n-rwxr-xr-x 1 root root 383336 \u0430\u0432\u0433.  15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18\n-rw-r--r-- 1 root root 720192 \u0430\u0432\u0433.  15  2015 /usr/local/cuda-7.5/lib64/libcudart_static.a\n```\n\nIf installed from binary pip package, provide:\n1. A link to the pip package you installed: https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.11.0rc0-cp35-cp35m-linux_x86_64.whl\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\n\n```\n ~ \ue0b0 python -c \"import tensorflow; print(tensorflow.__version__)\"\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcurand.so locally\n0.11.0rc0\n```\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\n\n```\nimport tensorflow as tf\n\ndef load_png(input_queue):\n    reader = tf.WholeFileReader()\n    _, data = reader.read(input_queue)\n    data = tf.image.decode_png(data)\n    data.set_shape([28, 28, 3])\n    return data\n\ntf.reset_default_graph()\nconfig = tf.ConfigProto()\n# config.operation_timeout_in_ms=100000\n\ntrain_dataset = notMNISTDataset(url='http://yaroslavvb.com/upload/notMNIST/', \n                    filename='notMNIST_large.tar.gz',\n                   num_classes=10)\n\nfilenames = glob.glob(train_dataset._data_folder + '/**/*.png', recursive=True)\nfilename_queue = tf.train.string_input_producer(filenames, name='filename_queue', shuffle=False, capacity=100)\ndata = train_dataset._load_png(filename_queue)\n\n# all breaks when we try to batch Reader results\nlabel_batch = tf.train.batch([data],\n                              batch_size=5,\n                              capacity=100,\n                              allow_smaller_final_batch=True, \n                              name='batch_queue')\n\nwith tf.Session(config=config) as sess:\n    print(\"Starting session\")\n    tf.initialize_local_variables().run()\n    coordinator = tf.train.Coordinator()\n\n    while not coordinator.should_stop():  \n        print(\"Running batch reading op\")\n        threads = tf.train.start_queue_runners(coord=coordinator)\n        b = sess.run([label_batch])\n        print(b)\n\n    print(\"Requesting stop...\")\n    coordinator.request_stop()\n    coordinator.join(threads)\n```\n### What other attempted solutions have you tried?\n\nVariations of this code from SO\n", "comments": ["Sorry we don't support that OS. Did you try the example on Ubuntu or docker first?\n", "@drpngx, elementary is just an ubuntu 14.04 with custom desktop environment. I will try to reproduce it in docker anyway.\n", "Closing due to lack of recent activity. Since this issue is quite old at this point, please reopen the issue if it still occurs when tried with the latest version of Tensorflow. Thanks.\r\n"]}, {"number": 5136, "title": "How do I train a semantic segmentation to recognise only one type of object? ", "body": "I want to detect and segment hands in images and that is the only thing I want to detect. \nI 'm using FCN. How do I train it to recognise only the object I want ?\n", "comments": ["@Yaffa1607 : Thanks for your question, but I believe it is better suited for [stackoverflow](http://stackoverflow.com/questions/tagged/tensorflow). The github issues are meant to be focused on bugs or feature requests. Thanks much.\n"]}, {"number": 5135, "title": "Option to config python lib path from env var", "body": "The simplest way to give the option to configure python library path from environment variables, targeting the issue https://github.com/tensorflow/serving/issues/216 about a scriptable complete configuration for tensorflow + serving.\n", "comments": ["@villasv, thanks for your PR! By analyzing the history of the files in this pull request, we identified @meteorcloudy, @itsmeolivia and @tensorflower-gardener to be potential reviewers.\n", "Can one of the admins verify this patch?\n", "Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit https://cla.developers.google.com/ to sign.**\n\nOnce you've signed, please reply here (e.g. `I signed it!`) and we'll verify.  Thanks.\n\n---\n- If you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n- If you signed the CLA as a corporation, please let us know the company's name.\n\n<!-- need_sender_cla -->\n", "@googlebot Done.\n", "CLAs look good, thanks!\n\n<!-- ok -->\n", "Jenkins, test this please.\n"]}, {"number": 5134, "title": "Get HTTP 404 ERROR with all the version when install\uff1f", "body": "Hello,when I install tensorflow with the version of OS X python3 gpu, it brings me the error as \n\n```\n\"HTTP error 404 while getting https://storage.googleapis.com/tensorflow/mac/gpu/tensorflow-0.11.0rc1-py3-none-any.whl\n  Could not install requirement tensorflow==0.11.0rc1 from https://storage.googleapis.com/tensorflow/mac/gpu/tensorflow-0.11.0rc1-py3-none-any.whl because of error 404 Client Error: Not Found for url: https://storage.googleapis.com/tensorflow/mac/gpu/tensorflow-0.11.0rc1-py3-none-any.whl\"\n```\n\nHow to solve it?\n", "comments": ["I have same probrem. all TF_BINARY_URL are 404 error.\n", "Same problem here. Tried to install TensorFlow 0.11.0RC1 for Linux (Python 2.7) with GPU-Support:\n\n```\nhttps://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.11.0rc1-cp27-none-linux_x86_64.whl\n```\n\nThrows HTTP error 404; file not available.\n\nSame for CPU-only version.\n", "Could you change the title? This issue does not only apply for the OS X download links, I keep getting 404's for every pip wheel.\n", "As a temporary workaround, I'd suggest using the **rc0** release:\n\nChange:\n\n`https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0rc1-py3-none-any.whl`\n\nTo:\n\n`https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0rc0-py3-none-any.whl`\n\n(same applies for other URLs)\n", "@asmello It works,thank you.\n", "...but this only supports CUDA 7.5. I already updated to 8.0 when I saw TF supports it now.\n\nHowever, one can also compile from source or use the nightly wheels from github in order to install **RC1** (scroll down to \"Installation\"):\n\n```\nhttps://github.com/tensorflow/tensorflow\n```\n", "I've successfully managed to install 0.11 from the master branch of documentation (see combobox at the upper left corner).\nhttps://www.tensorflow.org/versions/master/get_started/os_setup.html#pip-installation\n", "@kernelmode That actually installs **rc0**, though.\n", "It seems the problem has been fixed\n", "I'm getting a protobuf version mismatch with rc0 wheel. \n\n> Installing collected packages: protobuf, tensorflow\n>   Found existing installation: protobuf 3.0.0a2\n>     Uninstalling protobuf-3.0.0a2:\n>       Successfully uninstalled protobuf-3.0.0a2\n>   Found existing installation: tensorflow 0.11.0rc0\n>     Uninstalling tensorflow-0.11.0rc0:\n>       Successfully uninstalled tensorflow-0.11.0rc0\n> Successfully installed protobuf-3.0.0 tensorflow-0.11.0rc1\n\nAnd then trying to import\n\n```\npython -c \"import tensorflow\"\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/__init__.py\", line 23, in <module>\n    from tensorflow.python import *\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/__init__.py\", line 53, in <module>\n    from tensorflow.core.framework.graph_pb2 import *\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/core/framework/graph_pb2.py\", line 16, in <module>\n    from tensorflow.core.framework import node_def_pb2 as tensorflow_dot_core_dot_framework_dot_node__def__pb2\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/core/framework/node_def_pb2.py\", line 16, in <module>\n    from tensorflow.core.framework import attr_value_pb2 as tensorflow_dot_core_dot_framework_dot_attr__value__pb2\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/core/framework/attr_value_pb2.py\", line 16, in <module>\n    from tensorflow.core.framework import tensor_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__pb2\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/core/framework/tensor_pb2.py\", line 16, in <module>\n    from tensorflow.core.framework import tensor_shape_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__shape__pb2\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/core/framework/tensor_shape_pb2.py\", line 22, in <module>\n    serialized_pb=_b('\\n,tensorflow/core/framework/tensor_shape.proto\\x12\\ntensorflow\\\"z\\n\\x10TensorShapeProto\\x12-\\n\\x03\\x64im\\x18\\x02 \\x03(\\x0b\\x32 .tensorflow.TensorShapeProto.Dim\\x12\\x14\\n\\x0cunknown_rank\\x18\\x03 \\x01(\\x08\\x1a!\\n\\x03\\x44im\\x12\\x0c\\n\\x04size\\x18\\x01 \\x01(\\x03\\x12\\x0c\\n\\x04name\\x18\\x02 \\x01(\\tB2\\n\\x18org.tensorflow.frameworkB\\x11TensorShapeProtosP\\x01\\xf8\\x01\\x01\\x62\\x06proto3')\nTypeError: __init__() got an unexpected keyword argument 'syntax'\n```\n\nThis thread https://github.com/tensorflow/tensorflow/issues/11 seems to mention this to be a protobuf version mismatch error but I'm not sure. \n\nAny workarounds or if I did something wrong?\n", "@beastlovezxc @YusukeSuzuki @ascenator : Based on @OverFlow7 's comment, it seems that this has been resolved and you are able to download the .whl now?\n\nI'm going to close this, but if it hasn't been resolved feel free to reopen and if possible please paste the output of `curl -v -L \"${TF_BINARY_URL}\" -o /dev/null` as it might help diagnose any issues with fetching (FWIW, I'm unable to reproduce this error now).\n\n@mohitsharma0690 : Your issue seems unrelated to the HTTP 404s. If you're still having trouble, could you file a new issue and detail out the exact steps you followed (and the platform - are you doing this on OS X or Ubuntu?). Thanks.\n", "When i tried to pip install GPU version(which I found on official site), it gave me this:\r\n`HTTP error 404 while getting https://storage.googleapis.com/tensorflow/windows/gpu/tensorflow_gpu-0.12.0rc1-cp35-cp35m-win_amd64.whl`\r\nBut when i tried the `0rc0` version, it works, So what's happening"]}, {"number": 5133, "title": "Tensorboard not executing as '__main__', name conflict with directory?", "body": "### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n\n[Similar errors identified as name conflicts between module and directory](http://stackoverflow.com/questions/24829769/module-object-has-no-attribute-main-django)\n### Environment info\n\nOperating System:  macOS Sierra\n\nIf installed from binary pip package, provide:\n1. A link to the pip package you installed:\n   current osx [nightly](https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON2,label=mac-slave/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-0.11.0rc0-py2-none-any.whl)\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\n   0.11.0rc0\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\n\nIn terminal window run 'tensorboard'\n\nOutput: \n\n> File \"<TENSORFLOW DIR>/tensorflow/lib/python2.7/site-packages/tensorflow/tensorboard/tensorboard.py\", line 43, in main\n>     logdir = os.path.expanduser(FLAGS.logdir)\n> AttributeError: 'NoneType' object has no attribute 'logdir'\n### What other attempted solutions have you tried?\n\nA workaround is to rename tensorboard.py (I used tensorboard1.py) and execute with full path to that file.\n\nOriginally I printed `__name__`  and learned it was 'tensorflow.tensorboard.tensorboard'.\n", "comments": ["Looks like it's a regression introduced by the argparse refactoring\n", "Thanks for the report @mikowals and the diagnosis @llhe. This is indeed a result of the argparse refactoring.\n\nFYI @elibixby\n", "This is a duplicate of #4903 a rollback of the offending CLs changes to Tensorboard is in  progress. \n"]}, {"number": 5132, "title": "Fix SWIG compilation across repositories", "body": "PTAL @drpngx\n", "comments": ["@jart, thanks for your PR! By analyzing the history of the files in this pull request, we identified @keveman, @tensorflower-gardener and @josh11b to be potential reviewers.\n", "Nice!\n", "Jenkins, test this please.\n"]}, {"number": 5131, "title": "Fix cmake build by restoring changes from commit c25f125.", "body": "", "comments": ["@gunan, thanks for your PR! By analyzing the history of the files in this pull request, we identified @mrry, @tensorflower-gardener and @guschmue to be potential reviewers.\n"]}, {"number": 5130, "title": "Merge release branch r0.11 for 0.11.0rc1 back to master.", "body": "", "comments": ["@yifeif, thanks for your PR! By analyzing the history of the files in this pull request, we identified @tensorflower-gardener, @concretevitamin and @gunan to be potential reviewers.\n", "We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n\n<!-- need_author_consent -->\n", "All changes already in repo, CLA ok to ignore.\n"]}, {"number": 5129, "title": "Merge release branch R0.11 back to master", "body": "", "comments": ["@yifeif, thanks for your PR! By analyzing the history of the files in this pull request, we identified @tensorflower-gardener, @vrv and @keveman to be potential reviewers.\n", "We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n\n<!-- need_author_consent -->\n"]}, {"number": 5128, "title": "os_setup.md references \"Installing from sources\" consistently", "body": "", "comments": ["Can one of the admins verify this patch?\n", "@ahundt, thanks for your PR! By analyzing the history of the files in this pull request, we identified @martinwicke, @keveman and @vrv to be potential reviewers.\n", "Jenkins, test this please.\n", "Please resolve conflicts.\n", "@tensorflow-jenkins test this please\n"]}, {"number": 5127, "title": "extend tf.select to broadcast a scalar condition #3945", "body": "continuation of pull request GH-3995\n", "comments": ["Can one of the admins verify this patch?\n", "@Mistobaan, thanks for your PR! By analyzing the history of the files in this pull request, we identified @tensorflower-gardener, @ebrevdo and @keveman to be potential reviewers.\n", "@drpngx re-posted \n", "@benoitsteiner Continued discussion here...\n", "Jenkins, test this please.\n", "@Mistobaan thanks for your new PR. I looked at the code, and it looked great, so I merged it.\n", "\ud83c\udf89  wohoo \ud83c\udf89 \n"]}, {"number": 5126, "title": "Documentation request: NN regression", "body": "There is a disconnect between the CSV documentation and the regression docs. I've documented one example here: http://stackoverflow.com/questions/40093776/csv-tensorflow-regression-via-neural-network-model\n\nI would like to request clearer examples of feeding neural networks with CSV or NDArrays. Most of the NN examples I've seen were strictly classification. They do not show how to take Numpy NDarrays (features x instances or class column) or CSV to predict a regression column.\n\nThe documentation I found on these pages below was confusing or vague. Overall, there are major gaps for doing the task above. The proposed documentation would clearly demonstrate with complete code using any of these: DNNRegressor, TensorFlowDNNRegressor, LinearRegressor, TensorFlowLinearRegressor, TensorFlowRNNRegressor, TensorFlowRegressor. If such documentation exists and I have yet to discover it, please advise me. Thanks.\n- Base code that reads CSV and works (classifier): https://www.tensorflow.org/versions/r0.11/tutorials/tflearn/index.html\n- Regressor: https://www.tensorflow.org/versions/r0.11/api_docs/python/contrib.learn.html#DNNRegressor\n- CSV reading: https://www.tensorflow.org/versions/master/how_tos/reading_data/index.html#csv-files\n- Column embedding: https://www.tensorflow.org/versions/r0.11/tutorials/wide_and_deep/index.html\n- List of APIs (DNNRegressor, TensorFlowDNNRegressor, LinearRegressor, TensorFlowLinearRegressor, TensorFlowRNNRegressor, TensorFlowRegressor): https://www.tensorflow.org/versions/r0.11/api_docs/python/contrib.learn.html\n", "comments": ["@ldmtwo : I'm sorry that the documentation is lacking. We welcome pull requests to improve them! So, please don't hesitate to contribute.\n\nSince the issue description is a bit broad, I'm going to close this out. But if you can point out specific examples of what you find vague on individual documents, we'll be happy to address those (in which case re-open this issue or file a new one).\n"]}, {"number": 5125, "title": "InvalidArgumentError : input must be 4-dimensional[100,100,3]", "body": "I am trying to use inception V1 model to predict single image. The example on the tensor flow website uses inception V3, which needs 1.7s-1.9s on a single Tian X GPU. This is not fast. \n\nI use the following python code to test V3 performance, which by changing **classify_image.py**\n\n```\n #... above code is for load graph and read image\n\nt1=time.time()\n\nsoftmax_tensor = sess.graph.get_tensor_by_name('softmax:0') \npredictions = sess.run(softmax_tensor,{'DecodeJpeg/contents:0': image_data}) \npredictions= np.squeeze(fpredictions)\n\ndelta=time.time()-t1\nprint(delta)\n```\n\nI think the major reason is V3 has 42 layers, which is too large. \n\nHowever, when i change the above code for V1 model. I meet errors. First I get the node names from V1 model .pb file as below:\n**input\nconv2d0_w\nconv2d0_b\nconv2d1_w**\n...\n...\n...\n**softmax2\noutput\noutput1\noutput2**\n\nSo the entry point of V1 model is **input**. The entry point of V3 is **DecodeJpeg/contents**, which accept image buffer from **tf.gfile.FastGFile(image, 'rb').read()** function directly. But V1 does not. So i use the code below to get the image and return as an array.\n\n**image_data**=**cv2**.imread(image)  \n\nNow the code for V1 model become for prediction become\n\n```\nsoftmax_tensor = sess.graph.get_tensor_by_name('softmax2:0')\npredictions = sess.run(softmax_tensor, {'input:0': image_data})\n```\n\nHowever, I get error below when i run the code.\n\nInvalidArgumentError (see above for traceback): **input must be 4-dimensional**[100,100,3]\n     [[Node: conv2d0_pre_relu/conv = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"SAME\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_input_0, conv2d0_w)]]\n\nIt says it need a 4-dimensional input. My image array has width, height and channel only. So how can i create a 4D tensor from a single image for V1 model as input data?\n", "comments": ["As the data format is **NHWC**, It seems that the first dim \"N\" means batch size. So if the single input image is 100 \\* 100 \\* 3, then how to add 1 for \"N\", add a 100 \\* 100 \\* 1=1 on top of image?\n", "@civilmanxx : A couple of things:\n- IIUC, the inception v1 model requires the input to be normalized. Which means that the images must be of a precise size.\n- You're right, the 4 dimensions is because the model accepts batches of images\n- You can see this normalization in the [label_image C++ example](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/label_image) ([main.cc](https://github.com/tensorflow/tensorflow/blob/20c02ffe0e6b8af4902487f852e15daa16caa523/tensorflow/examples/label_image/main.cc#L117)) - which casts the pixels to a float, resizes it, normalized the value by subtracting a mean and extends the number of dimensions.\n\nHope that helps. Please feel free to reopen the bug if your concerns weren't addressed.\n", "@civilman628 Did you find a solution for this? I'm facing the same issue."]}, {"number": 5124, "title": "Made mnist tutorial data storage folder consistent", "body": "modified fully_connnected_feed.py train_dir to data_dir as other files\nand made the default as /tmp/data\nto avoid downloading data in the source folder.\n", "comments": ["@willdzeng, thanks for your PR! By analyzing the history of the files in this pull request, we identified @tensorflower-gardener, @vrv and @dsmilkov to be potential reviewers.\n", "Can one of the admins verify this patch?\n", "@drpngx Can you check if the new commit is good?\n\nOne thing I noteiced is the copyright year of all the code is still 2015, and my sublime keep updating the copyright year to 2015-2016 itself. I am wondering if you guys want to update that.\n", "Nice, thanks!\n", "Jenkins, test this please.\n", "It fails the test, can you fix?\n", "I am trying to fix, it's weird. I will switch to python 3 and test myself.\n", "Added Make directory of log_dir to avoid non-existed directory that may cause failure on other platforms.\n\n`if tf.gfile.Exists(FLAGS.log_dir):\n    tf.gfile.DeleteRecursively(FLAGS.log_dir)\n  tf.gfile.MakeDirs(FLAGS.log_dir)`\n", "Jenkins, test this please.\n", "Still broken. Do you want to take another stab at it?\n", "Is there any way to pull the failure log? I tested on my Linux with python3, it works for me.\n", "Sorry, build appears to be broken right now, possibly due to #5127. See discussion on #5103.\n", "I see. I just updated the Saver into V2 to avoid warning.\n", "@drpngx I pulled the recent changes from master into the branch, does the build fixed? can you ask Jenkins to give another trial?\n", "Jenkins, test this please.\n", "Looks like there's some kind of windows error. I think we're waiting on a fix for that.\n", "Nice find, yes!\n\nOn Fri, Oct 21, 2016 at 3:35 PM, DI ZENG notifications@github.com wrote:\n\n> ## _@willdzeng_ commented on this pull request.\n> \n> In tensorflow/examples/tutorials/mnist/fully_connected_feed.py\n> https://github.com/tensorflow/tensorflow/pull/5124:\n> \n> > @@ -251,9 +251,9 @@ def main(_):\n> >        help='Batch size.  Must divide evenly into the dataset sizes.'\n> >    )\n> >    parser.add_argument(\n> > -      '--train_dir',\n> > -      '--data_dir',\n> \n> something like this?\n> https://github.com/tensorflow/tensorflow/blob/master/\n> tensorflow/examples/tutorials/mnist/mnist_with_summaries.py#L201\n> \n> \u2014\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> https://github.com/tensorflow/tensorflow/pull/5124, or mute the thread\n> https://github.com/notifications/unsubscribe-auth/AT_SbUwQhyPZ2lKL0gOynJEQnMHIQqW2ks5q2T4ogaJpZM4KdmZI\n> .\n", "@drpngx I found out it's because the BUILD file having extra arguments and causing the failure on python3 test. The new commit should fix my test failure.\n", "Jenkins, test this please.\n"]}, {"number": 5123, "title": "Add test call to file_io.delete_recursively.", "body": "", "comments": ["@anand-c-goog, thanks for your PR! By analyzing the history of the files in this pull request, we identified @caisq to be a potential reviewer.\n", "Jenkins, test this please.\n", "Can one of the admins verify this patch?\n"]}]