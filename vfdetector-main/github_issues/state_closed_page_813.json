[{"number": 29145, "title": "[ROCm] Adding ROCm support for check_numerics op", "body": "This PR adds ROCm support for check_numerics op\r\n\r\nThe changes in this PR are trivial, please review and merge...thanks.\r\n\r\n------------------------\r\n\r\n@tatianashp @whchung ", "comments": []}, {"number": 29144, "title": "PyCharms can't resolve certain \"from\" imports", "body": "PyCharms doesn't provide suggestions for some of the TensorFlow imports. For example:\r\n\r\n```python\r\nfrom tensorflow.nn import rnn_cell\r\nfrom tensorflow.keras import losses\r\n```\r\n\r\nIn these cases, PyCharms doesn't provide suggestions for `rnn_cell` or `losses` members.\r\n\r\nA potential solution for the `rnn_cell` import is to put API tree under root of TensorFlow pip package instead of under `_api/v1` or `_api/v2`. However, this won't fix suggestions for `keras` import since `keras` API is in a different directory and we create an alias for it under `tensorflow`.\r\n\r\nThis issue is a follow up from https://github.com/tensorflow/tensorflow/issues/26502.", "comments": ["Hi @annarev ,\r\nCould you please let us know when this issue would be resolved as it makes our lives too difficult.\r\nWe cannot utilize pycharm now to import keras from tensorflow.", "@mihaimaruseac I think this issue should be reopened again since we have not resolved the issue yet.", "This issue is open", "Still an issue for me using the beta release of tf2. \r\n\r\nUsing pycharm 2019.", "it's to difficult to use tf now with out ide promp.  tf-nightly-2.0-preview           2.0.0.dev20190714", "This should be workable now from 2.0 latest release candidate", "The code works, at least a simple example from official tf page, but IDE (Pycharm Professional 2019 in my case) still doesn't provide any suggestions; I'm using latest 2.0.0 stable release", "That's news. Can you try with https://github.com/tensorflow/tensorflow/issues/26502#issuecomment-537225803?", "Just checked it, the EAP build works, I do apologise for the confusion", "@annarev  \r\nCan you please try on latest version and update if the issue persist.", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29144\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29144\">No</a>\n"]}, {"number": 29143, "title": "[TF-TRT] Support shrink_axis_mask for StridedSlice", "body": "Supports shrink_axis_mask for StridedSlice by reshaping after performing the slice.", "comments": []}, {"number": 29142, "title": "Fix activation argument document for ConvLSTM2D", "body": "In the tf.keras.layers.ConvLSTM2D [example](https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/ConvLSTM2D#__init__ ) the activation = 'tanh'\r\nwhereas the documentation says no activation is applied (ie. \"linear\" activation: a(x) = x).", "comments": []}, {"number": 29141, "title": "Import error", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Win 10 64 Bt\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: -\r\n- TensorFlow installed from (source or binary): Anaconda\r\n- TensorFlow version: 1.10\r\n- Python version: 3.6.6\r\n- Installed using virtualenv? pip? conda?: Conda\r\n- Bazel version (if compiling from source): Anaconda\r\n- GCC/Compiler version (if compiling from source): Anaconda\r\n- CUDA/cuDNN version: no, because no GPU\r\n- GPU model and memory: no GPU\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n---------------------------------------------------------------------------\r\nImportError                               Traceback (most recent call last)\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow.py in <module>()\r\n     57 \r\n---> 58   from tensorflow.python.pywrap_tensorflow_internal import *\r\n     59   from tensorflow.python.pywrap_tensorflow_internal import __version__\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow_internal.py in <module>()\r\n     27             return _mod\r\n---> 28     _pywrap_tensorflow_internal = swig_import_helper()\r\n     29     del swig_import_helper\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow_internal.py in swig_import_helper()\r\n     23             try:\r\n---> 24                 _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n     25             finally:\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\imp.py in load_module(name, file, filename, details)\r\n    242         else:\r\n--> 243             return load_dynamic(name, filename, file)\r\n    244     elif type_ == PKG_DIRECTORY:\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\imp.py in load_dynamic(name, path, file)\r\n    342             name=name, loader=loader, origin=path)\r\n--> 343         return _load(spec)\r\n    344 \r\n\r\nImportError: DLL load failed: Das angegebene Modul wurde nicht gefunden.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-3-979e106fa729> in <module>()\r\n----> 1 from keras import backend as K\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\keras\\__init__.py in <module>()\r\n      1 from __future__ import absolute_import\r\n      2 \r\n----> 3 from . import utils\r\n      4 from . import activations\r\n      5 from . import applications\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\keras\\utils\\__init__.py in <module>()\r\n      4 from . import data_utils\r\n      5 from . import io_utils\r\n----> 6 from . import conv_utils\r\n      7 \r\n      8 # Globally-importable utils.\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\keras\\utils\\conv_utils.py in <module>()\r\n      7 from six.moves import range\r\n      8 import numpy as np\r\n----> 9 from .. import backend as K\r\n     10 \r\n     11 \r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\keras\\backend\\__init__.py in <module>()\r\n     87 elif _BACKEND == 'tensorflow':\r\n     88     sys.stderr.write('Using TensorFlow backend.\\n')\r\n---> 89     from .tensorflow_backend import *\r\n     90 else:\r\n     91     # Try and load external backend.\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py in <module>()\r\n      3 from __future__ import print_function\r\n      4 \r\n----> 5 import tensorflow as tf\r\n      6 from tensorflow.python.framework import ops as tf_ops\r\n      7 from tensorflow.python.training import moving_averages\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\__init__.py in <module>()\r\n     20 \r\n     21 # pylint: disable=g-bad-import-order\r\n---> 22 from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\r\n     23 \r\n     24 try:\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\__init__.py in <module>()\r\n     47 import numpy as np\r\n     48 \r\n---> 49 from tensorflow.python import pywrap_tensorflow\r\n     50 \r\n     51 # Protocol buffers\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow.py in <module>()\r\n     72 for some common reasons and solutions.  Include the entire stack trace\r\n     73 above this error message when asking for help.\"\"\" % traceback.format_exc()\r\n---> 74   raise ImportError(msg)\r\n     75 \r\n     76 # pylint: enable=wildcard-import,g-import-not-at-top,unused-import,line-too-long\r\n\r\nImportError: Traceback (most recent call last):\r\n  File \"C:\\Users\\andi\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"C:\\Users\\andi\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"C:\\Users\\andi\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\site-packages\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"C:\\Users\\andi\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\imp.py\", line 243, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"C:\\Users\\andi\\AppData\\Local\\Continuum\\anaconda3\\envs\\myenv\\lib\\imp.py\", line 343, in load_dynamic\r\n    return _load(spec)\r\nImportError: DLL load failed: Das angegebene Modul wurde nicht gefunden.\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\nSee https://www.tensorflow.org/install/install_sources#common_installation_problems\r\n\r\nfor some common reasons and solutions.  Include the entire stack trace\r\nabove this error message when asking for help.\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nfrom keras import backend as K\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n", "comments": ["@andi677 Can you please import tensorflow as initial step and then import keras. Please let us know how it progresses. Thanks!", "Automatically closing due to lack of recent activity. Please update the issue when new information becomes available, and we will reopen the issue. Thanks!\r\n"]}, {"number": 29140, "title": "cannot import a pretrained mobilenet multiple times", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below):1.12\r\n- Python version:2.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:10.1.105\r\n- GPU model and memory: m60, 8gb\r\n\r\nI am trying to use a pre-trained MobileNet for transfer learning however i am running into a problem when i am trying to run the same command the second time\r\n\r\n    import tensorflow as tf\r\n    try:\r\n        del g1\r\n    except:\r\n        pass\r\n    tf.reset_default_graph()\r\n    g1 = tf.Graph() #or g1 = tf.get_default_graph() both result in same behavior\r\n    with g1.as_default():\r\n        base_model = tf.keras.applications.MobileNetV2(input_shape=(160,160,3),\r\n                                                           include_top=False,\r\n                                                           weights='imagenet')\r\nI can run this cell in jupyter alright the first time but the second time i try to run this i get \r\n`TypeError: Cannot interpret feed_dict key as Tensor: Tensor Tensor(\"Placeholder_207:0\", shape=(160,), dtype=float32) is not an element of this graph.`\r\nHowever, I can run this cell multiple times perfectly fine\r\n\r\n    base_model = tf.keras.applications.MobileNetV2(input_shape=(160,160,3),\r\n                                                           include_top=False,\r\n                                                           weights='imagenet')\r\n", "comments": ["I was able to reproduce the mentioned issue on Tensorflow 1.12. ", "Any updates on this?", "This is not Build/Installation or Bug/Performance issue. Please post this kind of support questions at [Stackoverflow](https://stackoverflow.com/questions/tagged/tensorflow). There is a big community to support and learn from your questions. GitHub is mainly for addressing bugs in installation and performance. Thanks!", "How is this not a Bug? ", "@Nitinsiwach Sorry for the delay in my response. I ran your code in `TF1.15.0` and I don't see the issue. That particular block I ran 7 times without any issue. Please check the [gist here](https://colab.sandbox.google.com/gist/jvishnuvardhan/e2439a3866424044d428d3e9567cea1f/untitled588.ipynb). Thanks\r\n\r\nPlease close the issue if the issue was resolved already. Thanks!", "Automatically closing this out since I understand it to be resolved, but please let me know if I'm mistaken.Thanks!", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29140\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29140\">No</a>\n"]}, {"number": 29139, "title": "Change many incorrect uses of ValueError to TypeError", "body": "These are TypeError instead of ValueError. See https://docs.python.org/3/library/exceptions.html#TypeError :\r\nPassing arguments of the wrong type (e.g. passing a list when an int is expected) should result in a TypeError, but passing arguments with the wrong value (e.g. a number outside expected boundaries) should result in a ValueError.", "comments": ["Sadly the exceptions raised by TensorFlow are part of our public API, and as such we cannot change them, as changing would break existing code which uses try...except to catch exceptions.", "Thanks @alextp. I also found many occurrences of TypeError. For consistency, do you think we also need to modify them?", "@I-Hong sadly API stability trumps consistency :-/\r\n\r\nWe could have reasonably made this change for 2.x only before the 2.x alpha, but that ship has sailed."]}, {"number": 29138, "title": "[INTEL MKL] Install latest future module as part of pip installs", "body": "We need the latest `future` version otherwise we get:\r\n```\r\nDEBUG: Rule 'io_bazel_rules_docker' indicated that a canonical reproducible form can be obtained by modifying arguments shallow_since = \"1556410077 -0400\"\r\nLoading: 0 packages loaded\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (1 packages loaded, 0 targets configured)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (3 packages loaded, 0 targets configured)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (73 packages loaded, 30 targets configured)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (295 packages loaded, 6382 targets configured)\r\nTraceback (most recent call last):\r\n  File \"/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/external/org_tensorflow/tensorflow/tools/git/gen_git_source.py\", line 29, in <module>\r\n    from builtins import bytes  # pylint: disable=redefined-builtin\r\nImportError: No module named builtins\r\nERROR: /tensorflow/tensorflow/core/BUILD:2778:1: no such package '@local_config_git//': Traceback (most recent call last):\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 61\r\n\t\t_fail(result.stderr)\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 14, in _fail\r\n\t\tfail((\"%sGit Configuration Error:%s %...)))\r\nGit Configuration Error: Traceback (most recent call last):\r\n  File \"/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/external/org_tensorflow/tensorflow/tools/git/gen_git_source.py\", line 29, in <module>\r\n    from builtins import bytes  # pylint: disable=redefined-builtin\r\nImportError: No module named builtins\r\n\r\n and referenced by '//tensorflow/core:version_info_gen'\r\nERROR: /tensorflow/tensorflow/core/BUILD:2778:1: no such package '@local_config_git//': Traceback (most recent call last):\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 61\r\n\t\t_fail(result.stderr)\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 14, in _fail\r\n\t\tfail((\"%sGit Configuration Error:%s %...)))\r\nGit Configuration Error: Traceback (most recent call last):\r\n  File \"/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/external/org_tensorflow/tensorflow/tools/git/gen_git_source.py\", line 29, in <module>\r\n    from builtins import bytes  # pylint: disable=redefined-builtin\r\nImportError: No module named builtins\r\n\r\n and referenced by '//tensorflow/core:version_info_gen'\r\nERROR: /tensorflow/tensorflow/core/BUILD:2778:1: no such package '@local_config_git//': Traceback (most recent call last):\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 61\r\n\t\t_fail(result.stderr)\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 14, in _fail\r\n\t\tfail((\"%sGit Configuration Error:%s %...)))\r\nGit Configuration Error: Traceback (most recent call last):\r\n  File \"/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/external/org_tensorflow/tensorflow/tools/git/gen_git_source.py\", line 29, in <module>\r\n    from builtins import bytes  # pylint: disable=redefined-builtin\r\nImportError: No module named builtins\r\n\r\n and referenced by '//tensorflow/core:version_info_gen'\r\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted: no such package '@local_config_git//': Traceback (most recent call last):\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 61\r\n\t\t_fail(result.stderr)\r\n\tFile \"/tensorflow/third_party/git/git_configure.bzl\", line 14, in _fail\r\n\t\tfail((\"%sGit Configuration Error:%s %...)))\r\nGit Configuration Error: Traceback (most recent call last):\r\n  File \"/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/external/org_tensorflow/tensorflow/tools/git/gen_git_source.py\", line 29, in <module>\r\n    from builtins import bytes  # pylint: disable=redefined-builtin\r\nImportError: No module named builtins\r\n```", "comments": ["This should also be cherry picked to `r1.14` branch.", "@agramesh1 ", "Hi @penpornk \r\nAny feedback on this would be great.\r\nWe certainly want the change in `tensorflow/tools/ci_build/linux/mkl/Dockerfile.devel-mkl` file, the changes in the other file is just for keeping things consistent.\r\n\r\nThis issue is causing our `Python2.7` builds to fail so prioritizing it is highly appreciated.", "Looks like @av8ramit debugged a similar issue before.", "Looks like we are failing during `test_async_copy_reraise` here: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/engine/training_utils_test.py#L406", "Yes, installing latest future will resolve this", "Thanks - please send me a PR for the r1.14 branch once this is merged", "@bananabowl it was submitted here for `r1.14`: #29233 "]}, {"number": 29137, "title": "Updating `_get_noise_shape()` to work in graph mode", "body": "Using the `noise_shape` argument in the `tf.keras.layers.Dropout` initializer currently doesn't work with `tf.function` if you have variable batch sizes because TF can't get the correct dropout mask size to use each batch. This was due to using `x.shape.dims` to fill in batch-specific sizes, but that doesn't work when autographed because the values stay as `None`. Changing this to `tf.shape(x)` fixes that.", "comments": ["\nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit <https://cla.developers.google.com/> to sign.**\n\nOnce you've signed (or fixed any issues), please reply here (e.g. `I signed it!`) and we'll verify it.\n\n----\n\n#### What to do if you already signed the CLA\n\n##### Individual signers\n\n*   It's possible we don't have your GitHub username or you're using a different email address on your commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n\n##### Corporate signers\n\n*   Your company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to [go/cla#troubleshoot](http://go/cla#troubleshoot) ([Public version](https://opensource.google.com/docs/cla/#troubleshoot)).\n*   The email used to register you as an authorized contributor must be the email used for the Git commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n*   The email used to register you as an authorized contributor must also be [attached to your GitHub account](https://github.com/settings/emails).\n\t\t\n\n\u2139\ufe0f **Googlers: [Go here](https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fpull%2F29137) for more info**.\n\n<!-- need_sender_cla -->", "@velocirabbit please sign CLA.", "> @velocirabbit please sign CLA.\r\n\r\nJust signed it!", "CLAs look good, thanks!\n\n\u2139\ufe0f **Googlers: [Go here](https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fpull%2F29137) for more info**.\n\n<!-- ok -->", "Closing this PR as this not against `master`, please open a new PR against `master` \r\nCC @mihaimaruseac"]}, {"number": 29136, "title": "Batch Training for different input sizes", "body": "\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nFor fully convolution networks training the network with different inputs sizes in batches is not supported, but could be changed.\r\n\r\n**Will this change the current api? How?**\r\nThe optitmizers would need to be changed, such that the updates for the convolutional layer are summed for the different inputs.\r\n\r\n**Who will benefit with this feature?**\r\nPeople training fully convolutional networks. Padding of the input data could be completely avoided.", "comments": ["@dynamicwebpaige could you please share your ideas on this?", "Due to very little response I'm closin this. Feel free to write me when this issue is interesting for you.", "\"Padding from the input data could be completely avoided\" -- seems you're trying to have a dynamic shape on image dimension instead of batch dimension?", "Actually my idea was to have both dynamically. \r\nAs far as I know it is currently not possible to train a network on batches of data of different sizes. E.g. batch: image_1 512x512, image_2 256x256. \r\nMy idea was to make this possible. ", "1) We do support dynamic batch.\r\n2) That's probably a fundamental change within Tensorflow. I'm not sure we're planning to do that. If you'd like to contribute we'd welcome that."]}, {"number": 29135, "title": "tensorflow/tensorflow/lite/java/ovic/", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS Mojave v 10.14.3\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N.A.\r\n- TensorFlow installed from (source or binary): pip install tensorflow\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): 0.25.3\r\n- GCC/Compiler version (if compiling from source): Apple LLVM version 10.0.1 (clang-1001.0.46.4)\r\n- CUDA/cuDNN version: N.A.\r\n- GPU model and memory: N.A.\r\n\r\n**Describe the current behavior**\r\nI have followed https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/java/ovic to test a model for OVIC2019 submission. I did this by clone the repository of tensorflow source code and typing the commands as shown below. It failed to pass the test.\r\n\r\n**Describe the expected behavior**\r\nPass the test without bugs.\r\n\r\n**Code to reproduce the issue**\r\n`bazel test --cxxopt=--std=c++11 //tensorflow/lite/java/ovic:OvicClassifierTest --cxxopt=-Wno-all --test_output=all`\r\n\r\n**Other info / logs**\r\n```\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=191\r\nINFO: Reading rc options for 'test' from /Users/liu/Desktop/tensorflow/.bazelrc:\r\n  Inherited 'build' options: --apple_platform_type=macos --define framework_shared_object=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone --strategy=Genrule=standalone -c opt --announce_rc --define=grpc_no_ares=true --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include\r\nWARNING: /Users/liu/Desktop/tensorflow/tensorflow/lite/java/BUILD:81:12: in srcs attribute of android_library rule //tensorflow/lite/java:tensorflowlite_java: please do not import '//tensorflow/lite/delegates/nnapi/java/src/main/java/org/tensorflow/lite/nnapi:NnApiDelegate.java' directly. You should either move the file to this package or depend on an appropriate rule there\r\nINFO: Analyzed target //tensorflow/lite/java/ovic:OvicClassifierTest (0 packages loaded, 0 targets configured).\r\nINFO: Found 1 test target...\r\nERROR: /Users/liu/Desktop/tensorflow/tensorflow/lite/nnapi/BUILD:20:1: undeclared inclusion(s) in rule '//tensorflow/lite/nnapi:nnapi_implementation':\r\nthis rule is missing dependency declarations for the following files included by 'tensorflow/lite/nnapi/nnapi_implementation.cc':\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/cdefs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_symbol_aliasing.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_posix_availability.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_intptr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_uintptr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_intmax_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uintmax_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/Availability.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/AvailabilityInternal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_va_list.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_size_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_null.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_off_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ssize_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdlib.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdlib.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/wait.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_pid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_id_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/appleapiopts.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/_mcontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/_mcontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/mach/machine/_structs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/mach/i386/_structs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_attr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_sigaltstack.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ucontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_sigset_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_uid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/resource.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_timeval.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/libkern/_OSByteOrder.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/libkern/i386/_OSByteOrder.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/alloca.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ct_rune_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_rune_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_wchar_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/malloc/_malloc.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_dev_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_mode_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/dlfcn.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdbool.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/stdbool.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/fcntl.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/fcntl.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_o_sync.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_o_dsync.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_seek_set.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_s_ifmt.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_timespec.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_filesec_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/mman.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/stat.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_blkcnt_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_blksize_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ino_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ino64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_nlink_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_gid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_time_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/unistd.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/unistd.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_posix_vdisable.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_useconds_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/select.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_def.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_suseconds_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_setsize.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_set.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_clr.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_isset.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_zero.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_copy.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_select.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_uuid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/gethostuuid.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstdlib'\r\nTarget //tensorflow/lite/java/ovic:OvicClassifierTest failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 6.522s, Critical Path: 2.14s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully\r\n\r\nFAILED: Build did NOT complete successfully\r\n```", "comments": ["Are you building from head (master)? I'm not able to repro that error, though I do notice some other Mac-specific issues.", "Yes, I am building from the master branch. Moreover, it seems that when I try to run \r\n\r\n`bazel test --cxxopt=--std=c++11 //tensorflow/lite/java/ovic:OvicClassifierTest --cxxopt=-Wno-all --test_output=all`\r\n\r\nfor the second time, the error is a bit different.\r\n\r\n```\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=158\r\nINFO: Reading rc options for 'test' from /Users/liu/Desktop/tensorflow/.bazelrc:\r\n  Inherited 'build' options: --apple_platform_type=macos --define framework_shared_object=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone --strategy=Genrule=standalone -c opt --announce_rc --define=grpc_no_ares=true --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include\r\nWARNING: /Users/liu/Desktop/tensorflow/tensorflow/lite/java/BUILD:81:12: in srcs attribute of android_library rule //tensorflow/lite/java:tensorflowlite_java: please do not import '//tensorflow/lite/delegates/nnapi/java/src/main/java/org/tensorflow/lite/nnapi:NnApiDelegate.java' directly. You should either move the file to this package or depend on an appropriate rule there\r\nINFO: Analyzed target //tensorflow/lite/java/ovic:OvicClassifierTest (9 packages loaded, 44 targets configured).\r\nINFO: Found 1 test target...\r\nERROR: /private/var/tmp/_bazel_liu/d5b3928a6e0d42107436e80b168a9385/external/flatbuffers/BUILD.bazel:57:1: undeclared inclusion(s) in rule '@flatbuffers//:flatc_library':\r\nthis rule is missing dependency declarations for the following files included by 'external/flatbuffers/src/code_generators.cpp':\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/map'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__tree'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iterator'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iosfwd'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/wchar.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/wchar.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/cdefs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_symbol_aliasing.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_posix_availability.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/Availability.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/AvailabilityInternal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_null.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_size_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_mbstate_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_int64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_intptr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_uintptr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ct_rune_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_rune_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_wchar_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/stdarg.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_va_list.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_off_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ssize_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/time.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_clock_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_time_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_timespec.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/__wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_wint_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_wctype_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/ctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_ctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/runetype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__functional_base'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/type_traits'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstddef'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/stddef.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/__stddef_max_align_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__nullptr'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/typeinfo'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/exception'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstdlib'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdlib.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdlib.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/wait.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_pid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_id_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/appleapiopts.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/signal.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/_mcontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/_mcontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/mach/machine/_structs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/mach/i386/_structs.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_attr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_sigaltstack.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ucontext.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_sigset_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_uid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/resource.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/stdint.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint8_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint16_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint32_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uint64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_intmax_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_uintmax_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_timeval.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_endian.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/libkern/_OSByteOrder.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/libkern/i386/_OSByteOrder.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/alloca.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/malloc/_malloc.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_dev_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_mode_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstdint'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/new'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/utility'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__tuple'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/initializer_list'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstring'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/string.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/strings.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__debug'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/memory'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/limits'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__undef_macros'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/tuple'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stdexcept'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cassert'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/assert.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/atomic'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/algorithm'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/functional'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__node_handle'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/optional'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/sstream'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ostream'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cstdio'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cwchar'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cwctype'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cctype'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_wctrans_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/mutex'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__mutex_base'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/chrono'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ctime'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ratio'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/climits'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include/limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/machine/limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/i386/_limits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/syslimits.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/system_error'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__errc'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cerrno'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/errno.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/errno.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/errno.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__threading_support'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread/pthread_impl.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread/sched.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread_impl.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_cond_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_condattr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_key_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_mutex_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_mutexattr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_once_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_rwlock_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_rwlockattr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_pthread/_pthread_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/pthread/qos.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/qos.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_mach_port_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sched.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/locale.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/locale.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_locale.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_xlocale.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_ctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/__wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_stdio.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_stdlib.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_string.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_time.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_wchar.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/xlocale/_wctype.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/streambuf'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/locale'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/nl_types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/types.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_char.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_short.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_u_int.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_caddr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_blkcnt_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_blksize_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_gid_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_in_addr_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_in_port_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ino_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_ino64_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_key_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_nlink_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_useconds_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_suseconds_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_rsize_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_errno_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_def.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_setsize.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_set.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_clr.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_zero.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_isset.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fd_copy.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fsblkcnt_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/sys/_types/_fsfilcnt_t.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/_types/_nl_item.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__bsd_locale_defaults.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/bitset'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__bit_reference'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/istream'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/stack'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/deque'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__split_buffer'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/vector'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/set'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/experimental/string_view'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iomanip'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/cmath'\r\n  '/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/math.h'\r\n  '/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include/math.h'\r\nTarget //tensorflow/lite/java/ovic:OvicClassifierTest failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 8.703s, Critical Path: 4.70s\r\nINFO: 3 processes: 2 local, 1 worker.\r\nFAILED: Build did NOT complete successfully\r\n\r\nFAILED: Build did NOT complete successfully\r\n```\r\n", "Thanks for flagging the issue. Unfortunately, the TFLite Java tests won't work (yet) with Mac, neither have they ever worked directly with Mac. You'll have to use a Linux platform for now to test these bits. Note that building for *Android* on Mac should work just fine.", "Automatically closing this out since I understand it to be resolved, but please let me know if I'm mistaken.Thanks!"]}, {"number": 29134, "title": "tf.sparse.placeholder with partial defined shape return a SparseTensor with fully undefined shape", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): Anaconda\r\n- TensorFlow version (use command below): 1.13\r\n- Python version: 3.7.1\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory: \r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n```python\r\nIn [37]: X = tf.sparse.placeholder(tf.float32, (None, 3, 4))\r\n\r\nIn [38]: X.shape\r\nOut[38]: TensorShape([Dimension(None), Dimension(None), Dimension(None)])\r\n```\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\nI would expect the shape of X to be:\r\nTensorShape([Dimension(None), Dimension(3), Dimension(4)])\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n", "comments": ["BTW, I found that most of the ops on SparseTensor will return a SparseTensor with shape of all Nones, even if the input is fully defined. However, shape inference is really important if we want to use SparseTensor.", "I could reproduce the issue with Tensorflow 1.13.1.  ", "Currently SparseTensor is not capable of representing partially unknown shapes well. We have three options: either a fully unknown shape, a known rank but all unknown dimensions, or fully known shape.\r\n\r\nThe reason why this is the case is that the shape of a SparseTensor is represented as a Tensor. So either the tensor is constant, and then we know all dimensions, or it's not, and then we either know its shape (which determines the rank of the sparsetensor) or we do not (which means a sparsetensor with a fully unknown shape).\r\n\r\nThis is I think an unintended but unavoidable consequence of the existing representation for sparsetensor, so I don't think it's feasible to fix.", "For anyone who comes across this issue there seems to be better support for this in TF 2.3 using the `tf.keras.backend.placeholder` API (not sure if this was true in 2.0 as well).\r\n\r\nYou can define sparse placeholders with partial shapes:\r\n```python\r\n>>> X = tf.keras.backend.placeholder(shape=(None, 3, 4), dtype=tf.float32, sparse=True)\r\n>>> X.shape\r\nTensorShape([None, 3, 4])\r\n```\r\n\r\nAnd while the following is still true:\r\n\r\n> BTW, I found that most of the ops on SparseTensor will return a SparseTensor with shape of all Nones, even if the input is fully defined. However, shape inference is really important if we want to use SparseTensor.\r\n\r\nYou can get around it by wrapping the outputs in `tf.sparse.reset_shape()` calls, supplying the expected shape as a `Tensor` with `-1` instead of `None` for unknown dimensions.\r\n\r\nHope this helps."]}, {"number": 29133, "title": "[ROCm] Adding ROCm support for the batch_norm op", "body": "This PR adds ROCm support for the batch_norm op\r\n\r\nThe changes in this PR are trivial, please review and merge...thanks.\r\n\r\n-------------------\r\n\r\n@tatianashp @whchung ", "comments": []}, {"number": 29132, "title": "Tensorflow2.0 keras subclassed model, problems with getting correct output shape, shows 'multiple'", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: no\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): TensorFlow 2.0.0-alpha0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0, 7.5\r\n- GPU model and memory: 1080ti 11gb\r\n\r\n**Describe the current behavior**\r\nmodel.summary() prints 'multiple' as layer output shapes\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\n\r\nprint('TensorFlow', tf.__version__)\r\n\r\nclass ResidualBlock(tf.keras.Model):\r\n    def __init__(self, block_type=None, n_filters=None):\r\n        super(ResidualBlock, self).__init__()\r\n        self.n_filters = n_filters\r\n        if block_type == 'identity':\r\n            self.strides = 1\r\n        elif block_type == 'conv':\r\n            self.strides = 2\r\n            self.conv_shorcut = tf.keras.layers.Conv2D(filters=self.n_filters, \r\n                               kernel_size=1, \r\n                               padding='same',\r\n                               strides=self.strides,\r\n                               kernel_initializer='he_normal')\r\n            self.bn_shortcut = tf.keras.layers.BatchNormalization(momentum=0.9)\r\n            \r\n        self.conv_1 = tf.keras.layers.Conv2D(filters=self.n_filters, \r\n                               kernel_size=3, \r\n                               padding='same',\r\n                               strides=self.strides,\r\n                               kernel_initializer='he_normal')\r\n        self.bn_1 = tf.keras.layers.BatchNormalization(momentum=0.9)\r\n        self.relu_1 = tf.keras.layers.ReLU()\r\n        \r\n        self.conv_2 = tf.keras.layers.Conv2D(filters=self.n_filters, \r\n                               kernel_size=3, \r\n                               padding='same', \r\n                               kernel_initializer='he_normal')\r\n        self.bn_2 = tf.keras.layers.BatchNormalization(momentum=0.9)\r\n        self.relu_2 = tf.keras.layers.ReLU()\r\n        \r\n    def call(self, x, training=False):\r\n        shortcut = x\r\n        if self.strides == 2:\r\n            shortcut = self.conv_shorcut(x)\r\n            shortcut = self.bn_shortcut(shortcut)\r\n        y = self.conv_1(x)\r\n        y = self.bn_1(y)\r\n        y = self.relu_1(y)\r\n        y = self.conv_2(y)\r\n        y = self.bn_2(y)\r\n        y = tf.add(shortcut, y)\r\n        y = self.relu_2(y)\r\n        return y\r\n    \r\nclass ResNet34(tf.keras.Model):\r\n    def __init__(self, include_top=True, n_classes=1000):\r\n        super(ResNet34, self).__init__()\r\n        \r\n        self.n_classes = n_classes\r\n        self.include_top = include_top\r\n        self.conv_1 = tf.keras.layers.Conv2D(filters=64, \r\n                                               kernel_size=7, \r\n                                               padding='same', \r\n                                               strides=2, \r\n                                               kernel_initializer='he_normal')\r\n        self.bn_1 = tf.keras.layers.BatchNormalization(momentum=0.9)\r\n        self.relu_1 = tf.keras.layers.ReLU()\r\n        self.maxpool = tf.keras.layers.MaxPool2D(3, 2, padding='same')\r\n        self.residual_blocks = tf.keras.Sequential()\r\n        for n_filters, reps, downscale in zip([64, 128, 256, 512], \r\n                                              [3, 4, 6, 3], \r\n                                              [False, True, True, True]):\r\n            for i in range(reps):\r\n                if i == 0 and downscale:\r\n                    self.residual_blocks.add(ResidualBlock(block_type='conv', \r\n                                                              n_filters=n_filters))\r\n                else:\r\n                    self.residual_blocks.add(ResidualBlock(block_type='identity', \r\n                                                              n_filters=n_filters))\r\n        self.GAP = tf.keras.layers.GlobalAveragePooling2D()\r\n        self.fc = tf.keras.layers.Dense(units=self.n_classes)\r\n        \r\n    def call(self, x, training=False):\r\n        y = self.conv_1(x)\r\n        y = self.bn_1(y)\r\n        y = self.relu_1(y)\r\n        y = self.maxpool(y)\r\n        y = self.residual_blocks(y)\r\n        if self.include_top:\r\n            y = self.GAP(y)\r\n            y = self.fc(y)\r\n        return y\r\n    \r\nmodel = ResNet34()\r\nmodel.build((1, 224, 224, 3))\r\nmodel.summary()\r\n```\r\noutput log\r\n```\r\n\r\nTensorFlow 2.0.0-alpha0\r\nModel: \"res_net34\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\nconv2d (Conv2D)              multiple                  9472      \r\n_________________________________________________________________\r\nbatch_normalization_v2 (Batc multiple                  256       \r\n_________________________________________________________________\r\nre_lu (ReLU)                 multiple                  0         \r\n_________________________________________________________________\r\nmax_pooling2d (MaxPooling2D) multiple                  0         \r\n_________________________________________________________________\r\nsequential (Sequential)      multiple                  21300480  \r\n_________________________________________________________________\r\nglobal_average_pooling2d (Gl multiple                  0         \r\n_________________________________________________________________\r\ndense (Dense)                multiple                  513000    \r\n=================================================================\r\nTotal params: 21,823,208\r\nTrainable params: 21,806,184\r\nNon-trainable params: 17,024\r\n_________________________________________________________________\r\n```", "comments": ["@achandraa @jvishnuvardhan ", "@srihari-humbarwadi Able to reproduce the issue in TF 2.0, TF 1.13.1 , tf nightly (GPU versions) gist is [here](https://colab.sandbox.google.com/gist/jvishnuvardhan/237bfe24fb3a21aca23d2949ea063330/keras_tf29132.ipynb). Thanks!", "The difficulty here is that with subclassed models, summary() does not have enough information to know what the output shape of the model is. The list of layers is known, and hence printed, but how those layers are used is not known. We could print something other than \"multiple\" in that case, but it's not clear what would be more informative. What do you think?", "- Is there some lower level API to set output shapes, which could perhaps be called in build method?\n- I tried using a subclassed model within another  functional model, and i had no problem in getting the output shapes in the summary. This made me think and come up with the earlier query", "Example:\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nclass MyModel(tf.keras.Model):\r\n    def __init__(self):\r\n        super(MyModel, self).__init__()\r\n        self.dense1 = tf.keras.layers.Dense(4, activation=tf.nn.relu)\r\n        self.dense2 = tf.keras.layers.Dense(5, activation=tf.nn.softmax)\r\n    \r\n    def call(self, inputs):\r\n        x = self.dense1(inputs)\r\n        return self.dense2(x)\r\n    \r\n    def build_graph(self, input_shape): \r\n        input_shape_nobatch = input_shape[1:]\r\n        self.build(input_shape)\r\n        inputs = tf.keras.Input(shape=input_shape_nobatch)\r\n        \r\n        if not hasattr(self, 'call'):\r\n            raise AttributeError(\"User should define 'call' method in sub-class model!\")\r\n        \r\n        _ = self.call(inputs)\r\n        \r\n\r\nmodel = MyModel()\r\nmodel.build_graph((32,10,))\r\n\r\nmodel.summary()\r\n\r\ninput = np.random.random((32,10,))\r\ninput = input.astype(np.float32)\r\noutput = model.call(input)\r\n\r\nwith tf.Session() as sess:\r\n    sess.run(tf.global_variables_initializer())\r\n    result = output.eval(session=sess)\r\n\r\nprint('Model output shape:')\r\nprint(result.shape)\r\n```\r\nOutput:\r\n```prompt\r\nWARNING:tensorflow:From C:\\Users\\Jairo\\Anaconda3\\envs\\py35\\lib\\site-packages\\ten\r\nsorflow\\python\\ops\\resource_variable_ops.py:435: colocate_with (from tensorflow.\r\npython.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #\r\n=================================================================\r\ndense (Dense)                (None, 4)                 44\r\n_________________________________________________________________\r\ndense_1 (Dense)              (None, 5)                 25\r\n=================================================================\r\nTotal params: 69\r\nTrainable params: 69\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\nModel output shape:\r\n(32, 5)\r\n```", "I am closing this issue based on @karmel explanation on why it is difficult to track shape in subclassed models. You could also use workaround mentioned by @Ja1r0 . Thanks!\r\n\r\nClosing this out since I understand it to be resolved, but please let me know if I'm mistaken.", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29132\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29132\">No</a>\n", " @jvishnuvardhan @Ja1r0 's solution works, and I also adopt it. But if decorating with @tf.function, running build_model(...) will raise error. So it seems that one may firstly does not decorate it, get those definite shapes in the NN. Once the architecture is fixed, one may decorate it in training and testing etc. Is that an acceptable work-around?"]}, {"number": 29131, "title": "How to use optimizers from Tensorflow probability in Tensorflow?", "body": "I would like to use the BFGS optimizer from Tensorflow probability (https://www.tensorflow.org/probability/api_docs/python/tfp/optimizer/bfgs_minimize) in Tensorflow. Has anyone done this before and can tell me how to interface the BFGS optimizer?\r\n", "comments": ["Check out the usage examples in the unit tests: https://github.com/tensorflow/probability/blob/master/tensorflow_probability/python/optimizer/bfgs_test.py#L46\r\n\r\nThey're written in such a way as to abstract across TF1 and TF2 styles (`self.evaluate` runs the tensor in a session, for 1.x, and is essentially a no-op in 2.0). Otherwise, it should hopefully be clear how to use in some simple cases.", "Also: feel free to file TFP inquiries in the TFP github issues (https://github.com/tensorflow/probability/issues). Closing this one in TF for now.", "The usage examples in the unit tests fail: AttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\nModule versions:\r\ntensorboard (1.13.1)\r\ntensorflow (1.13.1)\r\ntensorflow-estimator (1.13.0)\r\ntensorflow-probability (0.6.0)\r\n\r\n`python3 bfgs_test.py \r\n\r\nWARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.\r\nFor more information, please see:\r\n  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md\r\n  * https://github.com/tensorflow/addons\r\nIf you depend on functionality not listed there, please file an issue.\r\n\r\nWARNING:tensorflow:From /usr/lib/python3.6/contextlib.py:60: TensorFlowTestCase.test_session (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `self.session()` or `self.cached_session()` instead.\r\n2019-06-05 11:51:10.645988: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-06-05 11:51:10.669441: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2599905000 Hz\r\n2019-06-05 11:51:10.669832: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2d457a0 executing computations on platform Host. Devices:\r\n2019-06-05 11:51:10.669862: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\nWARNING:tensorflow:From /home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py:3632: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nEEEEEEEEEEEEE/home/tudockho/.local/lib/python3.6/site-packages/numpy/lib/type_check.py:546: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead\r\n  'a.item() instead', DeprecationWarning, stacklevel=1)\r\nWARNING:tensorflow:From /home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3528: setdiff1d (from tensorflow.python.ops.array_ops) is deprecated and will be removed after 2018-11-30.\r\nInstructions for updating:\r\nThis op will be removed after the deprecation date. Please switch to tf.sets.difference().\r\n.s\r\n======================================================================\r\nERROR: test_asymmetric_inverse_hessian_spec (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 117, in test_asymmetric_inverse_hessian_spec\r\n    initial_inverse_hessian_estimate=bad_inv_hessian))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 60, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_bad_inverse_hessian_spec (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 100, in test_bad_inverse_hessian_spec\r\n    initial_inverse_hessian_estimate=bad_inv_hessian))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 60, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_data_fitting (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 350, in test_data_fitting\r\n    neg_log_likelihood, initial_position=start, tolerance=1e-6))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_determinism (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 391, in test_determinism\r\n    res1, res2 = get_results(), get_results()\r\n  File \"bfgs_test.py\", line 389, in get_results\r\n    rastrigin, initial_position=start, tolerance=1e-5))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_dynamic_shapes (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 418, in test_dynamic_shapes\r\n    quadratic, initial_position=start, tolerance=1e-8)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_himmelblau (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 253, in test_himmelblau\r\n    himmelblau, initial_position=start, tolerance=1e-8))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_himmelblau_batch_all (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 278, in test_himmelblau_batch_all\r\n    stopping_condition=tfp.optimizer.converged_all, tolerance=1e-8))\r\nAttributeError: module 'tensorflow_probability.python.optimizer' has no attribute 'converged_all'\r\n\r\n======================================================================\r\nERROR: test_himmelblau_batch_any (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 308, in test_himmelblau_batch_any\r\n    stopping_condition=tfp.optimizer.converged_any, tolerance=1e-8))\r\nAttributeError: module 'tensorflow_probability.python.optimizer' has no attribute 'converged_any'\r\n\r\n======================================================================\r\nERROR: test_inverse_hessian_spec (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 78, in test_inverse_hessian_spec\r\n    initial_inverse_hessian_estimate=test_inv_hessian))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 60, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_quadratic_bowl_10d (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 132, in test_quadratic_bowl_10d\r\n    quadratic, initial_position=start, tolerance=1e-8))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_quadratic_bowl_2d (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 57, in test_quadratic_bowl_2d\r\n    quadratic, initial_position=start, tolerance=1e-8))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_quadratic_with_skew (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 156, in test_quadratic_with_skew\r\n    quadratic, initial_position=start, tolerance=1e-8))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n======================================================================\r\nERROR: test_quadratic_with_strong_skew (__main__.BfgsTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow/python/framework/test_util.py\", line 946, in decorated\r\n    f(self, *args, **kwargs)\r\n  File \"bfgs_test.py\", line 179, in test_quadratic_with_strong_skew\r\n    quadratic, initial_position=start, tolerance=1e-8))\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs.py\", line 269, in minimize\r\n    control_inputs)\r\n  File \"/home/tudockho/.local/lib/python3.6/site-packages/tensorflow_probability/python/optimizer/bfgs_utils.py\", line 62, in get_initial_state_args\r\n    f0, df0 = value_and_gradients_function(initial_position)\r\n  File \"bfgs_test.py\", line 34, in val_and_grad\r\n    return tfp.math.value_and_gradient(value_fn, x)\r\nAttributeError: module 'tensorflow_probability.python.math' has no attribute 'value_and_gradient'\r\n\r\n----------------------------------------------------------------------\r\nRan 15 tests in 3.727s\r\n\r\nFAILED (errors=13, skipped=1)\r\n`\r\n", "If you're running tests at HEAD in the repo, you'll need to install `tfp-nightly` (and tf-nightly, respectively), which is built at HEAD every night, or run the tests using `bazel`, which will run the test using the locally checked out code.", "Which bazel version works to run the unit tests? I have 0.26.0 installed and get the error message:\r\n\r\n`bazel run //tensorflow_probability/python/optimizer:bfgs_test\r\nWARNING: The following rc files are no longer being read, please transfer their contents or import their path into one of the standard rc files:\r\n/home/tudockho/Documents/probability/tools/bazel.rc\r\nINFO: Analyzed target //tensorflow_probability/python/optimizer:bfgs_test (0 packages loaded, 0 targets configured).\r\nINFO: Found 1 target...\r\nTarget //tensorflow_probability/python/optimizer:bfgs_test up-to-date:\r\n  bazel-bin/tensorflow_probability/python/optimizer/bfgs_test\r\nINFO: Elapsed time: 0.201s, Critical Path: 0.00s\r\nINFO: 0 processes.\r\nINFO: Build completed successfully, 1 total action\r\nINFO: Build completed successfully, 1 total action\r\nexec ${PAGER:-/usr/bin/less} \"$0\" || exit 1\r\nExecuting tests from //tensorflow_probability/python/optimizer:bfgs_test\r\n-----------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/tudockho/.cache/bazel/_bazel_tudockho/cdbef65d6dc64b4853df3d19fd83a76d/execroot/tensorflow_probability/bazel-out/k8-fastbuild/bin/tensorflow_probability/python/optimizer/bfgs_test.runfiles/tensorflow_probability/tensorflow_probability/python/optimizer/bfgs_test.py\", line 27, in <module>\r\n    import tensorflow_probability as tfp\r\n  File \"/home/tudockho/.cache/bazel/_bazel_tudockho/cdbef65d6dc64b4853df3d19fd83a76d/execroot/tensorflow_probability/bazel-out/k8-fastbuild/bin/tensorflow_probability/python/optimizer/bfgs_test.runfiles/tensorflow_probability/tensorflow_probability/__init__.py\", line 68, in <module>\r\n    _ensure_tf_install()\r\n  File \"/home/tudockho/.cache/bazel/_bazel_tudockho/cdbef65d6dc64b4853df3d19fd83a76d/execroot/tensorflow_probability/bazel-out/k8-fastbuild/bin/tensorflow_probability/python/optimizer/bfgs_test.runfiles/tensorflow_probability/tensorflow_probability/__init__.py\", line 65, in _ensure_tf_install\r\n    present=tf.__version__))\r\nImportError: This version of TensorFlow Probability requires TensorFlow version >= 1.13; Detected an installation of version 1.10.1. Please upgrade TensorFlow to proceed.\r\n`", "The error refers to the tensorflow version -- do you have multiple versions installed somehow?\r\n\r\nThe warning from bazel can be ignored here.", "Ok, I just realized that bazel uses Python2 and that one needs to checkout branch r0.6 for Tensorflow Probability in order to run the tests.\r\n\r\nIt works now, thank you for your help @csuter."]}, {"number": 29130, "title": "Mixed precision LossScaleOptimizer doesn't work with Keras", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): PyPi\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.5.2\r\n\r\n**Describe the current behavior**\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/mixed_precision/python/loss_scale_optimizer.py#L102\r\n\r\ntf.contrib.mixed_precision.loss_scale_optimizer.LossScaleOptimizer doesn't implement variables() method (because it doesn't call base class `__init__` nor override it), so it fails when used within Keras model training with the following stack trace on model.fit_generator call:\r\n\r\n```\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/engine/training.py\", line 1426, in fit_generator\r\n    initial_epoch=initial_epoch)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/engine/training_generator.py\", line 164, in model_iteration\r\n    callbacks._call_begin_hook(mode)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/callbacks.py\", line 212, in _call_begin_hook\r\n    self.on_train_begin()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/callbacks.py\", line 279, in on_train_begin\r\n    callback.on_train_begin(logs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/horovod-0.16.0-py3.5-linux-x86_64.egg/horovod/_keras/callbacks.py\", line 30, in on_train_begin\r\n    self.backend.get_session().run(bcast_op)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 482, in get_session\r\n    _initialize_variables(session)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 749, in _initialize_variables\r\n    variables = _get_variables(get_graph())\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 743, in _get_variables\r\n    variables.update(opt.optimizer.variables())\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/optimizer.py\", line 946, in variables\r\n    optimizer_variables = [v for v in self._non_slot_variables()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/optimizer.py\", line 1025, in _non_slot_variables\r\n    return self._non_slot_dict.values()\r\nAttributeError: 'LossScaleOptimizer' object has no attribute '_non_slot_dict'\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nWrapping the optimizer in a LossScaleOptimizer should work transparently with Keras models, as it implements tf.optimizers.Optimizer base class.\r\n\r\nTo solve this problem, there's a need to either pass undelying optimizer variables() method (together with passing LossScaleManager variables too) or fill slot- and non-slot variables some other way.\r\n\r\nWorkaround example:\r\n```\r\nclass MyExponentialUpdateLossScaleManager(ExponentialUpdateLossScaleManager):\r\n    def variables(self):\r\n        return [self._loss_scale, self._num_good_steps, self._num_bad_steps]\r\n\r\nclass MyLossScaleOptimizer(LossScaleOptimizer):\r\n    def variables(self):\r\n        return self._opt.variables() + self._loss_scale_manager.variables()\r\n```\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nfrom tensorflow.train import AdamOptimizer \r\nfrom tensorflow.contrib.mixed_precision import LossScaleOptimizer, ExponentialUpdateLossScaleManager\r\n...\r\noptimizer = AdamOptimizer()\r\nloss_scale_manager = ExponentialUpdateLossScaleManager(init_loss_scale=2 ** 32, incr_every_n_steps=1000)\r\noptimizer = LossScaleOptimizer(optimizer, loss_scale_manager)\r\n...\r\nmodel.compile(optimizer=optimizer, ...)\r\n```\r\n\r\nFull example\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.train import AdamOptimizer\r\nfrom tensorflow.contrib.mixed_precision import LossScaleOptimizer, ExponentialUpdateLossScaleManager\r\n\r\ninput = tf.keras.layers.Input(shape=(16,))\r\noutput = tf.keras.layers.Dense(1)(input)\r\nmodel = tf.keras.models.Model(input, output)\r\n\r\noptimizer = AdamOptimizer()\r\n# Works without these two lines below\r\nloss_scale_manager = ExponentialUpdateLossScaleManager(init_loss_scale=2 ** 32, incr_every_n_steps=1000)\r\noptimizer = LossScaleOptimizer(optimizer, loss_scale_manager)\r\n\r\nmodel.compile(optimizer=optimizer, loss='binary_crossentropy')\r\nmodel.fit(np.zeros((16, 16)), np.zeros((16,)))\r\n```", "comments": ["Thanks for the detailed explanation. Will it be possible to provide a minimal exact full code snippet that can reproduce the issue. It would be easy for us to proceed faster. Thanks!", "Updated the description above with the full code example, thanks!", "Thanks for sharing the information. I have tried on Colab with TensorFlow version 1.13.1 and was able to reproduce the issue.", "@reedwm -- can you advise on the best combination of APIs to use here?", "The contrib LossScaleOptimizer is deprecated. Try using `tf.train.experimental.MixedPrecisionLossScaleOptimizer` instead.", "> The contrib LossScaleOptimizer is deprecated. Try using `tf.train.experimental.MixedPrecisionLossScaleOptimizer` instead.\r\n\r\nThe version of this API is tensorflow 1.14, how about tensorflow 1.13.1 ?", "Unfortunately, no LossScaleOptimizer can be used in tf.keras with 1.13.1.", "Closing this as contrib has been removed in TF 2.", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29130\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/29130\">No</a>\n"]}, {"number": 29129, "title": "keras lstm cell has no zero state when wrapped with a dropoutwrapper", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Microsoft Windows 10\r\n- TensorFlow installed from (source or binary): Anaconda\r\n- TensorFlow version (use command below): tensorflow 1.13.1  gpu_py37h83e5d6a_0\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: 7.3.1\r\n- GPU model and memory: GTX 1060 6gb\r\n\r\nThis problem is very similar to #25641. But that issue was closed and the problem was found in a future version of tensorflow (2.0.0. alpha). This is why I opened a new issue, becuase the current stable release version has the same error. \r\n\r\nI want to create a RNN layer with stacked lstm cells. The lstm cells are wrapped with the dropoutwrapper. Since I define no initial state, the RNN tries to get the zero state from the lstm cells. There the error occurs, saying that a lstmcell has no attribute zero_state. \r\n        \r\n        import tensorflow as tf\r\n        with tf.Session() as sess:\r\n        tensor = tf.zeros(shape=(1, 20, 5), dtype=tf.float32)\r\n        inputs = tf.keras.layers.Input(shape=(10, 5), tensor=tensor)\r\n        cell = tf.keras.layers.LSTMCell(10)\r\n        cell = tf.nn.rnn_cell.DropoutWrapper(cell=cell)\r\n        rnn = tf.keras.layers.RNN(cell=cell)(inputs)\r\n\r\nHere is the error message:\r\n\r\n          File \"C:/Users/vaith/PycharmProjects/Bayesian_Neural_Nets/bayesian_lstm_main.py\", line 25, in main\r\n           rnn = tf.keras.layers.RNN(cell=cell)(inputs)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\keras\\layers \\recurrent.py\", line 701, in __call__\r\n           return super(RNN, self).__call__(inputs, **kwargs)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py\", line 554, in __call__\r\n           outputs = self.call(inputs, *args, **kwargs)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\recurrent.py\", line 759, in call\r\n            inputs, initial_state, constants)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\recurrent.py\", line 863, in _process_inputs\r\n            initial_state = self.get_initial_state(inputs)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\recurrent.py\", line 679, in get_initial_state\r\n            inputs=None, batch_size=batch_size, dtype=dtype)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\rnn_cell_impl.py\", line 298, in get_initial_state\r\n            return self.zero_state(batch_size, dtype)\r\n           File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\rnn_cell_impl.py\", line 1232, in zero_state\r\n            return self._cell.zero_state(batch_size, dtype)\r\n           AttributeError: 'LSTMCell' object has no attribute 'zero_state'\r\n", "comments": ["@alexv1247 Able to reproduce the issue on TF 1.13 GPU and TF nightly", "The Keras cells have a dropout argument that you should use directly, rather than passing through the DropoutWrapper. See, for example, https://github.com/tensorflow/tensorflow/blob/r1.13/tensorflow/python/keras/layers/recurrent.py#L1022 . + @qlzh727 for more guidance.", "The keras RNN cell has default dropout support, which mean user probably should just directly using that. Please see API doc param \"dropout\" and \"recurrent_dropout\" for any of the RNN layer and cells. \r\n\r\nDropoutWrapper is used mostly for legacy TF rnn cell, and some custom cells in tf.contrib.", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29129\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29129\">No</a>\n", "so will the dropout wrapper work with the cudnnlstm cell from tf contrib?\n\n<sub>Sent with <a href=\"http://githawk.com\">GitHawk</a></sub>", "In TF 2.0, we merge the cudnn implementation into the normal LSTM/GRU keras layer, so you don't have to use the contrib version anymore."]}, {"number": 29128, "title": "when i use conv1d", "body": "conda activate base\r\n2.0.0-alpha0\r\n2019-05-29 19:58:31.543654: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-05-29 19:58:31.557759: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1\r\n2019-05-29 19:58:31.670769: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1009] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-05-29 19:58:31.672348: I tensorflow/compiler/xla/service/service.cc:162] XLA service 0x55c9b57a0a60 executing computations on platform CUDA. Devices:\r\n2019-05-29 19:58:31.672364: I tensorflow/compiler/xla/service/service.cc:169]   StreamExecutor device (0): Graphics Device, Compute Capability 7.5\r\n2019-05-29 19:58:31.693201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2904000000 Hz\r\n2019-05-29 19:58:31.693619: I tensorflow/compiler/xla/service/service.cc:162] XLA service 0x55c9b580db30 executing computations on platform Host. Devices:\r\n2019-05-29 19:58:31.693637: I tensorflow/compiler/xla/service/service.cc:169]   StreamExecutor device (0): <undefined>, <undefined>\r\n2019-05-29 19:58:31.693791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1467] Found device 0 with properties: \r\nname: Graphics Device major: 7 minor: 5 memoryClockRate(GHz): 1.71\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 5.76GiB freeMemory: 5.17GiB\r\n2019-05-29 19:58:31.693804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1546] Adding visible gpu devices: 0\r\n2019-05-29 19:58:31.693844: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0\r\n2019-05-29 19:58:31.694402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1015] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-05-29 19:58:31.694413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021]      0 \r\n2019-05-29 19:58:31.694419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1034] 0:   N \r\n2019-05-29 19:58:31.694516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1149] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4990 MB memory) -> physical GPU (device: 0, name: Graphics Device, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\nNumber of training examples: 60000\r\nNumber of test examples:     10000\r\nEpoch 1/5\r\n2019-05-29 19:58:32.786674: W ./tensorflow/core/framework/model.h:202] Encountered a stop event that was not preceded by a start event.\r\n2019-05-29 19:58:36.114172: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\n2019-05-29 19:58:36.288348: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-05-29 19:58:36.934479: E tensorflow/stream_executor/cuda/cuda_dnn.cc:338] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2019-05-29 19:58:36.945020: E tensorflow/stream_executor/cuda/cuda_dnn.cc:338] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2019-05-29 19:58:36.945127: W tensorflow/core/common_runtime/base_collective_executor.cc:214] BaseCollectiveExecutor::StartAbort Unknown: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[{{node conv2d/Conv2D}}]]", "comments": ["@proszx Please provide details about what platform you are using (operating system, architecture). Also include your TensorFlow version. Also, did you compile from source or install a binary?\r\n\r\nMake sure you also include the exact command if possible to produce the output included in your test case. If you are unclear what to include see the issue template displayed in [the Github new issue template](https://github.com/tensorflow/tensorflow/issues/new/choose).\r\n\r\nWe ask for this in the issue submission template, because it is really difficult to help without that information. Thanks!\r\n", "@proszx This is duplicate of [#29155](https://github.com/tensorflow/tensorflow/issues/29155). Can we close this. Will track resolution there. Thanks!"]}, {"number": 29127, "title": "mirror.tensorflow.org has an invalid https cert", "body": "third_party distfiles that are downloaded from the starlark functions `tf_http_archive` or `third_party_http_archive` currently are mirrored to mirror.tensorflow.org via http. Changing them to https fails with an invalid cert (it currently points to *.storage.googleapis.com) \r\n\r\nFor example from `tensorflow/workspace.bzl`:\r\nhttps://mirror.tensorflow.org/docs.python.org/2.7/_sources/license.rst.txt\r\n\r\nThe third party archives should be served over https for everyones security, `https://mirror.bazel.build/` used to be over https, so `mirror.tensorflow.org` should too.", "comments": ["This should be elevated to a webmaster's attn.", "Filed an internal ticket to track: b/135291877", "mirror.tensorflow.org does not really have https set up.\r\nthats why I converted all the mirror.tensorflow.org links to http.\r\n\r\nIn workspace.bzl case the security is provided by the sha checks we have, so not having ssl does not cause big security issues.", "@frankchn @mihaimaruseac is this resolved?", "Yeah the relevant URLs are updated to https://storage.googleapis.com/mirror.tensorflow.org, which has a correct TLS certificate."]}, {"number": 29126, "title": "Add int 8 and 16 support for TensorArray on GPU.", "body": "This PR adds GPU support for int8, int16 and int32 for TensorArray split, referenced in this Issue https://github.com/tensorflow/tensorflow/issues/28458", "comments": ["Bump :)", "Can one of the admins verify this patch?", "Please fix this error:\r\n\r\n```\r\nInvalidArgumentError: Cannot assign a device for operation TensorArrayScatter/TensorListScatterIntoExistingList: Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nColocation Debug Info:\r\nColocation group had the following types and supported devices: \r\nRoot Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='' supported_device_types_=[CPU] possible_devices_=[]\r\nTensorListScatterIntoExistingList: CPU \r\n\r\nColocation members, user-requested devices, and framework assigned devices, if any:\r\n  TensorArrayScatter/TensorListScatterIntoExistingList (TensorListScatterIntoExistingList) /device:GPU:0\r\n\r\nOp: TensorListScatterIntoExistingList\r\nNode attrs: element_dtype=DT_INT16\r\nRegistered kernels:\r\n  device='CPU'; element_dtype in [DT_INT64]\r\n  device='CPU'; element_dtype in [DT_INT32]\r\n  device='CPU'; element_dtype in [DT_UINT16]\r\n  device='CPU'; element_dtype in [DT_INT16]\r\n  device='CPU'; element_dtype in [DT_UINT8]\r\n  device='CPU'; element_dtype in [DT_INT8]\r\n  device='CPU'; element_dtype in [DT_HALF]\r\n  device='CPU'; element_dtype in [DT_BFLOAT16]\r\n  device='CPU'; element_dtype in [DT_FLOAT]\r\n  device='CPU'; element_dtype in [DT_DOUBLE]\r\n  device='CPU'; element_dtype in [DT_COMPLEX64]\r\n  device='CPU'; element_dtype in [DT_COMPLEX128]\r\n  device='CPU'; element_dtype in [DT_BOOL]\r\n  device='CPU'; element_dtype in [DT_STRING]\r\n  device='CPU'; element_dtype in [DT_QUINT8]\r\n  device='CPU'; element_dtype in [DT_QINT8]\r\n  device='CPU'; element_dtype in [DT_QUINT16]\r\n  device='CPU'; element_dtype in [DT_QINT16]\r\n  device='CPU'; element_dtype in [DT_QINT32]\r\n  device='CPU'; element_dtype in [DT_VARIANT]\r\n  device='GPU'; element_dtype in [DT_HALF]\r\n  device='GPU'; element_dtype in [DT_FLOAT]\r\n  device='GPU'; element_dtype in [DT_DOUBLE]\r\n  device='GPU'; element_dtype in [DT_BFLOAT16]\r\n  device='GPU'; element_dtype in [DT_COMPLEX64]\r\n  device='GPU'; element_dtype in [DT_COMPLEX128]\r\n  device='GPU'; element_dtype in [DT_INT32]\r\n  device='GPU'; element_dtype in [DT_INT64]\r\n  device='GPU'; element_dtype in [DT_BOOL]\r\n\r\n\t [[node TensorArrayScatter/TensorListScatterIntoExistingList]]\r\n```", "I currently have some problem while building Tensorflow related to nccl, will solve as soon as I succeed in building ", "It has been 14 days with no activity and the `awaiting response` label was assigned. Is this PR still valid? Assigning the `stalled` label. Please comment to reassure me that this is still being worked on.", "@vcarpani  Wondering if you still need this PR, if yes can you please check reviewer comments and keep us posted. Thanks!", "I'm going to go ahead and close this PR, because it seems to have stalled. If you're still interested in pursing this (and responding to my comments), please feel free to reopen!"]}, {"number": 29125, "title": "docs: fix minor typo", "body": "The opening parenthesis is not closed anywhere in the paragraph.", "comments": ["Closing this PR as this not against `master`, please open a new PR against `master` \r\nCC @mihaimaruseac"]}, {"number": 29124, "title": "Cannot convert VGG19", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 18.04\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (or github SHA if from source): tf-nightly-2.0-preview 2.0.0.dev20190529\r\n\r\n**Provide the text output from tflite_convert**\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: CONV_2D, FULLY_CONNECTED, MAX_POOL_2D, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\n```\r\n\r\n```\r\nModel: \"model_1\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_2 (InputLayer)         [(None, 256, 256, 3)]     0         \r\n_________________________________________________________________\r\nblock1_conv1 (Conv2D)        (None, 256, 256, 64)      1792      \r\n_________________________________________________________________\r\nblock1_conv2 (Conv2D)        (None, 256, 256, 64)      36928     \r\n_________________________________________________________________\r\nblock1_pool (MaxPooling2D)   (None, 128, 128, 64)      0         \r\n_________________________________________________________________\r\nblock2_conv1 (Conv2D)        (None, 128, 128, 128)     73856     \r\n_________________________________________________________________\r\nblock2_conv2 (Conv2D)        (None, 128, 128, 128)     147584    \r\n_________________________________________________________________\r\nblock2_pool (MaxPooling2D)   (None, 64, 64, 128)       0         \r\n_________________________________________________________________\r\nblock3_conv1 (Conv2D)        (None, 64, 64, 256)       295168    \r\n_________________________________________________________________\r\nblock3_conv2 (Conv2D)        (None, 64, 64, 256)       590080    \r\n_________________________________________________________________\r\nblock3_conv3 (Conv2D)        (None, 64, 64, 256)       590080    \r\n_________________________________________________________________\r\nblock3_conv4 (Conv2D)        (None, 64, 64, 256)       590080    \r\n_________________________________________________________________\r\nblock3_pool (MaxPooling2D)   (None, 32, 32, 256)       0         \r\n_________________________________________________________________\r\nblock4_conv1 (Conv2D)        (None, 32, 32, 512)       1180160   \r\n_________________________________________________________________\r\nblock4_conv2 (Conv2D)        (None, 32, 32, 512)       2359808   \r\n_________________________________________________________________\r\nblock4_conv3 (Conv2D)        (None, 32, 32, 512)       2359808   \r\n_________________________________________________________________\r\nblock4_conv4 (Conv2D)        (None, 32, 32, 512)       2359808   \r\n_________________________________________________________________\r\nblock4_pool (MaxPooling2D)   (None, 16, 16, 512)       0         \r\n_________________________________________________________________\r\nblock5_conv1 (Conv2D)        (None, 16, 16, 512)       2359808   \r\n_________________________________________________________________\r\nblock5_conv2 (Conv2D)        (None, 16, 16, 512)       2359808   \r\n_________________________________________________________________\r\nblock5_conv3 (Conv2D)        (None, 16, 16, 512)       2359808   \r\n_________________________________________________________________\r\nblock5_conv4 (Conv2D)        (None, 16, 16, 512)       2359808   \r\n_________________________________________________________________\r\nblock5_pool (MaxPooling2D)   (None, 8, 8, 512)         0         \r\n_________________________________________________________________\r\nflatten_1 (Flatten)          (None, 32768)             0         \r\n_________________________________________________________________\r\ndense_3 (Dense)              (None, 2048)              67110912  \r\n_________________________________________________________________\r\ndropout_2 (Dropout)          (None, 2048)              0         \r\n_________________________________________________________________\r\ndense_4 (Dense)              (None, 1024)              2098176   \r\n_________________________________________________________________\r\ndropout_3 (Dropout)          (None, 1024)              0         \r\n_________________________________________________________________\r\ndense_5 (Dense)              (None, 2)                 2050      \r\n=================================================================\r\nTotal params: 89,235,522\r\nTrainable params: 69,211,138\r\nNon-trainable params: 20,024,384\r\n_________________________________________________________________\r\n```\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n```\r\n\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n<ipython-input-3-7f2e78be88e7> in <module>\r\n      1 converter = tf.compat.v1.lite.TFLiteConverter.from_saved_model(os.path.join('fold_0', 'saved_model'))\r\n      2 converter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\n----> 3 tflite_quant_model = converter.convert()\r\n      4 open(\"converted_model.tflite\", \"wb\").write(tflite_quant_model)\r\n\r\n~/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/lite/python/lite.py in convert(self)\r\n    898           input_tensors=self._input_tensors,\r\n    899           output_tensors=self._output_tensors,\r\n--> 900           **converter_kwargs)\r\n    901     else:\r\n    902       result = _toco_convert_graph_def(\r\n\r\n~/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/lite/python/convert.py in toco_convert_impl(input_data, input_tensors, output_tensors, *args, **kwargs)\r\n    402   data = toco_convert_protos(model_flags.SerializeToString(),\r\n    403                              toco_flags.SerializeToString(),\r\n--> 404                              input_data.SerializeToString())\r\n    405   return data\r\n    406 \r\n\r\n~/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str)\r\n    170       stderr = _try_convert_to_unicode(stderr)\r\n    171       raise ConverterError(\r\n--> 172           \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    173   finally:\r\n    174     # Must manually cleanup files.\r\n\r\nConverterError: TOCO failed. See console for info.\r\n2019-05-29 05:12:55.314629: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: IdentityN\r\n2019-05-29 05:12:55.329766: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 205 operators, 248 arrays (0 quantized)\r\n2019-05-29 05:12:55.331674: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 205 operators, 248 arrays (0 quantized)\r\n2019-05-29 05:12:55.406663: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 28 operators, 68 arrays (0 quantized)\r\n2019-05-29 05:12:56.019719: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 27 operators, 67 arrays (0 quantized)\r\n2019-05-29 05:12:56.019942: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 26 operators, 65 arrays (0 quantized)\r\n2019-05-29 05:12:56.020127: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 26 operators, 65 arrays (0 quantized)\r\n2019-05-29 05:12:56.020257: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 26 operators, 65 arrays (0 quantized)\r\n2019-05-29 05:12:56.020521: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 33554432 bytes, theoretical optimal value: 33554432 bytes.\r\n2019-05-29 05:12:56.020581: I tensorflow/lite/toco/toco_tooling.cc:434] Estimated count of arithmetic ops: 51.1266 billion (note that a multiply-add is counted as 2 ops).\r\n2019-05-29 05:12:56.020770: E tensorflow/lite/toco/toco_tooling.cc:462] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: CONV_2D, FULLY_CONNECTED, MAX_POOL_2D, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\nTraceback (most recent call last):\r\n  File \"/home/marco/anaconda3/envs/tf2/bin/toco_from_protos\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/home/marco/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/marco/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/marco/anaconda3/envs/tf2/lib/python3.6/site-packages/absl/app.py\", line 300, in run\r\n    _run_main(main, args)\r\n  File \"/home/marco/anaconda3/envs/tf2/lib/python3.6/site-packages/absl/app.py\", line 251, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/marco/anaconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33, in execute\r\n    output_str = tensorflow_wrap_toco.TocoConvert(model_str, toco_str, input_str)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n```", "comments": ["You might consider converting the op `IdentityN` with [Tensorflow light operation select](https://www.tensorflow.org/lite/guide/ops_select)\r\nYou can specify operations, that can't be used in `tf.lite` directly like this:\r\n\r\n`import tensorflow as tf`\r\n\r\n`converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir)`\r\n`converter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS, tf.lite.OpsSet.SELECT_TF_OPS]`\r\n`tflite_model = converter.convert()`\r\n`open(\"converted_model.tflite\", \"wb\").write(tflite_model)` [link](https://www.tensorflow.org/lite/guide/ops_select)\r\n\r\nHope this helps.", "@marcojulioarg : Please have a look on @lufol's suggestion and let us know if you are able to proceed further. Thanks!", "Hello, I was able to save the model now. I made to testing on loading it or making an inference, but it converted. Ill try the model next, thank you very much!", "Sure. Let us know if you are stuck. Thanks!", "Closing the issue since it looks to be resolved. Please feel free to open another ticket if you are stuck. Thanks!", "You can try this:\r\nconverter.allow_custom_ops=True\r\n\r\nFor me, it works.", "The original reported issue should be resolved by commit aca24307eba. \r\nCould you try it again with the next TF nightly build? Thanks!", "> You can try this:\r\n> converter.allow_custom_ops=True\r\n> \r\n> For me, it works.\r\n\r\nBy setting allow_custom_ops flag True, it can generate the *.tflite. But, have you tried this *.tflite on android app to see if it works? Or it only shifts the issue one step ahead?", "@hadizand You are correct it just shifts the issue one step ahead."]}, {"number": 29123, "title": "tf.data.Dataset.from_generator() empties after use even with repeat()", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Arch Linux\r\n- TensorFlow installed from (source or binary): PyPI binary\r\n- TensorFlow version (use command below): 2.0.0-dev20190526\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\n\r\nA `tf.data.Dataset` created using `from_generator()` is consumed and not recreated/repeated even when explicitly invoking the `repeat()` method.\r\n\r\n**Describe the expected behavior**\r\n\r\nIf `repeat()` is being invoked, repeat the dataset.\r\n\r\n**Code to reproduce the issue**\r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/25254#issuecomment-496828699\r\n\r\n**Other info / logs**\r\n\r\nThe issue is present both when manually iterating over it in a custom training scenario and when using `tf.keras.Model.fit()`.\r\n", "comments": ["Actually, it was my fault :man_facepalming: I had a generator emptying and not being recreated way way upstream in my pipeline. Sorry :heart: ", "I encountered the same issue. \r\nI had a python generator: gen\r\n`tf.data.Dataset.from_generator(lambda: gen,  ....) `\r\nIt does not support repeat. But if I define a lambda generator outside of tf.data.from_generator(gen_lambda, ...) as follows\r\n```\r\ngen_lambda = lambda: gen\r\ntf.data.Dataset.from_generator(gen_lambda,  ....) solved the issue. \r\n```\r\nIt supports repeat method. \r\n\r\n\r\n"]}, {"number": 29122, "title": "Entity <> could not be transformed and will be staged without change", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 2.0 alpha\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: 10\r\n- GPU model and memory: GTX2080Ti\r\n\r\nHi there, could you please have a look at the issue? A customized network module (in Keras) cannot work as for gradient backpropagation. \r\n\r\n\r\nLog:\r\n\r\nW0529 19:29:46.658907 140071302989632 tf_logging.py:161] Entity <bound method Layer.__call__ of <tensorflow.python.keras.engine.training.Model object at 0x7f6404415fd0>> could not be transformed and will be staged without change. Error details can be found in the logs when running with the env variable AUTOGRAPH_VERBOSITY >= 1. Please report this to the AutoGraph team. Cause: Unexpected error transforming <bound method Layer.__call__ of <tensorflow.python.keras.engine.training.Model object at 0x7f6404415fd0>>. If you believe this is due to a bug, please set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output when filing the bug report. Caused by: node <gast.gast.Subscript object at 0x7f61f416e4e0> has ctx unset\r\nW0529 19:29:52.344057 140071302989632 tf_logging.py:161] Entity <function train_G at 0x7f64c79a9ae8> could not be transformed and will be staged without change. Error details can be found in the logs when running with the env variable AUTOGRAPH_VERBOSITY >= 1. Please report this to the AutoGraph team. Cause: Unexpected error transforming <function train_G at 0x7f64c79a9ae8>. If you believe this is due to a bug, please set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output when filing the bug report. Caused by: node <gast.gast.Name object at 0x7f61ad7cb588> has ctx unset\r\nW0529 19:29:52.960978 140071302989632 optimizer_v2.py:928] Gradients does not exist for variables ['conv2d_24/kernel:0', 'conv2d_24/bias:0', 'conv2d_25/kernel:0', 'conv2d_25/bias:0', 'conv2d_26/kernel:0', 'conv2d_26/bias:0', 'conv2d_27/kernel:0', 'conv2d_27/bias:0', 'conv2d_28/kernel:0', 'conv2d_28/bias:0', 'conv2d_29/kernel:0', 'conv2d_29/bias:0', 'conv2d_30/kernel:0', 'conv2d_30/bias:0', 'conv2d_31/kernel:0', 'conv2d_31/bias:0', 'conv2d_32/kernel:0', 'conv2d_32/bias:0', 'conv2d_33/kernel:0', 'conv2d_33/bias:0', 'conv2d_34/kernel:0', 'conv2d_34/bias:0', 'conv2d_35/kernel:0', 'conv2d_35/bias:0', 'conv2d_36/kernel:0', 'conv2d_36/bias:0', 'conv2d_37/kernel:0', 'conv2d_37/bias:0', 'conv2d_38/kernel:0', 'conv2d_38/bias:0', 'conv2d_39/kernel:0', 'conv2d_39/bias:0'] when minimizing the loss.\r\nx", "comments": ["@weiminson In order to expedite the trouble-shooting process, please provide a code snippet to reproduce the issue reported here. Also Could you provide more details about the issue and context?. Thanks!\r\n", "> @weiminson In order to expedite the trouble-shooting process, please provide a code snippet to reproduce the issue reported here. Also Could you provide more details about the issue and context?. Thanks!\r\n\r\n@gadagashwini thanks for your reply.\r\nI was trying to implement a network with the following structure: \r\n![convGenerator](https://user-images.githubusercontent.com/41808551/58610418-bf034280-82ee-11e9-9a69-a90a45d4c248.png)\r\neach of its decoder branches are connected to a decoder like this:\r\n![convDiscriminator1](https://user-images.githubusercontent.com/41808551/58610718-d7c02800-82ef-11e9-8524-ad94246eddf5.png)\r\n\r\n\r\nHowever, when I try to update its gradient in a function called train_G using: \r\nwith tf.GradientTape(persistent=True) as t:\r\n[TAB]        ground_truth = get_Mask(x_real)\r\n[TAB]        x1_fake, x2_fake = G(ground_truth, training=True)\r\n[TAB]        x1_fake_d_logit = D1(x1_fake, training=True)\r\n[TAB]        x2_fake_d_logit = D2(x2_fake, training=True)\r\n[TAB]        G1_loss = g_loss_fn(x1_fake_d_logit)\r\n[TAB]        G2_loss = g_loss_fn(x2_fake_d_logit)\r\nG2_grad = t.gradient(G2_loss, G.trainable_variables)\r\nG_optimizer.apply_gradients(zip(G2_grad, G.trainable_variables))\r\n\r\nthe warning described above occurs, saying that no gradient will be obtained from the branches.\r\nis there anything wrong with my code?\r\n", "@weiminson I tried to reproduce the issue but it looks code snippet is incomplete. Please provide complete code to. Thanks!", "> @weiminson I tried to reproduce the issue but it looks code snippet is incomplete. Please provide complete code to. Thanks!\r\n @gadagashwini Thanks for your reply, to reproduce the issue, I've uploaded the entire coding to \r\nhttps://github.com/weiminson/debug-SplitU\r\nPlz run tain.py to test. for the running environment, plz refer to README.\r\n", "@jvishnuvardhan Could you please help to try this case? I've been stuck on this issue for more than one week... Appreciate your reply.", "@mdanatg: Is this autograph related? There is an \"Unexpected error transforming\" in the logs", "Yes, the warning is definitely related to autograph and indicates a bug, judging from the error message.\r\nThat said, I believe the gradient error is unrelated - the warning simply states that autograph will leave that code unchanged, and it's unlikely to cause that error.\r\n\r\nSo I think we're dealing with two separate issues here - it would be great if you had a code snippet (or a simplified model of it) that can reproduce the error.", "@mdanatg: I believe the code has been uploaded to https://github.com/weiminson/debug-SplitU", "The warning from optimizer is as expected.\r\n\r\n@weiminson your code seems to be:\r\nG2_grad = t.gradient(G2_loss, G.trainable_variables)\r\nG_optimizer.apply_gradients(zip(G2_grad, G.trainable_variables))\r\n\r\nG_optimizer is getting \"all trainable variables\" with G.trainable_variables, while you are providing gradients only for the ones on the G2 branch, hence it is warning you that it doesn't see any gradients for the variables in the G1 branch. The warning is to make sure you aren't doing this by mistake.\r\n\r\n@mdanatg the autograph warning seems unrelated, but may be worth checking if it needs to be there.", "> The warning from optimizer is as expected.\r\n> \r\n> @weiminson your code seems to be:\r\n> G2_grad = t.gradient(G2_loss, G.trainable_variables)\r\n> G_optimizer.apply_gradients(zip(G2_grad, G.trainable_variables))\r\n> \r\n> G_optimizer is getting \"all trainable variables\" with G.trainable_variables, while you are providing gradients only for the ones on the G2 branch, hence it is warning you that it doesn't see any gradients for the variables in the G1 branch. The warning is to make sure you aren't doing this by mistake.\r\n> \r\n> @mdanatg the autograph warning seems unrelated, but may be worth checking if it needs to be there.\r\n\r\n@rajatmonga , Thanks for your reply. Actually, I did try out a training mode where one of the branches was disabled and the other was left enabled (mode 2). Consequently, it was still showing the same error. Besides, I checked the name of the layers from that Error messages, finding that these layers are names of layers of BOTH branches, which implied that neither of the branches actually worked. \r\n\r\nCorrect me if I m wrong. BTW, do you know what this error message means? Why train G could not be transformed? I believe this is the root cause of the issue.\r\n\r\nW0529 19:29:52.344057 140071302989632 tf_logging.py:161] Entity <function train_G at 0x7f64c79a9ae8> could not be transformed and will be staged without change.", "@weiminson I tried to run the code you uploaded to the github repo, but it fails with this error:\r\n\r\n```\r\npython3 train.py\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 82, in <module>\r\n    dataset, shape, len_dataset = data.make_PETCT_dataset(img_paths, args.batch_size, args.input_size)\r\n  File \"/home/mdan/debug-SplitU/data.py\", line 95, in make_PETCT_dataset\r\n    repeat=repeat)\r\n  File \"/home/mdan/debug-SplitU/tf2lib/data/dataset.py\", line 127, in disk_image_batch_dataset\r\n    repeat=repeat)\r\n  File \"/home/mdan/debug-SplitU/tf2lib/data/dataset.py\", line 77, in memory_data_batch_dataset\r\n    repeat=repeat)\r\n  File \"/home/mdan/debug-SplitU/tf2lib/data/dataset.py\", line 32, in batch_dataset\r\n    dataset = dataset.map(map_fn, num_parallel_calls=n_map_threads)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/dataset_ops.py\", line 1146, in map\r\n    self, map_func, num_parallel_calls, preserve_cardinality=True)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/dataset_ops.py\", line 3264, in __init__\r\n    use_legacy_function=use_legacy_function)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/dataset_ops.py\", line 2591, in __init__\r\n    self._function = wrapper_fn._get_concrete_function_internal()\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/eager/function.py\", line 1366, in _get_concrete_function_internal\r\n    *args, **kwargs)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/eager/function.py\", line 1360, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/eager/function.py\", line 1648, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/eager/function.py\", line 1541, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/framework/func_graph.py\", line 716, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/dataset_ops.py\", line 2585, in wrapper_fn\r\n    ret = _wrapper_helper(*args)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/dataset_ops.py\", line 2530, in _wrapper_helper\r\n    ret = func(*nested_args)\r\n  File \"/home/mdan/debug-SplitU/tf2lib/data/dataset.py\", line 113, in map_fn_\r\n    return map_fn(*parse_fn(*args))\r\n  File \"/home/mdan/debug-SplitU/tf2lib/data/dataset.py\", line 107, in parse_fn\r\n    img = tf.io.read_file(path)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 626, in read_file\r\n    \"ReadFile\", filename=filename, name=name)\r\n  File \"/home/mdan/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 550, in _apply_op_helper\r\n    (prefix, dtypes.as_dtype(input_arg.type).name))\r\nTypeError: Input 'filename' of 'ReadFile' Op has type float32 that does not match expected type of string.\r\n```\r\n\r\nIt seems to require the PET & CT dataset, but it's unclear how to install that.\r\n\r\nAt any rate, the two warnings are very unlikely to be related. To verify that, please change line 156 as follows:\r\n\r\n```\r\n@tf.function(autograph=False)\r\ndef train_G(x_real):\r\n```\r\n", "@weiminson \r\nI had a closer look at `train_G`, and I believe the bug that caused the *autograph* warning is already fixed in the beta1 release:\r\n\r\n`pip3 install -U tensorflow==2.0.0-beta1`\r\n\r\nI think that will require upgrading tensorflow-addons, too:\r\n\r\n`pip3 install -U tensorflow-addons`\r\n\r\nCould you try running your code under these versions and check if any of the warnings remain?", "+1 with what @rajatmonga said. The warning from optimizer only suggests branch 2 is not included in the backprop path, and seems to be legit in your use case. If you want to avoid such warning, the simplest way is to change your code to use G.trainable_variables to tape.watched_variables so that it only updates branch 1.\r\n\r\nThe actual error seems to be coming from NodeTransformer:\r\n```python\r\nassert node.ctx is not None, 'node {} has ctx unset'.format(node)\r\n``` ", "Since we expect the warnings to clear in the beta or nightly builds, but we can't confirm from our side whether the warnings clear in the latest build, I will close this issue for now. Please re-open it if they still appear in the nightly build though. Thanks!", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29122\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29122\">No</a>\n", "> @weiminson\r\n> I had a closer look at `train_G`, and I believe the bug that caused the _autograph_ warning is already fixed in the beta1 release:\r\n> \r\n> `pip3 install -U tensorflow==2.0.0-beta1`\r\n> \r\n> I think that will require upgrading tensorflow-addons, too:\r\n> \r\n> `pip3 install -U tensorflow-addons`\r\n> \r\n> Could you try running your code under these versions and check if any of the warnings remain?\r\n\r\n@mdanatg : I had a similar issue. The warnings disappeared after using the beta1 release.\r\nThanks."]}, {"number": 29121, "title": "hash with a new seed when hash collision is found", "body": "", "comments": ["@yann-yy can you please check build failures? Thanks!", "I have checked the failure of Ubuntu Python2 CI. And I don't think my commit will cause errors like this. And I doubt whether these 3 failed cases of py3 are necessary in py2 CI?\r\n", "Ignore the py3 changes, they're going to be fixed soon", "So I'm suppose to wait the fix on master, and merge the changes into my branch then continue the PR?", "We'll take care of it, you won't have to do anything except if there are conflicts", "Thank you @mihaimaruseac "]}, {"number": 29120, "title": "Update example_proto_fast_parsing.cc to fix hash collision", "body": "hash with a new seed when hash collision is found", "comments": ["We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA ([login here](https://cla.developers.google.com/) to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n\n\u2139\ufe0f **Googlers: [Go here](https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fpull%2F29120) for more info**.\n\n<!-- need_author_cla -->", "Did you close it intentionally?"]}, {"number": 29119, "title": "[Lite] Added 8-bit Quantization Support- FloorDiv.", "body": "", "comments": ["@jdduke , i have resolved the merge conflict, kindly have a look.\r\n\r\nRegards\r\nAmit", "Can one of the admins verify this patch?", "@amitsrivastava78 Could you please resolve the conflicts? Thanks!", "It has been 15 days with no activity and the `awaiting response` label was assigned. Is this PR still valid? Assigning the `stalled` label. Please comment to reassure me that this is still being worked on.", "I'm going to go ahead and close this PR, because it seems to have stalled. If you're still interested in pursing this (and responding to my comments), please feel free to reopen!"]}, {"number": 29118, "title": "Update broken Dockerfile links on CONTRIBUTING.md", "body": "Fix #29105 to fix broken Dockerfile links in `CONTRIBUTING.md`", "comments": []}, {"number": 29117, "title": "Some of the operators in the model are not supported by the standard TensorFlow Lite runtime.", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (or github SHA if from source):\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, ADD_N, CAST, CONCATENATION, CONV_2D, FLOOR, FULLY_CONNECTED, GATHER_ND, LOGISTIC, MAXIMUM, MINIMUM, MUL, PACK, RESHAPE, RESIZE_NEAREST_NEIGHBOR, STRIDED_SLICE, SUB. Here is a list of operators for which you will need custom implementations: ROUND.\r\n\r\n\r\n```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n", "comments": ["For converting a model to `tf.lite`, please have a look at this similar problem #29124.", "@liuyulin19921213 Did you get chance to try the link suggest by @lufol. Please check and let us know how it progresses. Thanks!", "I tested it \u3010https://www.tensorflow.org/lite/guide/ops_select \u3011\uff0c but it didn't pass\u3002", "Some of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, ADD_N, CAST, CONCATENATION, CONV_2D, FLOOR, FULLY_CONNECTED, GATHER_ND, LOGISTIC, MAXIMUM, MINIMUM, MUL, PACK, RESHAPE, RESIZE_NEAREST_NEIGHBOR, STRIDED_SLICE, SUB. Here is a list of operators for which you will need custom implementations: ROUND.\r\n\r\n", "Only added --allow_custom_ops Can generate **.tflite.\r\n But it can't be loaded in Android studio demo\u3002", "Please consider opening a new issue if you have a problem with Android Studio and mark this as closed.\r\n\r\nRegards", "In fact, they are a problem, because adding --allow_custom_ops ignores the error and causes an error on andrdoistudio. So you can't add --allow_custom_ops , of course I tried --target_ops=TFLITE_BUILTINS, SELECT_TF_OPS This is not possible. The log information is above.", "Oh yes, you are right.\r\nThen please consider the example of transforming the `sin` to an tf.lite instance [here](https://www.tensorflow.org/lite/guide/ops_custom).\r\nIf that is not an option for you, maybe you can apply the function that is not compatible with `tf.lite` outside of your graph in order to avoid writing much extra code.", "ROUND is now a builtin op, which version of TensorFlow are you using? You should be able to convert/run with the latest nightly.", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29117\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29117\">No</a>\n", "Then please consider the example of transforming the sin to an tf.lite instance here. \r\nThe link here can't be opened.\r\nThe current version is 1.13.1. I think it should be consistent with the version of the algorithm engineer. Not used 2.0.0.\r\nThe version used in android-studio is 0.0.0-nightly(\" implementation 'org.tensorflow:tensorflow-lite:0.0.0-nightly'\")", "For me the link works. Here once again https://www.tensorflow.org/lite/guide/ops_custom\r\n", "I tried the 2.0. version, the same error, Round \u3002", "It seems that only try   https://www.tensorflow.org/lite/guide/ops_custom\u3002\r\nBut it feels very troublesome."]}, {"number": 29116, "title": "Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, ADD_N, CAST, CONCATENATION, CONV_2D, FLOOR, FULLY_CONNECTED, GATHER_ND, LOGISTIC, MAXIMUM, MINIMUM, MUL, PACK, RESHAPE, RESIZE_NEAREST_NEIGHBOR, STRIDED_SLICE, SUB. Here is a list of operators for which you will need custom implementations: ROUND.", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (or github SHA if from source):\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\n# Copy and paste here\r\n```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n", "comments": []}]