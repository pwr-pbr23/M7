[{"number": 50382, "title": "Fix race condition in TRTDeviceAllocator", "body": "This PR adds a mutex to prevent race condition while accessing to the `mem_map_` member variable.\r\n\r\nTagging @bixia1 for review and @DEKHTIARJonathan for visibility.", "comments": []}, {"number": 50380, "title": "where should I ask my question regarding understanding tensorflow and keras better?", "body": "Pytorch has a great support community, instead of sending people to stack overflow the have their discussion forum.\r\nDoes tensorflow has any place that new beginners can go and ask their questions? or you just send people to internet and stackoverflow and wish them luck?\r\nI notice that github is more for bugs and problems not issues regarding understanding, please let me know if I am missing something?", "comments": ["@seyeeet \r\nThank you for reporting this issue.Even Tensorflow also has a great support community [forum](https://discuss.tensorflow.org/).Now you can feel free to post your issues there.Thanks", "oh, I did not know that!! Thanks for pointing that out, @UsharaniPagadala "]}, {"number": 50379, "title": "Memory leak in model.fit", "body": "<em>Please make sure that this is a bug. As per our\r\n[GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md),\r\nwe only address code/doc bugs, performance issues, feature requests and\r\nbuild/installation issues on GitHub. tag:bug_template</em>\r\n\r\n\r\nThe following issue still remains to be prevailing regardless of TF versions for many people, and I ought to re-open this issue on memory leakage. \r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/37505\r\n\r\nCurrently, the only solution is a crack to wrap the sequence into multiprocessing. I hope this bug could be fixed as soon as possible. ", "comments": ["@krenerd ,\r\n\r\nIn order to expedite the trouble-shooting process, could you please provide the tensorflow version,complete code and dataset to reproduce the issue reported here.", "> **System information**\r\n> \r\n> * Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n>   minimal working example\r\n> * OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n>   windows-server 2016\r\n> * TensorFlow installed from (source or binary):\r\n>   conda\r\n> * TensorFlow version (use command below):\r\n>   tf 2.1.0\r\n> * Python version:\r\n>   3.7\r\n> * CUDA/cuDNN version:\r\n>   CUDA 10.1\r\n> * GPU model and memory:\r\n>   K80 - 24Gb\r\n> \r\n> **Describe the current behavior**\r\n> memory use increases with consecutive training runs, probably related to #35524, #33030, #35124, #35835\r\n> side note: I do not understand the warning but this seems to be handled in #37500\r\n> **Describe the expected behavior**\r\n> memory should stay constant\r\n> \r\n> **Standalone code to reproduce the issue**\r\n> Provide a reproducible test case that is the bare minimum necessary to generate\r\n> the problem. If possible, please share a link to Colab/Jupyter/any notebook.\r\n> \r\n> ```\r\n> from tensorflow.keras.datasets import cifar10\r\n> import tensorflow.keras.callbacks as callbacks\r\n> from tensorflow.keras.preprocessing.image import ImageDataGenerator\r\n> from tensorflow.keras.callbacks import LearningRateScheduler\r\n> from tensorflow.keras.optimizers import SGD\r\n> from tensorflow.keras.layers import Input, Conv2D, GlobalAveragePooling2D, Activation, Dense\r\n> from tensorflow.keras.models import Model\r\n> import tensorflow.keras.utils as kutils\r\n> import numpy as np\r\n> import psutil\r\n> import gc \r\n> \r\n> \r\n> batch_size = 128\r\n> epochs = 5\r\n> num_classes = 10\r\n> \r\n> \r\n> def buildmodel():\r\n>     img_input = Input(shape=(32, 32, 3))\r\n> \r\n>     x = Conv2D(16, (3, 3), padding='same')(img_input)\r\n>     x = Activation(\"relu\")(x)\r\n>     x = Conv2D(16, (3, 3), padding='same')(x)\r\n>     x = Activation(\"relu\")(x)\r\n>     x = GlobalAveragePooling2D()(x)\r\n>     prediction = Dense(num_classes,activation='softmax', name = 'classifier') (x)  \r\n>     model = Model(inputs=img_input, outputs=prediction)\r\n>     return model\r\n> \r\n> (trainX, trainY), (testX, testY) = cifar10.load_data()\r\n> mean = np.mean(trainX, axis=0)\r\n> std = np.std(trainX)\r\n> \r\n> trainX = trainX.astype('float32')\r\n> trainX = (trainX - mean) / std\r\n> testX = testX.astype('float32')\r\n> testX = (testX - mean) / std\r\n> \r\n> trainY = kutils.to_categorical(trainY)\r\n> testY = kutils.to_categorical(testY)\r\n> \r\n> generator = ImageDataGenerator()\r\n> generator.fit(trainX)\r\n> val_generator = ImageDataGenerator()\r\n> \r\n> for i in range(10):\r\n>     tf.keras.backend.clear_session()\r\n>     model = buildmodel()\r\n>     sgd = SGD(lr=0.1, momentum=0.9, nesterov=True)\r\n>     model.compile(loss=\"categorical_crossentropy\", optimizer=sgd, metrics=[\"acc\"])\r\n>     model.fit(generator.flow(trainX, trainY, batch_size=batch_size), epochs=epochs, validation_data=val_generator.flow(testX, testY, batch_size = batch_size),verbose=0, workers = 20)\r\n>     print('memory usesd: ' + str(psutil.virtual_memory().used // 1e6))\r\n>     gc.collect()\r\n> ```\r\n> \r\n> output:\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 38012.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 38563.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 39288.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 40005.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 40730.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 41490.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 42216.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 42937.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 43659.0\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> WARNING:tensorflow:sample_weight modes were coerced from\r\n> ...\r\n> to\r\n> ['...']\r\n> memory usesd: 44403.0\r\n\r\nHowever, this issue still happens frequently in the latest versions of TF as mentioned in https://github.com/tensorflow/tensorflow/issues/37505. ", "@krenerd ,\r\n\r\nCould you please update TensorFlow to the latest stable version v2.5 and check if you are facing the same issue. Thanks!", "The situation is that I previously experienced this issue about 5 months ago and while I was currently working with TF 2.4 on another project, I  had this issue again. So I didn't test anything on v2.5 but it seems that other people including @jayagami was experiencing this issue even for TF 2.5 according to the threads in https://github.com/tensorflow/tensorflow/issues/37505. \r\n\r\nSo this doesn't seem like a version issue and the code above will still reproduce the leak in TF 2.5.", "I also met the memory issue when I used @tf.function\r\n\r\n```\r\ndef train_step():\r\n     @tf.function\r\n     def train_step1(data, model, lr, loss_object, optimizer, train_loss, train_accuracy)\r\n         with tf.GradientTape() as tape:\r\n             prediction = model(data[0])\r\n             loss = loss_object(data[1], prediction)\r\n\r\n         gradients = tape.gradient(loss, model.trainable_variables)\r\n         optimizer.learning_rate = lr\r\n         optimizer.apply_gradients(zip(gradients, model.trainable_variables))\r\n\r\n         train_loss(loss)\r\n         train_accuracy(data[1], prediction)\r\n\r\n     return train_step1\r\n```\r\n\r\nAfter deleting @tf.function, it doesn't make the issue any more.\r\n(tensorflow==2.4.0)", "@krenerd ,\r\n\r\nI ran your code with tf-nightly and I don't see any improvement in the memory as much as you have noticed. When I ran your code with tf-nightly, i see the following ouput.\r\nmemory usesd: 9495.0\r\nmemory usesd: 9500.0\r\nmemory usesd: 9497.0\r\nmemory usesd: 9498.0\r\nmemory usesd: 9500.0\r\nmemory usesd: 9502.0\r\nmemory usesd: 9502.0\r\nmemory usesd: 9502.0\r\nmemory usesd: 9509.0\r\nmemory usesd: 9505.\r\n\r\nPlease find the gist [here](https://colab.research.google.com/gist/tilakrayal/3e17f108df21ae980a2e005b9567c2f6/untitled50379.ipynb). Can you please verify once with tf-nightly and close the issue if this was resolved for you. Thanks!", "Cool, I understand that the bug was fixed in `tf-nightly` since I also tried it in my local environment w/o memory leaks. ", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50379\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50379\">No</a>\n", "Is the current status that the memory leak is fixed in keras-nightly but not keras?", "This memory leak is most definitely still not fixed. Keras remains unusable for any longer training time unless a custom raining loop is used.", "Upvote. Upvote. ", "After months dealing with this unbelievable memory leak, I think I stumbled on a simple workaround -- return sample weights from the generator. I introduced them today for other reasons and the memory leak completely disappeared. I've never been so happy in my life, I'm going to buy a lotto ticket.\r\n\r\nTF folks really need to fix this, but I hope others confirm this simple workaround.", "I explored further and a separate, trivial change was responsible for curing the memory leak. In on_epoch_end I was updaing a generator class variable with a new numpy array. The old numpy arrays should be collected by normal gc cycles, but never are. They pile up, and even forcing gc will not collect them. I changed the logic to alter the array in place instead of creating a new one, and the memory leak is gone.\r\n\r\nI hope this helps someone at TF solve this bug. I also hope this helps others with terrible memory leaks in Keras.\r\n\r\n", "Hello @dcbarton ,\r\nAs this issue is closed, I request to please submit a new issue from [this link](https://github.com/tensorflow/tensorflow/issues/new/choose) and fill in the template, so that we can track the issue there. Thanks!\r\n", "> I explored further and a separate, trivial change was responsible for curing the memory leak. In on_epoch_end I was updaing a generator class variable with a new numpy array. The old numpy arrays should be collected by normal gc cycles, but never are. They pile up, and even forcing gc will not collect them. I changed the logic to alter the array in place instead of creating a new one, and the memory leak is gone.\r\n> \r\n> I hope this helps someone at TF solve this bug. I also hope this helps others with terrible memory leaks in Keras.\r\n\r\nHi @dcbarton ,\r\nCan you please post the code responsible for the fix? \r\nIt would be a great help", "THIS CODE ACCUMULATES MEMORY LEAK, EVEN WITH FORCED GC\r\nclass DataGenerator(Sequence):\r\n    def on_epoch_end(self):\r\n        self.indexes = np.arange(self.startIdx, self.endIdx, 1, dtype=np.int32)\r\n        np.random.shuffle(self.indexes)\r\n\r\nTHIS CODE WORKS AROUND BY REUSING THE BUFFER, BETTER CODE ANYWAY\r\nclass DataGenerator(Sequence):\r\n    def __init__(self):\r\n        self.indexes = np.arange(self.startIdx, self.endIdx, 1, dtype=np.int32)\r\n    def on_epoch_end(self):        \r\n        np.random.shuffle(self.indexes)\r\n\r\n", "Thank you, will update if this helped"]}, {"number": 50378, "title": "Input to reshape is a tensor with 256 values, but the requested shape has 16 \t [[node sequential/dense_features/G/Reshape (defined at <ipython-input-39-b5709d2bb787>:2) ]] [Op:__inference_predict_function_9466]", "body": "def predict_input_fn(fileNames,patch,bands):\r\n\r\n  # You have to know the following from your export.\r\n  PATCH_WIDTH, PATCH_HEIGHT = patch\r\n  PATCH_DIMENSIONS_FLAT = [PATCH_WIDTH * PATCH_HEIGHT, 1]\r\n\r\n  # Note that the tensors are in the shape of a patch, one patch for each band.\r\n  imageColumns = [\r\n    tf.io.FixedLenSequenceFeature(shape=PATCH_DIMENSIONS_FLAT, dtype=tf.float32, allow_missing=True) \r\n      for k in bands\r\n  ]\r\n\r\n  featuresDict = dict(zip(bands, imageColumns))\r\n  dataset = tf.data.TFRecordDataset(fileNames, compression_type='GZIP')\r\n  \r\n  # Make a parsing function\r\n  def parse_image(example_proto):\r\n    parsed_features = tf.io.parse_single_example(example_proto, featuresDict)\r\n    return parsed_features\r\n\r\n  dataset = dataset.map(parse_image, num_parallel_calls=4)\r\n  \r\n  # Break our long tensors into many littler ones\r\n\r\n  dataset = dataset.flat_map(lambda features: tf.data.Dataset.from_tensor_slices(features))\r\n\r\n  # Read in batches corresponding to patch size.\r\n  dataset = dataset.batch(PATCH_WIDTH * PATCH_HEIGHT)\r\n\r\n  return dataset\r\n\r\n\r\npredict_db = predict_input_fn(fileNames=imageFilesList,patch=[4,4],bands=['R', 'G', 'B', 'NDVI'])\r\npredictions = model.predict(predict_db)", "comments": ["@pawansingh1610 Could you please fill the issue template.Also Please provide the simple standalone code/ colab link to reproduce the issue at our end.Thanks", "https://colab.research.google.com/drive/1VKhYGnPDKDlEWoVOqlVykpt7PJq_vG05?usp=sharing", "@pawansingh1610   Please create a colab gist and share with us since we are unable to access the drive which you have shared. Thanks!", "https://github.com/pawansingh1610/tf_ee2/blob/main/tf_ee2.ipynb", "Tried to reproduce the issue but facing different error like to signup on earth engine. Please find the gist [here](https://colab.research.google.com/gist/saikumarchalla/4e45f565c4293976e6212b6ec62cbf72/tf_ee2.ipynb). Thanks!", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50378\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50378\">No</a>\n"]}, {"number": 50377, "title": "Bug in custom layer input tensor", "body": "System: Python 3.8.3 64-bit | Qt 5.12.9 | PyQt5 5.12.3 | Linux 5.8.0-55-generic \r\n              keras (newest version)\r\n```#!/usr/bin/env python3\r\nfrom keras.layers import Layer\r\nimport numpy as np\r\nfrom keras.layers import Input\r\nfrom keras.models import Model  \r\n\r\nInputTensor = [0.1,0.2,0.3]      # Attention! Different tensors cause errors. \r\n                                 # See  below the code!\r\n\r\nInputTensor = np.array(InputTensor) \r\n\r\nclass MyLayer(Layer):\r\n    \r\n    def __init__(self, **kwargs):\r\n        super(MyLayer, self).__init__(**kwargs)\r\n    def build(self, input_shape):\r\n        self.built = True\r\n        super(MyLayer,self).build(input_shape)\r\n\r\n    def call(self, x):\r\n        return x\r\n\r\ninputlayer = Input(shape = InputTensor.shape)\r\nlayer = MyLayer()(inputlayer)\r\n\r\nmodel = Model(inputlayer, layer ) \r\nmodel.summary()\r\n\r\nOutput = model.predict(InputTensor)\r\noutput = np.array(Output)\r\nprint(\"dim(Output) = \"+str(output.ndim))\r\nprint(\"Output = \"+str(Output))\r\n```\r\n\r\n1. Input tensor [0.1,0.2,0.3] cause no problems. Output is [[0.1][0.2][0.2]]. Access to tensor elements are possible. model.summary is (None,2), ndim is 2.\r\n2. Input tensor [[0.1, 0.2,0.3],[0.2,0.3,0.4],[0.3,0.4,0.5]] has an output as [[0.1 0.2 0.3][0.2 0.3 0.4][0.3 0.4 0.5]] and model.summary indicate a shape like (None,3,3) so that a tensor of tree dimensions is expected. ndim should be 3 instead of 2! Access to tensor elements is possible if you consider 2 dimensions instead of 3.\r\n3. Input tensor [[0.1,0.2,0.3],[0.2,0.3,0.4]] generates an error message. It expected a shape of (None,2,3) and found only (None,3) although model.summary shows (None,2,3). \r\n\r\nIt shouldn't have any influence how many dimensions a tensor has, nor how big its elements are!\r\nMy task is, to get access to single elements of a tensor to generate an output tensor something like\r\n```\r\nclass MyLayer(Layer):\r\n    def __init__(self, **kwargs):\r\n        super(MyLayer, self).__init__(**kwargs)\r\n    def build(self, input_shape):\r\n        self.built = True\r\n        super(MyLayer,self).build(input_shape)\r\n\r\n    def call(self, x):\r\n        OutputTensor = [[0.0, 0.0],\r\n                        [0.0, 0.0]]\r\n        OutputTensor[0][0] = x[0][0]\r\n        OutputTensor[1][1] = x[1][0]\r\n        OutputTensor[1][0] = x[2][0]\r\n        return OutputTensor\r\n```\r\n", "comments": ["@Oezkan23 \r\n\r\nCould you please share the colab gist to analyse more of it.Thanks\r\n", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "> @Oezkan23\r\n> \r\n> Could you please share the colab gist to analyse more of it.Thanks\r\nSee:\r\nhttps://gist.github.com/Oezkan23/630ed43d3a80b550e025037fa2439484", "@Oezkan23 \r\n\r\nPlease post this issue on [keras-team/keras](https://github.com/keras-team/keras/issues) repo.\r\nTo know more refer to:\r\nhttps://discuss.tensorflow.org/t/keras-project-moved-to-new-repository-in-https-github-com-keras-team-keras/1999\r\n", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50377\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50377\">No</a>\n"]}, {"number": 50375, "title": "Issues in deciphering TensorFlowLite Interpreter output", "body": "I have been doing an image classification problem where in the objective is to train a predefined neural network model with set of tfrecords and do inference. This all is happening with reasonable accuracy In Colab.\r\n\r\nSubsequent to this I converted the saved_model.pb into model.tflite file. I have checked it against the netron app it is seemingly taking correct inputs (which is an image tensor).\r\n\r\nAfter this I called interpreter.invoke().\r\n\r\nFollowing this when I try to decipher the output tensor I should be able to at least render the output the image, but i am having difficulty in doing this.\r\n\r\nThis is the link of colab notebook https://colab.research.google.com/drive/1kisxBtImUS7sT2aQlsEKfcXaEnsKumGw?usp=sharing where I have maintained the code.\r\n\r\nI have other colab notebooks where similar code was done with training for upto 7500 iterations, but i am stuck in all the case at the interpreter level, since i have to port this app on to Android platform", "comments": ["Could you help clean up the colab a little bit?\r\n\r\nIt seems you run an object detection TF model somewhere in between, and then work on the TFLite model. The TFLite model outputs a 1x10x4 tensor, so it doesn't look like an image classification model. Is it also an object detection model?\r\n\r\nAnd for both image classification / object detection, the output is not an image, so it doesn't make sense to directly render the output.\r\n - image classifcation should output the confidence scores for each category.\r\n -  object detection usually output the relative coordinates of the bounding boxes, and category labels (in another tensor, very likely).", "@VirVisha, Is your issue resolved now? Else, did you checked [this response](https://github.com/tensorflow/tensorflow/issues/50375#issuecomment-872114199)?", "This issue has been automatically marked as stale because it has no recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50375\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50375\">No</a>\n"]}, {"number": 50374, "title": "Fix edge case names in to_snake_case internal util", "body": "Fixes #50288.\r\n\r\n```python\r\n>>> for cls in sorted(Layer.__subclasses__(), key=lambda c: c.__name__):\r\n>>>   new = to_snake_case_proposed(cls.__name__)\r\n>>>   old = to_snake_case_orig(cls.__name__)\r\n>>>   if new != old:\r\n>>>       print(old, '-->', new) \r\nconv_lst_m2d_cell --> conv_lstm2d_cell\r\nleaky_re_lu --> leaky_relu\r\np_re_lu --> p_relu\r\nre_lu --> relu\r\nthresholded_re_lu --> thresholded_relu\r\n```", "comments": ["Thanks for the PR. We've actually fixed this issue as part of a separate change. Note that the current behavior does not special case relu (that would be weird), so `ReLU` gets converted to `re_lu`. While perhaps not pretty, it is what the capitalization of `ReLU` means.", "Thanks for letting me know. While I understand that reasoning, and for the sake of backwards compatibility, I see ReLU referred to as `'relu'` throughout the codebase and examples, e.g., `keras.layers.Dense(32, activation='relu')`. Not a big deal though. Glad the issue has been fixed!"]}, {"number": 50373, "title": "Django ", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version:\r\n- Python version: 3.9\r\n- Installed using virtualenv? pip? conda?:Pip\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n I get this error when installing Django and Django rest framework :\r\nERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: 'c:\\\\python39\\\\Scripts\\\\django-admin.py'\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\npip install django djangorestframework\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nCollecting django\r\n  Using cached Django-3.2.4-py3-none-any.whl (7.9 MB)\r\nCollecting djangorestframework\r\n  Using cached djangorestframework-3.12.4-py3-none-any.whl (957 kB)\r\nRequirement already satisfied: asgiref<4,>=3.3.2 in c:\\python39\\lib\\site-packages (from django) (3.3.4)\r\nRequirement already satisfied: sqlparse>=0.2.2 in c:\\python39\\lib\\site-packages (from django) (0.4.1)\r\nRequirement already satisfied: pytz in c:\\python39\\lib\\site-packages (from django) (2021.1)\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nInstalling collected packages: django, djangorestframework\r\nERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: 'c:\\\\python39\\\\Scripts\\\\django-admin.py'\r\nConsider using the `--user` option or check the permissions.\r\n\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nWARNING: Ignoring invalid distribution -ip (c:\\python39\\lib\\site-packages)\r\nWARNING: You are using pip version 21.1.1; however, version 21.1.2 is available.\r\nYou should consider upgrading via the 'c:\\python39\\python.exe -m pip install --upgrade pip' command.", "comments": ["@Thecoderlegend101 \r\nThis is not relevant to tensorflow issue.Please post this in [Stackoverflow](https://stackoverflow.com/questions/tagged/tensorflow).There is a big community to answer these kind of questions.\r\nPlease also refer similar  [issue](https://stackoverflow.com/questions/37573350/error-while-installing-django-rest-framework).Thanks", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50373\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50373\">No</a>\n"]}, {"number": 50372, "title": "cannot import name '__version__' from 'keras'", "body": "If I open the codelab and follow the instructions, the code blocks eventually fail when \r\nany part of tensorflow imports keras.\r\n\r\nThis notebook uses nightly packages\r\n\r\n print(tf.version.GIT_VERSION, tf.version.VERSION)\r\nv1.12.1-58938-g67a33c36c28 2.6.0-dev20210620\r\n\r\n**Describe the expected behavior**\r\nI expect to be able to `import keras`\r\n\r\nhttps://www.tensorflow.org/guide/advanced_autodiff\r\n\r\n**Describe the current behavior**\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-4-4f42995a43b2> in <module>()\r\n      3 import matplotlib as mpl\r\n      4 import matplotlib.pyplot as plt\r\n----> 5 import keras\r\n      6 \r\n      7 mpl.rcParams['figure.figsize'] = (8, 6)\r\n\r\n9 frames\r\n/usr/local/lib/python3.7/dist-packages/keras/api/_v2/keras/__init__.py in <module>()\r\n      8 import sys as _sys\r\n      9 \r\n---> 10 from keras import __version__\r\n     11 from keras.api._v2.keras import activations\r\n     12 from keras.api._v2.keras import applications\r\n\r\nImportError: cannot import name '__version__' from 'keras' (/usr/local/lib/python3.7/dist-packages/keras/__init__.py)\r\n\r\n---------------------------------------------------------------------------\r\nNOTE: If your import is failing due to a missing package, you can\r\nmanually install dependencies using either !pip or !apt.\r\n\r\nTo view examples of installing some common dependencies, click the\r\n\"Open Examples\" button below.\r\n-------------------------------\r\n```\r\n", "comments": ["@japrogramer ,\r\n\r\nCan you please try to import keras as **from tensorflow import keras** and let us know if you are facing same issue.Please find the gist of it [here](https://colab.research.google.com/gist/tilakrayal/e205b6c294997e3aaaeb3fc5a20eaa19/untitled50372.ipynb).Also please take a look at this [comment](https://github.com/googlecolab/colabtools/issues/2044#issuecomment-849161550) from issue.It helps.Thanks!", "@tilakrayal \r\n\r\n<img width=\"1050\" alt=\"Screenshot 2021-06-22 at 1 06 47 PM\" src=\"https://user-images.githubusercontent.com/64910857/122866538-b5782780-d35a-11eb-81e9-0a5e754e9a18.png\">\r\n<img width=\"455\" alt=\"Screenshot 2021-06-22 at 1 07 09 PM\" src=\"https://user-images.githubusercontent.com/64910857/122866566-c2951680-d35a-11eb-8a67-2b72f89b82f0.png\">\r\n<img width=\"310\" alt=\"Screenshot 2021-06-22 at 1 07 27 PM\" src=\"https://user-images.githubusercontent.com/64910857/122866596-ccb71500-d35a-11eb-963a-f55e7a484fcd.png\">\r\n\r\nI am getting the same error in colab, tried to execute **from tensorflow import keras** after executing **import tensorflow as tf** but it's giving the same import error message \"**cannot import name '__version__' from 'keras'**\". The 3 lines of code I used for setup are as follows:\r\n**! pip uninstall tensorflow\r\n! pip install -q tf-nightly\r\n! pip install -q tensorflow-model-optimization**\r\nCould you please help me out ASAP as I'm doing this part of a project and need to complete this part by today. Thank you!", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "This seems to be an issue with the nightly build of tensorflow", "@japrogramer \r\nPlease confirm if you have tried adding !pip uninstall keras-nightly before import keras makes as we are not facing the issue. [you my also try ! pip install tensorflow --upgrade and let us know]", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50372\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50372\">No</a>\n"]}, {"number": 50371, "title": "Cus change", "body": "", "comments": ["\nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit <https://cla.developers.google.com/> to sign.**\n\nOnce you've signed (or fixed any issues), please reply here with `@googlebot I signed it!` and we'll verify it.\n\n----\n\n#### What to do if you already signed the CLA\n\n##### Individual signers\n\n*   It's possible we don't have your GitHub username or you're using a different email address on your commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n\n##### Corporate signers\n\n*   Your company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to [go/cla#troubleshoot](http://go/cla#troubleshoot) ([Public version](https://opensource.google/docs/cla/#troubleshoot)).\n*   The email used to register you as an authorized contributor must be the email used for the Git commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n*   The email used to register you as an authorized contributor must also be [attached to your GitHub account](https://github.com/settings/emails).\n\t\t\n\n\u2139\ufe0f **Googlers: [Go here](https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fpull%2F50371) for more info**.\n\n<!-- need_sender_cla -->"]}, {"number": 50370, "title": "Brand new Pipenv environment can't install tensorflow?", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): \r\n  ```bash\r\n  ProductName:\tmacOS\r\n  ProductVersion:\t11.4\r\n  BuildVersion:\t20F71\r\n  ```\r\n- TensorFlow installed from (source or binary): source?\r\n- TensorFlow version: 2.5.0 and below\r\n- Python version: 3.8.10\r\n- Installed using virtualenv? pip? conda?: `pipenv`\r\n- GCC/Compiler version (if compiling from source):\r\n  ```\r\n  \u276f gcc --version\r\n  Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/c++/4.2.1\r\n  Apple clang version 12.0.5 (clang-1205.0.22.9)\r\n  Target: x86_64-apple-darwin20.5.0\r\n  Thread model: posix\r\n  InstalledDir: /Library/Developer/CommandLineTools/usr/bin\r\n  ```\r\n\r\n\r\n\r\n**Describe the problem**\r\nTensorflow can't install in a brand new virtual environment.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n```bash\r\n~/test/Python\r\n\u276f pipenv install tensorflow\r\nInstalling tensorflow...\r\nAdding tensorflow to Pipfile's [packages]...\r\n\u2714 Installation Succeeded\r\nPipfile.lock (29ca33) out of date, updating to (cc17c6)...\r\nLocking [dev-packages] dependencies...\r\nLocking [packages] dependencies...\r\nBuilding requirements...\r\nResolving dependencies...\r\n\u2718 Locking Failed!\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 741, in _main\r\n[ResolutionFailure]:       resolve_packages(pre, clear, verbose, system, write, requirements_dir, packages, dev)\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 702, in resolve_packages\r\n[ResolutionFailure]:       results, resolver = resolve(\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 684, in resolve\r\n[ResolutionFailure]:       return resolve_deps(\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 1397, in resolve_deps\r\n[ResolutionFailure]:       results, hashes, markers_lookup, resolver, skipped = actually_resolve_deps(\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 1110, in actually_resolve_deps\r\n[ResolutionFailure]:       resolver.resolve()\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 835, in resolve\r\n[ResolutionFailure]:       raise ResolutionFailure(message=str(e))\r\n[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.\r\n  First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.\r\n Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.\r\n  Hint: try $ pipenv lock --pre if it is a pre-release dependency.\r\nERROR: Could not find a version that matches tensorflow (from -r /var/folders/28/2sy26r512hq5jdpx18q4ycjw0000gn/T/pipenvf89b7toyrequirements/pipenv-gherejrb-constraints.txt (line 6))\r\nNo versions found\r\nWas https://pypi.org/simple reachable?\r\n```\r\n\r\n**Any other info / logs**\r\nPipenv support output\r\n<details><summary>$ pipenv --support</summary>\r\n\r\nPipenv version: `'2021.5.29'`\r\n\r\nPipenv location: `'/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv'`\r\n\r\nPython location: `'/Users/anthony/.local/pipx/venvs/pipenv/bin/python'`\r\n\r\nPython installations found:\r\n\r\n  - `3.9.5`: `/Users/anthony/.pyenv/versions/3.9.5/bin/python3`\r\n  - `3.9.5`: `/usr/local/bin/python3`\r\n  - `3.9.5`: `/usr/local/bin/python3.9`\r\n  - `3.8.10`: `/Users/anthony/.pyenv/versions/3.8.10/bin/python3`\r\n  - `3.8.2`: `/usr/bin/python3`\r\n  - `3.7.10`: `/Users/anthony/.pyenv/versions/3.7.10/bin/python3`\r\n  - `2.7.16`: `/usr/bin/python2`\r\n  - `2.7.16`: `/usr/bin/python2.7`\r\n\r\nPEP 508 Information:\r\n\r\n```\r\n{'implementation_name': 'cpython',\r\n 'implementation_version': '3.8.10',\r\n 'os_name': 'posix',\r\n 'platform_machine': 'x86_64',\r\n 'platform_python_implementation': 'CPython',\r\n 'platform_release': '20.5.0',\r\n 'platform_system': 'Darwin',\r\n 'platform_version': 'Darwin Kernel Version 20.5.0: Sat May  8 05:10:33 PDT '\r\n                     '2021; root:xnu-7195.121.3~9/RELEASE_X86_64',\r\n 'python_full_version': '3.8.10',\r\n 'python_version': '3.8',\r\n 'sys_platform': 'darwin'}\r\n```\r\n\r\nSystem environment variables:\r\n\r\n  - `TERM_SESSION_ID`\r\n  - `SSH_AUTH_SOCK`\r\n  - `LC_TERMINAL_VERSION`\r\n  - `COLORFGBG`\r\n  - `ITERM_PROFILE`\r\n  - `XPC_FLAGS`\r\n  - `LANG`\r\n  - `PWD`\r\n  - `SHELL`\r\n  - `__CFBundleIdentifier`\r\n  - `TERM_PROGRAM_VERSION`\r\n  - `TERM_PROGRAM`\r\n  - `PATH`\r\n  - `LC_TERMINAL`\r\n  - `COLORTERM`\r\n  - `COMMAND_MODE`\r\n  - `TERM`\r\n  - `HOME`\r\n  - `TMPDIR`\r\n  - `USER`\r\n  - `XPC_SERVICE_NAME`\r\n  - `LOGNAME`\r\n  - `ITERM_SESSION_ID`\r\n  - `__CF_USER_TEXT_ENCODING`\r\n  - `SHLVL`\r\n  - `OLDPWD`\r\n  - `P9K_TTY`\r\n  - `_P9K_TTY`\r\n  - `P9K_SSH`\r\n  - `ZSH`\r\n  - `MANPAGER`\r\n  - `SDKROOT`\r\n  - `PAGER`\r\n  - `LESS`\r\n  - `LSCOLORS`\r\n  - `RBENV_SHELL`\r\n  - `YSU_VERSION`\r\n  - `_`\r\n  - `PIP_DISABLE_PIP_VERSION_CHECK`\r\n  - `PYTHONDONTWRITEBYTECODE`\r\n  - `PIP_SHIMS_BASE_MODULE`\r\n  - `PIP_PYTHON_PATH`\r\n  - `PYTHONFINDER_IGNORE_UNSUPPORTED`\r\n\r\nPipenv\u2013specific environment variables:\r\n\r\n\r\nDebug\u2013specific environment variables:\r\n\r\n  - `PATH`: `/Users/anthony/.rbenv/shims:/Users/anthony/.pyenv/shims:/Users/anthony/.local/share/gem/ruby/3.0.0/bin:/usr/local/opt/ruby/bin:/usr/local/lib/ruby/gems/3.0.0/bin:/Users/anthony/.local/bin:/Users/anthony/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/Library/Apple/usr/bin:/usr/local/opt/fzf/bin`\r\n  - `SHELL`: `/bin/zsh`\r\n  - `LANG`: `en_US.UTF-8`\r\n  - `PWD`: `/Users/anthony/test/Python`\r\n\r\n\r\n---------------------------\r\n\r\nContents of `Pipfile` ('/Users/anthony/test/Python/Pipfile'):\r\n\r\n```toml\r\n[[source]]\r\nurl = \"https://pypi.org/simple\"\r\nverify_ssl = true\r\nname = \"pypi\"\r\n\r\n[packages]\r\npandas = \"*\"\r\nipykernel = \"*\"\r\ntabulate = \"*\"\r\nmarkdown = \"*\"\r\n\r\n[dev-packages]\r\n\r\n[requires]\r\npython_version = \"3.8\"\r\n\r\n```\r\n\r\n\r\nContents of `Pipfile.lock` ('/Users/anthony/test/Python/Pipfile.lock'):\r\n\r\n```json\r\n{\r\n    \"_meta\": {\r\n        \"hash\": {\r\n            \"sha256\": \"858b7acf7ae36f845ff8aa68ad3d39b0ffe174ba51524472f7adf2266429ca33\"\r\n        },\r\n        \"pipfile-spec\": 6,\r\n        \"requires\": {\r\n            \"python_version\": \"3.8\"\r\n        },\r\n        \"sources\": [\r\n            {\r\n                \"name\": \"pypi\",\r\n                \"url\": \"https://pypi.org/simple\",\r\n                \"verify_ssl\": true\r\n            }\r\n        ]\r\n    },\r\n    \"default\": {\r\n        \"appnope\": {\r\n            \"hashes\": [\r\n                \"sha256:93aa393e9d6c54c5cd570ccadd8edad61ea0c4b9ea7a01409020c9aa019eb442\",\r\n                \"sha256:dd83cd4b5b460958838f6eb3000c660b1f9caf2a5b1de4264e941512f603258a\"\r\n            ],\r\n            \"markers\": \"sys_platform == 'darwin' and platform_system == 'Darwin'\",\r\n            \"version\": \"==0.1.2\"\r\n        },\r\n        \"backcall\": {\r\n            \"hashes\": [\r\n                \"sha256:5cbdbf27be5e7cfadb448baf0aa95508f91f2bbc6c6437cd9cd06e2a4c215e1e\",\r\n                \"sha256:fbbce6a29f263178a1f7915c1940bde0ec2b2a967566fe1c65c1dfb7422bd255\"\r\n            ],\r\n            \"version\": \"==0.2.0\"\r\n        },\r\n        \"decorator\": {\r\n            \"hashes\": [\r\n                \"sha256:6e5c199c16f7a9f0e3a61a4a54b3d27e7dad0dbdde92b944426cb20914376323\",\r\n                \"sha256:72ecfba4320a893c53f9706bebb2d55c270c1e51a28789361aa93e4a21319ed5\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.5'\",\r\n            \"version\": \"==5.0.9\"\r\n        },\r\n        \"ipykernel\": {\r\n            \"hashes\": [\r\n                \"sha256:29eee66548ee7c2edb7941de60c0ccf0a7a8dd957341db0a49c5e8e6a0fcb712\",\r\n                \"sha256:e976751336b51082a89fc2099fb7f96ef20f535837c398df6eab1283c2070884\"\r\n            ],\r\n            \"index\": \"pypi\",\r\n            \"version\": \"==5.5.5\"\r\n        },\r\n        \"ipython\": {\r\n            \"hashes\": [\r\n                \"sha256:9bc24a99f5d19721fb8a2d1408908e9c0520a17fff2233ffe82620847f17f1b6\",\r\n                \"sha256:d513e93327cf8657d6467c81f1f894adc125334ffe0e4ddd1abbb1c78d828703\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.7'\",\r\n            \"version\": \"==7.24.1\"\r\n        },\r\n        \"ipython-genutils\": {\r\n            \"hashes\": [\r\n                \"sha256:72dd37233799e619666c9f639a9da83c34013a73e8bbc79a7a6348d93c61fab8\",\r\n                \"sha256:eb2e116e75ecef9d4d228fdc66af54269afa26ab4463042e33785b887c628ba8\"\r\n            ],\r\n            \"version\": \"==0.2.0\"\r\n        },\r\n        \"jedi\": {\r\n            \"hashes\": [\r\n                \"sha256:18456d83f65f400ab0c2d3319e48520420ef43b23a086fdc05dff34132f0fb93\",\r\n                \"sha256:92550a404bad8afed881a137ec9a461fed49eca661414be45059329614ed0707\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.6'\",\r\n            \"version\": \"==0.18.0\"\r\n        },\r\n        \"jupyter-client\": {\r\n            \"hashes\": [\r\n                \"sha256:c4bca1d0846186ca8be97f4d2fa6d2bae889cce4892a167ffa1ba6bd1f73e782\",\r\n                \"sha256:e053a2c44b6fa597feebe2b3ecb5eea3e03d1d91cc94351a52931ee1426aecfc\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.5'\",\r\n            \"version\": \"==6.1.12\"\r\n        },\r\n        \"jupyter-core\": {\r\n            \"hashes\": [\r\n                \"sha256:79025cb3225efcd36847d0840f3fc672c0abd7afd0de83ba8a1d3837619122b4\",\r\n                \"sha256:8c6c0cac5c1b563622ad49321d5ec47017bd18b94facb381c6973a0486395f8e\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.6'\",\r\n            \"version\": \"==4.7.1\"\r\n        },\r\n        \"markdown\": {\r\n            \"hashes\": [\r\n                \"sha256:31b5b491868dcc87d6c24b7e3d19a0d730d59d3e46f4eea6430a321bed387a49\",\r\n                \"sha256:96c3ba1261de2f7547b46a00ea8463832c921d3f9d6aba3f255a6f71386db20c\"\r\n            ],\r\n            \"index\": \"pypi\",\r\n            \"version\": \"==3.3.4\"\r\n        },\r\n        \"matplotlib-inline\": {\r\n            \"hashes\": [\r\n                \"sha256:5cf1176f554abb4fa98cb362aa2b55c500147e4bdbb07e3fda359143e1da0811\",\r\n                \"sha256:f41d5ff73c9f5385775d5c0bc13b424535c8402fe70ea8210f93e11f3683993e\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.5'\",\r\n            \"version\": \"==0.1.2\"\r\n        },\r\n        \"numpy\": {\r\n            \"hashes\": [\r\n                \"sha256:1676b0a292dd3c99e49305a16d7a9f42a4ab60ec522eac0d3dd20cdf362ac010\",\r\n                \"sha256:16f221035e8bd19b9dc9a57159e38d2dd060b48e93e1d843c49cb370b0f415fd\",\r\n                \"sha256:43909c8bb289c382170e0282158a38cf306a8ad2ff6dfadc447e90f9961bef43\",\r\n                \"sha256:4e465afc3b96dbc80cf4a5273e5e2b1e3451286361b4af70ce1adb2984d392f9\",\r\n                \"sha256:55b745fca0a5ab738647d0e4db099bd0a23279c32b31a783ad2ccea729e632df\",\r\n                \"sha256:5d050e1e4bc9ddb8656d7b4f414557720ddcca23a5b88dd7cff65e847864c400\",\r\n                \"sha256:637d827248f447e63585ca3f4a7d2dfaa882e094df6cfa177cc9cf9cd6cdf6d2\",\r\n                \"sha256:6690080810f77485667bfbff4f69d717c3be25e5b11bb2073e76bb3f578d99b4\",\r\n                \"sha256:66fbc6fed94a13b9801fb70b96ff30605ab0a123e775a5e7a26938b717c5d71a\",\r\n                \"sha256:67d44acb72c31a97a3d5d33d103ab06d8ac20770e1c5ad81bdb3f0c086a56cf6\",\r\n                \"sha256:6ca2b85a5997dabc38301a22ee43c82adcb53ff660b89ee88dded6b33687e1d8\",\r\n                \"sha256:6e51534e78d14b4a009a062641f465cfaba4fdcb046c3ac0b1f61dd97c861b1b\",\r\n                \"sha256:70eb5808127284c4e5c9e836208e09d685a7978b6a216db85960b1a112eeace8\",\r\n                \"sha256:830b044f4e64a76ba71448fce6e604c0fc47a0e54d8f6467be23749ac2cbd2fb\",\r\n                \"sha256:8b7bb4b9280da3b2856cb1fc425932f46fba609819ee1c62256f61799e6a51d2\",\r\n                \"sha256:a9c65473ebc342715cb2d7926ff1e202c26376c0dcaaee85a1fd4b8d8c1d3b2f\",\r\n                \"sha256:c1c09247ccea742525bdb5f4b5ceeacb34f95731647fe55774aa36557dbb5fa4\",\r\n                \"sha256:c5bf0e132acf7557fc9bb8ded8b53bbbbea8892f3c9a1738205878ca9434206a\",\r\n                \"sha256:db250fd3e90117e0312b611574cd1b3f78bec046783195075cbd7ba9c3d73f16\",\r\n                \"sha256:e515c9a93aebe27166ec9593411c58494fa98e5fcc219e47260d9ab8a1cc7f9f\",\r\n                \"sha256:e55185e51b18d788e49fe8305fd73ef4470596b33fc2c1ceb304566b99c71a69\",\r\n                \"sha256:ea9cff01e75a956dbee133fa8e5b68f2f92175233de2f88de3a682dd94deda65\",\r\n                \"sha256:f1452578d0516283c87608a5a5548b0cdde15b99650efdfd85182102ef7a7c17\",\r\n                \"sha256:f39a995e47cb8649673cfa0579fbdd1cdd33ea497d1728a6cb194d6252268e48\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.7'\",\r\n            \"version\": \"==1.20.3\"\r\n        },\r\n        \"pandas\": {\r\n            \"hashes\": [\r\n                \"sha256:167693a80abc8eb28051fbd184c1b7afd13ce2c727a5af47b048f1ea3afefff4\",\r\n                \"sha256:2111c25e69fa9365ba80bbf4f959400054b2771ac5d041ed19415a8b488dc70a\",\r\n                \"sha256:298f0553fd3ba8e002c4070a723a59cdb28eda579f3e243bc2ee397773f5398b\",\r\n                \"sha256:2b063d41803b6a19703b845609c0b700913593de067b552a8b24dd8eeb8c9895\",\r\n                \"sha256:2cb7e8f4f152f27dc93f30b5c7a98f6c748601ea65da359af734dd0cf3fa733f\",\r\n                \"sha256:52d2472acbb8a56819a87aafdb8b5b6d2b3386e15c95bde56b281882529a7ded\",\r\n                \"sha256:612add929bf3ba9d27b436cc8853f5acc337242d6b584203f207e364bb46cb12\",\r\n                \"sha256:649ecab692fade3cbfcf967ff936496b0cfba0af00a55dfaacd82bdda5cb2279\",\r\n                \"sha256:68d7baa80c74aaacbed597265ca2308f017859123231542ff8a5266d489e1858\",\r\n                \"sha256:8d4c74177c26aadcfb4fd1de6c1c43c2bf822b3e0fc7a9b409eeaf84b3e92aaa\",\r\n                \"sha256:971e2a414fce20cc5331fe791153513d076814d30a60cd7348466943e6e909e4\",\r\n                \"sha256:9db70ffa8b280bb4de83f9739d514cd0735825e79eef3a61d312420b9f16b758\",\r\n                \"sha256:b730add5267f873b3383c18cac4df2527ac4f0f0eed1c6cf37fcb437e25cf558\",\r\n                \"sha256:bd659c11a4578af740782288cac141a322057a2e36920016e0fc7b25c5a4b686\",\r\n                \"sha256:c601c6fdebc729df4438ec1f62275d6136a0dd14d332fc0e8ce3f7d2aadb4dd6\",\r\n                \"sha256:d0877407359811f7b853b548a614aacd7dea83b0c0c84620a9a643f180060950\"\r\n            ],\r\n            \"index\": \"pypi\",\r\n            \"version\": \"==1.2.4\"\r\n        },\r\n        \"parso\": {\r\n            \"hashes\": [\r\n                \"sha256:12b83492c6239ce32ff5eed6d3639d6a536170723c6f3f1506869f1ace413398\",\r\n                \"sha256:a8c4922db71e4fdb90e0d0bc6e50f9b273d3397925e5e60a717e719201778d22\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.6'\",\r\n            \"version\": \"==0.8.2\"\r\n        },\r\n        \"pexpect\": {\r\n            \"hashes\": [\r\n                \"sha256:0b48a55dcb3c05f3329815901ea4fc1537514d6ba867a152b581d69ae3710937\",\r\n                \"sha256:fc65a43959d153d0114afe13997d439c22823a27cefceb5ff35c2178c6784c0c\"\r\n            ],\r\n            \"markers\": \"sys_platform != 'win32'\",\r\n            \"version\": \"==4.8.0\"\r\n        },\r\n        \"pickleshare\": {\r\n            \"hashes\": [\r\n                \"sha256:87683d47965c1da65cdacaf31c8441d12b8044cdec9aca500cd78fc2c683afca\",\r\n                \"sha256:9649af414d74d4df115d5d718f82acb59c9d418196b7b4290ed47a12ce62df56\"\r\n            ],\r\n            \"version\": \"==0.7.5\"\r\n        },\r\n        \"prompt-toolkit\": {\r\n            \"hashes\": [\r\n                \"sha256:08360ee3a3148bdb5163621709ee322ec34fc4375099afa4bbf751e9b7b7fa4f\",\r\n                \"sha256:7089d8d2938043508aa9420ec18ce0922885304cddae87fb96eebca942299f88\"\r\n            ],\r\n            \"markers\": \"python_full_version >= '3.6.1'\",\r\n            \"version\": \"==3.0.19\"\r\n        },\r\n        \"ptyprocess\": {\r\n            \"hashes\": [\r\n                \"sha256:4b41f3967fce3af57cc7e94b888626c18bf37a083e3651ca8feeb66d492fef35\",\r\n                \"sha256:5c5d0a3b48ceee0b48485e0c26037c0acd7d29765ca3fbb5cb3831d347423220\"\r\n            ],\r\n            \"version\": \"==0.7.0\"\r\n        },\r\n        \"pygments\": {\r\n            \"hashes\": [\r\n                \"sha256:a18f47b506a429f6f4b9df81bb02beab9ca21d0a5fee38ed15aef65f0545519f\",\r\n                \"sha256:d66e804411278594d764fc69ec36ec13d9ae9147193a1740cd34d272ca383b8e\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.5'\",\r\n            \"version\": \"==2.9.0\"\r\n        },\r\n        \"python-dateutil\": {\r\n            \"hashes\": [\r\n                \"sha256:73ebfe9dbf22e832286dafa60473e4cd239f8592f699aa5adaf10050e6e1823c\",\r\n                \"sha256:75bb3f31ea686f1197762692a9ee6a7550b59fc6ca3a1f4b5d7e32fb98e2da2a\"\r\n            ],\r\n            \"markers\": \"python_version >= '2.7' and python_version not in '3.0, 3.1, 3.2, 3.3'\",\r\n            \"version\": \"==2.8.1\"\r\n        },\r\n        \"pytz\": {\r\n            \"hashes\": [\r\n                \"sha256:83a4a90894bf38e243cf052c8b58f381bfe9a7a483f6a9cab140bc7f702ac4da\",\r\n                \"sha256:eb10ce3e7736052ed3623d49975ce333bcd712c7bb19a58b9e2089d4057d0798\"\r\n            ],\r\n            \"version\": \"==2021.1\"\r\n        },\r\n        \"pyzmq\": {\r\n            \"hashes\": [\r\n                \"sha256:089b974ec04d663b8685ac90e86bfe0e4da9d911ff3cf52cb765ff22408b102d\",\r\n                \"sha256:0ea7f4237991b0f745a4432c63e888450840bf8cb6c48b93fb7d62864f455529\",\r\n                \"sha256:0f0f27eaab9ba7b92d73d71c51d1a04464a1da6097a252d007922103253d2313\",\r\n                \"sha256:12ffcf33db6ba7c0e5aaf901e65517f5e2b719367b80bcbfad692f546a297c7a\",\r\n                \"sha256:1389b615917d4196962a9b469e947ba862a8ec6f5094a47da5e7a8d404bc07a4\",\r\n                \"sha256:18dd2ca4540c476558099891c129e6f94109971d110b549db2a9775c817cedbd\",\r\n                \"sha256:24fb5bb641f0b2aa25fc3832f4b6fc62430f14a7d328229fe994b2bcdc07c93a\",\r\n                \"sha256:285514956c08c7830da9d94e01f5414661a987831bd9f95e4d89cc8aaae8da10\",\r\n                \"sha256:41049cff5265e9cd75606aa2c90a76b9c80b98d8fe70ee08cf4af3cedb113358\",\r\n                \"sha256:461ed80d741692d9457ab820b1cc057ba9c37c394e67b647b639f623c8b321f6\",\r\n                \"sha256:4b8fb1b3174b56fd020e4b10232b1764e52cf7f3babcfb460c5253bdc48adad0\",\r\n                \"sha256:4c4fe69c7dc0d13d4ae180ad650bb900854367f3349d3c16f0569f6c6447f698\",\r\n                \"sha256:4e9b9a2f6944acdaf57316436c1acdcb30b8df76726bcf570ad9342bc5001654\",\r\n                \"sha256:6355f81947e1fe6e7bb9e123aeb3067264391d3ebe8402709f824ef8673fa6f3\",\r\n                \"sha256:68be16107f41563b9f67d93dff1c9f5587e0f76aa8fd91dc04c83d813bcdab1f\",\r\n                \"sha256:68e2c4505992ab5b89f976f89a9135742b18d60068f761bef994a6805f1cae0c\",\r\n                \"sha256:7040d6dd85ea65703904d023d7f57fab793d7ffee9ba9e14f3b897f34ff2415d\",\r\n                \"sha256:734ea6565c71fc2d03d5b8c7d0d7519c96bb5567e0396da1b563c24a4ac66f0c\",\r\n                \"sha256:9ee48413a2d3cd867fd836737b4c89c24cea1150a37f4856d82d20293fa7519f\",\r\n                \"sha256:a1c77796f395804d6002ff56a6a8168c1f98579896897ad7e35665a9b4a9eec5\",\r\n                \"sha256:b2f707b52e09098a7770503e39294ca6e22ae5138ffa1dd36248b6436d23d78e\",\r\n                \"sha256:bf80b2cec42d96117248b99d3c86e263a00469c840a778e6cb52d916f4fdf82c\",\r\n                \"sha256:c4674004ed64685a38bee222cd75afa769424ec603f9329f0dd4777138337f48\",\r\n                \"sha256:c6a81c9e6754465d09a87e3acd74d9bb1f0039b2d785c6899622f0afdb41d760\",\r\n                \"sha256:c6d0c32532a0519997e1ded767e184ebb8543bdb351f8eff8570bd461e874efc\",\r\n                \"sha256:c8fff75af4c7af92dce9f81fa2a83ed009c3e1f33ee8b5222db2ef80b94e242e\",\r\n                \"sha256:cb9f9fe1305ef69b65794655fd89b2209b11bff3e837de981820a8aa051ef914\",\r\n                \"sha256:d3ecfee2ee8d91ab2e08d2d8e89302c729b244e302bbc39c5b5dde42306ff003\",\r\n                \"sha256:d5e5be93e1714a59a535bbbc086b9e4fd2448c7547c5288548f6fd86353cad9e\",\r\n                \"sha256:de5806be66c9108e4dcdaced084e8ceae14100aa559e2d57b4f0cceb98c462de\",\r\n                \"sha256:f49755684a963731479ff3035d45a8185545b4c9f662d368bd349c419839886d\",\r\n                \"sha256:fc712a90401bcbf3fa25747f189d6dcfccbecc32712701cad25c6355589dac57\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.6'\",\r\n            \"version\": \"==22.1.0\"\r\n        },\r\n        \"six\": {\r\n            \"hashes\": [\r\n                \"sha256:1e61c37477a1626458e36f7b1d82aa5c9b094fa4802892072e49de9c60c4c926\",\r\n                \"sha256:8abb2f1d86890a2dfb989f9a77cfcfd3e47c2a354b01111771326f8aa26e0254\"\r\n            ],\r\n            \"markers\": \"python_version >= '2.7' and python_version not in '3.0, 3.1, 3.2, 3.3'\",\r\n            \"version\": \"==1.16.0\"\r\n        },\r\n        \"tabulate\": {\r\n            \"hashes\": [\r\n                \"sha256:d7c013fe7abbc5e491394e10fa845f8f32fe54f8dc60c6622c6cf482d25d47e4\",\r\n                \"sha256:eb1d13f25760052e8931f2ef80aaf6045a6cceb47514db8beab24cded16f13a7\"\r\n            ],\r\n            \"index\": \"pypi\",\r\n            \"version\": \"==0.8.9\"\r\n        },\r\n        \"tornado\": {\r\n            \"hashes\": [\r\n                \"sha256:0a00ff4561e2929a2c37ce706cb8233b7907e0cdc22eab98888aca5dd3775feb\",\r\n                \"sha256:0d321a39c36e5f2c4ff12b4ed58d41390460f798422c4504e09eb5678e09998c\",\r\n                \"sha256:1e8225a1070cd8eec59a996c43229fe8f95689cb16e552d130b9793cb570a288\",\r\n                \"sha256:20241b3cb4f425e971cb0a8e4ffc9b0a861530ae3c52f2b0434e6c1b57e9fd95\",\r\n                \"sha256:25ad220258349a12ae87ede08a7b04aca51237721f63b1808d39bdb4b2164558\",\r\n                \"sha256:33892118b165401f291070100d6d09359ca74addda679b60390b09f8ef325ffe\",\r\n                \"sha256:33c6e81d7bd55b468d2e793517c909b139960b6c790a60b7991b9b6b76fb9791\",\r\n                \"sha256:3447475585bae2e77ecb832fc0300c3695516a47d46cefa0528181a34c5b9d3d\",\r\n                \"sha256:34ca2dac9e4d7afb0bed4677512e36a52f09caa6fded70b4e3e1c89dbd92c326\",\r\n                \"sha256:3e63498f680547ed24d2c71e6497f24bca791aca2fe116dbc2bd0ac7f191691b\",\r\n                \"sha256:548430be2740e327b3fe0201abe471f314741efcb0067ec4f2d7dcfb4825f3e4\",\r\n                \"sha256:6196a5c39286cc37c024cd78834fb9345e464525d8991c21e908cc046d1cc02c\",\r\n                \"sha256:61b32d06ae8a036a6607805e6720ef00a3c98207038444ba7fd3d169cd998910\",\r\n                \"sha256:6286efab1ed6e74b7028327365cf7346b1d777d63ab30e21a0f4d5b275fc17d5\",\r\n                \"sha256:65d98939f1a2e74b58839f8c4dab3b6b3c1ce84972ae712be02845e65391ac7c\",\r\n                \"sha256:66324e4e1beede9ac79e60f88de548da58b1f8ab4b2f1354d8375774f997e6c0\",\r\n                \"sha256:6c77c9937962577a6a76917845d06af6ab9197702a42e1346d8ae2e76b5e3675\",\r\n                \"sha256:70dec29e8ac485dbf57481baee40781c63e381bebea080991893cd297742b8fd\",\r\n                \"sha256:7250a3fa399f08ec9cb3f7b1b987955d17e044f1ade821b32e5f435130250d7f\",\r\n                \"sha256:748290bf9112b581c525e6e6d3820621ff020ed95af6f17fedef416b27ed564c\",\r\n                \"sha256:7da13da6f985aab7f6f28debab00c67ff9cbacd588e8477034c0652ac141feea\",\r\n                \"sha256:8f959b26f2634a091bb42241c3ed8d3cedb506e7c27b8dd5c7b9f745318ddbb6\",\r\n                \"sha256:9de9e5188a782be6b1ce866e8a51bc76a0fbaa0e16613823fc38e4fc2556ad05\",\r\n                \"sha256:a48900ecea1cbb71b8c71c620dee15b62f85f7c14189bdeee54966fbd9a0c5bd\",\r\n                \"sha256:b87936fd2c317b6ee08a5741ea06b9d11a6074ef4cc42e031bc6403f82a32575\",\r\n                \"sha256:c77da1263aa361938476f04c4b6c8916001b90b2c2fdd92d8d535e1af48fba5a\",\r\n                \"sha256:cb5ec8eead331e3bb4ce8066cf06d2dfef1bfb1b2a73082dfe8a161301b76e37\",\r\n                \"sha256:cc0ee35043162abbf717b7df924597ade8e5395e7b66d18270116f8745ceb795\",\r\n                \"sha256:d14d30e7f46a0476efb0deb5b61343b1526f73ebb5ed84f23dc794bdb88f9d9f\",\r\n                \"sha256:d371e811d6b156d82aa5f9a4e08b58debf97c302a35714f6f45e35139c332e32\",\r\n                \"sha256:d3d20ea5782ba63ed13bc2b8c291a053c8d807a8fa927d941bd718468f7b950c\",\r\n                \"sha256:d3f7594930c423fd9f5d1a76bee85a2c36fd8b4b16921cae7e965f22575e9c01\",\r\n                \"sha256:dcef026f608f678c118779cd6591c8af6e9b4155c44e0d1bc0c87c036fb8c8c4\",\r\n                \"sha256:e0791ac58d91ac58f694d8d2957884df8e4e2f6687cdf367ef7eb7497f79eaa2\",\r\n                \"sha256:e385b637ac3acaae8022e7e47dfa7b83d3620e432e3ecb9a3f7f58f150e50921\",\r\n                \"sha256:e519d64089b0876c7b467274468709dadf11e41d65f63bba207e04217f47c085\",\r\n                \"sha256:e7229e60ac41a1202444497ddde70a48d33909e484f96eb0da9baf8dc68541df\",\r\n                \"sha256:ed3ad863b1b40cd1d4bd21e7498329ccaece75db5a5bf58cd3c9f130843e7102\",\r\n                \"sha256:f0ba29bafd8e7e22920567ce0d232c26d4d47c8b5cf4ed7b562b5db39fa199c5\",\r\n                \"sha256:fa2ba70284fa42c2a5ecb35e322e68823288a4251f9ba9cc77be04ae15eada68\",\r\n                \"sha256:fba85b6cd9c39be262fcd23865652920832b61583de2a2ca907dbd8e8a8c81e5\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.5'\",\r\n            \"version\": \"==6.1\"\r\n        },\r\n        \"traitlets\": {\r\n            \"hashes\": [\r\n                \"sha256:178f4ce988f69189f7e523337a3e11d91c786ded9360174a3d9ca83e79bc5396\",\r\n                \"sha256:69ff3f9d5351f31a7ad80443c2674b7099df13cc41fc5fa6e2f6d3b0330b0426\"\r\n            ],\r\n            \"markers\": \"python_version >= '3.7'\",\r\n            \"version\": \"==5.0.5\"\r\n        },\r\n        \"wcwidth\": {\r\n            \"hashes\": [\r\n                \"sha256:beb4802a9cebb9144e99086eff703a642a13d6a0052920003a230f3294bbe784\",\r\n                \"sha256:c4d647b99872929fdb7bdcaa4fbe7f01413ed3d98077df798530e5b04f116c83\"\r\n            ],\r\n            \"version\": \"==0.2.5\"\r\n        }\r\n    },\r\n    \"develop\": {}\r\n}\r\n\r\n```\r\n</details>\r\n\r\n", "comments": ["@Anthonyive \r\nPlease refer to this [link](https://stackoverflow.com/questions/48720833/could-not-find-a-version-that-satisfies-the-requirement-tensorflow) and let us know. [is your python 64 bits]", "@Saduf2019 \r\n\r\nI saw that question and I'm using 64-bit Python 3.8. I also tried 3.6 and 3.7. They didn't work too :(.\r\n\r\n```bash\r\n~/test/Python                                                 \ue73c Python-8ynjZ1Aj\r\n\u276f python -c 'import sys;print(\"%x\" % sys.maxsize, sys.maxsize > 2**32)'\r\n7fffffffffffffff True\r\n\r\n~/test/Python                                                 \ue73c Python-8ynjZ1Aj\r\n\u276f python --version\r\nPython 3.8.10\r\n```", "It can be installed using `pip`. However, `pipenv` can install but it can't lock dependencies.", "@Anthonyive \r\nPlease refer to this [link](https://stackoverflow.com/questions/59277637/installing-tensorflow-with-pipenv-gives-error/60791427#60791427) and let us know. [Can you please confirm if you are trying to install in virtualenv?]", "Yes I was installing in a virtual env.", "There's still an error...It still can't resolve dependencies\r\n\r\n```bash\r\n~/test/Python                                                                3s\r\n\u276f rm Pipfile*\r\n\r\n~/test/Python\r\n\u276f ls\r\n\uf15c d.txt  \uf1c3 descriptions.csv  \uf016 dotfiles.tsv  \ue606 Untitled.ipynb\r\n```\r\n\r\n```bash\r\n~/test/Python\r\n\u276f pipenv --python 3.7\r\nCreating a virtualenv for this project...\r\nPipfile: /Users/anthony/test/Python/Pipfile\r\nUsing /Users/anthony/.pyenv/versions/3.7.10/bin/python3.7m (3.7.10) to create virtualenv...\r\n\u2827 Creating virtual environment...created virtual environment CPython3.7.10.final.0-64 in 454ms\r\n  creator CPython3Posix(dest=/Users/anthony/.local/share/virtualenvs/Python-8ynjZ1Aj, clear=False, no_vcs_ignore=False, global=False)\r\n  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/Users/anthony/Library/Application Support/virtualenv)\r\n    added seed packages: pip==21.1.2, setuptools==57.0.0, wheel==0.36.2\r\n  activators BashActivator,CShellActivator,FishActivator,PowerShellActivator,PythonActivator,XonshActivator\r\n\r\n\u2714 Successfully created virtual environment!\r\nVirtualenv location: /Users/anthony/.local/share/virtualenvs/Python-8ynjZ1Aj\r\nCreating a Pipfile for this project...\r\n\r\n~/test/Python\r\n\u276f cat Pipfile\r\n\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n     \u2502 File: Pipfile\r\n\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n   1 \u2502 [[source]]\r\n   2 \u2502 url = \"https://pypi.org/simple\"\r\n   3 \u2502 verify_ssl = true\r\n   4 \u2502 name = \"pypi\"\r\n   5 \u2502\r\n   6 \u2502 [packages]\r\n   7 \u2502\r\n   8 \u2502 [dev-packages]\r\n   9 \u2502\r\n  10 \u2502 [requires]\r\n  11 \u2502 python_version = \"3.7\"\r\n\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n```\r\n\r\n```bash\r\n~/test/Python\r\n\u276f pipenv install --dev\r\nPipfile.lock not found, creating...\r\nLocking [dev-packages] dependencies...\r\nLocking [packages] dependencies...\r\nUpdated Pipfile.lock (a65489)!\r\nInstalling dependencies from Pipfile.lock (a65489)...\r\n  \ud83d\udc0d   \u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589\u2589 0/0 \u2014 00:00:00\r\nTo activate this project's virtualenv, run pipenv shell.\r\nAlternatively, run a command inside the virtualenv with pipenv run.\r\n```\r\n\r\n```bash\r\n~/test/Python\r\n\u276f pipenv install tensorflow\r\nInstalling tensorflow...\r\nAdding tensorflow to Pipfile's [packages]...\r\n\u2714 Installation Succeeded\r\nPipfile.lock (a65489) out of date, updating to (6e6c4e)...\r\nLocking [dev-packages] dependencies...\r\nLocking [packages] dependencies...\r\nBuilding requirements...\r\nResolving dependencies...\r\n\u2718 Locking Failed!\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 741, in _main\r\n[ResolutionFailure]:       resolve_packages(pre, clear, verbose, system, write, requirements_dir, packages, dev)\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 709, in resolve_packages\r\n[ResolutionFailure]:       requirements_dir=requirements_dir,\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/resolver.py\", line 692, in resolve\r\n[ResolutionFailure]:       req_dir=requirements_dir\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 1405, in resolve_deps\r\n[ResolutionFailure]:       req_dir=req_dir,\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 1110, in actually_resolve_deps\r\n[ResolutionFailure]:       resolver.resolve()\r\n[ResolutionFailure]:   File \"/Users/anthony/.local/pipx/venvs/pipenv/lib/python3.8/site-packages/pipenv/utils.py\", line 835, in resolve\r\n[ResolutionFailure]:       raise ResolutionFailure(message=str(e))\r\n[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.\r\n  First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.\r\n Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.\r\n  Hint: try $ pipenv lock --pre if it is a pre-release dependency.\r\nERROR: Could not find a version that matches tensorflow (from -r /var/folders/28/2sy26r512hq5jdpx18q4ycjw0000gn/T/pipenv25in37_brequirements/pipenv-7v0vn5_1-constraints.txt (line 2))\r\nNo versions found\r\nWas https://pypi.org/simple reachable?\r\n```", "In addition, the dependency graph looks like this:\r\n\r\n```bash\r\n~/test/Python                                                             \u2718 INT\r\n\u276f pipenv graph\r\ntensorflow==2.5.0\r\n  - absl-py [required: ~=0.10, installed: 0.13.0]\r\n    - six [required: Any, installed: 1.15.0]\r\n  - astunparse [required: ~=1.6.3, installed: 1.6.3]\r\n    - six [required: >=1.6.1,<2.0, installed: 1.15.0]\r\n    - wheel [required: >=0.23.0,<1.0, installed: 0.36.2]\r\n  - flatbuffers [required: ~=1.12.0, installed: 1.12]\r\n  - gast [required: ==0.4.0, installed: 0.4.0]\r\n  - google-pasta [required: ~=0.2, installed: 0.2.0]\r\n    - six [required: Any, installed: 1.15.0]\r\n  - grpcio [required: ~=1.34.0, installed: 1.34.1]\r\n    - six [required: >=1.5.2, installed: 1.15.0]\r\n  - h5py [required: ~=3.1.0, installed: 3.1.0]\r\n    - cached-property [required: Any, installed: 1.5.2]\r\n    - numpy [required: >=1.14.5, installed: 1.19.5]\r\n  - keras-nightly [required: ~=2.5.0.dev, installed: 2.5.0.dev2021032900]\r\n  - keras-preprocessing [required: ~=1.1.2, installed: 1.1.2]\r\n    - numpy [required: >=1.9.1, installed: 1.19.5]\r\n    - six [required: >=1.9.0, installed: 1.15.0]\r\n  - numpy [required: ~=1.19.2, installed: 1.19.5]\r\n  - opt-einsum [required: ~=3.3.0, installed: 3.3.0]\r\n    - numpy [required: >=1.7, installed: 1.19.5]\r\n  - protobuf [required: >=3.9.2, installed: 3.17.3]\r\n    - six [required: >=1.9, installed: 1.15.0]\r\n  - six [required: ~=1.15.0, installed: 1.15.0]\r\n  - tensorboard [required: ~=2.5, installed: 2.5.0]\r\n    - absl-py [required: >=0.4, installed: 0.13.0]\r\n      - six [required: Any, installed: 1.15.0]\r\n    - google-auth [required: >=1.6.3,<2, installed: 1.32.0]\r\n      - cachetools [required: >=2.0.0,<5.0, installed: 4.2.2]\r\n      - pyasn1-modules [required: >=0.2.1, installed: 0.2.8]\r\n        - pyasn1 [required: >=0.4.6,<0.5.0, installed: 0.4.8]\r\n      - rsa [required: >=3.1.4,<5, installed: 4.7.2]\r\n        - pyasn1 [required: >=0.1.3, installed: 0.4.8]\r\n      - setuptools [required: >=40.3.0, installed: 57.0.0]\r\n      - six [required: >=1.9.0, installed: 1.15.0]\r\n    - google-auth-oauthlib [required: >=0.4.1,<0.5, installed: 0.4.4]\r\n      - google-auth [required: >=1.0.0, installed: 1.32.0]\r\n        - cachetools [required: >=2.0.0,<5.0, installed: 4.2.2]\r\n        - pyasn1-modules [required: >=0.2.1, installed: 0.2.8]\r\n          - pyasn1 [required: >=0.4.6,<0.5.0, installed: 0.4.8]\r\n        - rsa [required: >=3.1.4,<5, installed: 4.7.2]\r\n          - pyasn1 [required: >=0.1.3, installed: 0.4.8]\r\n        - setuptools [required: >=40.3.0, installed: 57.0.0]\r\n        - six [required: >=1.9.0, installed: 1.15.0]\r\n      - requests-oauthlib [required: >=0.7.0, installed: 1.3.0]\r\n        - oauthlib [required: >=3.0.0, installed: 3.1.1]\r\n        - requests [required: >=2.0.0, installed: 2.25.1]\r\n          - certifi [required: >=2017.4.17, installed: 2021.5.30]\r\n          - chardet [required: >=3.0.2,<5, installed: 4.0.0]\r\n          - idna [required: >=2.5,<3, installed: 2.10]\r\n          - urllib3 [required: >=1.21.1,<1.27, installed: 1.26.5]\r\n    - grpcio [required: >=1.24.3, installed: 1.34.1]\r\n      - six [required: >=1.5.2, installed: 1.15.0]\r\n    - markdown [required: >=2.6.8, installed: 3.3.4]\r\n      - importlib-metadata [required: Any, installed: 4.5.0]\r\n        - typing-extensions [required: >=3.6.4, installed: 3.7.4.3]\r\n        - zipp [required: >=0.5, installed: 3.4.1]\r\n    - numpy [required: >=1.12.0, installed: 1.19.5]\r\n    - protobuf [required: >=3.6.0, installed: 3.17.3]\r\n      - six [required: >=1.9, installed: 1.15.0]\r\n    - requests [required: >=2.21.0,<3, installed: 2.25.1]\r\n      - certifi [required: >=2017.4.17, installed: 2021.5.30]\r\n      - chardet [required: >=3.0.2,<5, installed: 4.0.0]\r\n      - idna [required: >=2.5,<3, installed: 2.10]\r\n      - urllib3 [required: >=1.21.1,<1.27, installed: 1.26.5]\r\n    - setuptools [required: >=41.0.0, installed: 57.0.0]\r\n    - tensorboard-data-server [required: >=0.6.0,<0.7.0, installed: 0.6.1]\r\n    - tensorboard-plugin-wit [required: >=1.6.0, installed: 1.8.0]\r\n    - werkzeug [required: >=0.11.15, installed: 2.0.1]\r\n    - wheel [required: >=0.26, installed: 0.36.2]\r\n  - tensorflow-estimator [required: >=2.5.0rc0,<2.6.0, installed: 2.5.0]\r\n  - termcolor [required: ~=1.1.0, installed: 1.1.0]\r\n  - typing-extensions [required: ~=3.7.4, installed: 3.7.4.3]\r\n  - wheel [required: ~=0.35, installed: 0.36.2]\r\n  - wrapt [required: ~=1.12.1, installed: 1.12.1]\r\n```", "Is it due to my installation of `Pipenv`? This is my first time installing it with `pipx` [pipenv doc](https://pipenv.pypa.io/en/latest/install/#isolated-installation-of-pipenv-with-pipx). \r\n\r\nPreviously, I installed `Pipenv` with `brew` even though it's discouraged now. brew's Pipenv was fine. I'm not sure.", "@Anthonyive \r\nPlease confirm if you followed the steps in the link.\r\nalso check [this](https://github.com/tensorflow/tensorflow/issues/45669#issuecomment-744703654).", "@Saduf2019 I tried all the links you sent me. They all didn't work. \r\n\r\nIn addition, I also tried them on my Linux machine and it fails too. So I think it might not be just me...\r\n\r\n<details><summary>pipenv output</summary>\r\n\r\n```bash\r\n[anthony][anthony-mint][~/Downloads/test]\r\n$ pipenv --version\r\npipenv, version 2021.5.29\r\n[anthony][anthony-mint][~/Downloads/test]\r\n$ pipenv --python 3.7\r\nCreating a virtualenv for this project...\r\nPipfile: /home/anthony/Downloads/test/Pipfile\r\nUsing /usr/bin/python3.7m (3.7.10) to create virtualenv...\r\n\u283c Creating virtual environment...created virtual environment CPython3.7.10.final.0-64 in 222ms\r\n  creator CPython3Posix(dest=/home/anthony/.local/share/virtualenvs/test-kTWr83CV, clear=False, global=False)\r\n  seeder FromAppData(download=False, pip=latest, setuptools=latest, wheel=latest, pkg_resources=latest, via=copy, app_data_dir=/home/anthony/.local/share/virtualenv/seed-app-data/v1.0.1.debian.1)\r\n  activators BashActivator,CShellActivator,FishActivator,PowerShellActivator,PythonActivator,XonshActivator\r\n\r\n\u2714 Successfully created virtual environment! \r\nVirtualenv location: /home/anthony/.local/share/virtualenvs/test-kTWr83CV\r\nCreating a Pipfile for this project...\r\n[anthony][anthony-mint][~/Downloads/test]\r\n$ ls\r\nPipfile\r\n[anthony][anthony-mint][~/Downloads/test]\r\n$ pipenv install tensorflow\r\nInstalling tensorflow...\r\nAdding tensorflow to Pipfile's [packages]...\r\n\u2714 Installation Succeeded \r\nPipfile.lock not found, creating...\r\nLocking [dev-packages] dependencies...\r\nLocking [packages] dependencies...\r\nBuilding requirements...\r\nResolving dependencies...\r\n\u2718 Locking Failed! \r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/resolver.py\", line 741, in _main\r\n[ResolutionFailure]:       resolve_packages(pre, clear, verbose, system, write, requirements_dir, packages, dev)\r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/resolver.py\", line 709, in resolve_packages\r\n[ResolutionFailure]:       requirements_dir=requirements_dir,\r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/resolver.py\", line 692, in resolve\r\n[ResolutionFailure]:       req_dir=requirements_dir\r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/utils.py\", line 1405, in resolve_deps\r\n[ResolutionFailure]:       req_dir=req_dir,\r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/utils.py\", line 1110, in actually_resolve_deps\r\n[ResolutionFailure]:       resolver.resolve()\r\n[ResolutionFailure]:   File \"/home/anthony/.local/lib/python3.7/site-packages/pipenv/utils.py\", line 835, in resolve\r\n[ResolutionFailure]:       raise ResolutionFailure(message=str(e))\r\n[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.\r\n  First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.\r\n Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.\r\n  Hint: try $ pipenv lock --pre if it is a pre-release dependency.\r\nERROR: Could not find a version that matches keras-nightly~=2.5.0.dev (from tensorflow==2.5.0->-r /tmp/pipenvvrjoqdkirequirements/pipenv-o99dvgj8-constraints.txt (line 2))\r\nSkipped pre-versions: 2.5.0.dev2021020510, 2.5.0.dev2021020600, 2.5.0.dev2021020700, 2.5.0.dev2021020800, 2.5.0.dev2021020900, 2.5.0.dev2021021000, 2.5.0.dev2021021100, 2.5.0.dev2021021200, 2.5.0.dev2021021300, 2.5.0.dev2021021400, 2.5.0.dev2021021500, 2.5.0.dev2021021600, 2.5.0.dev2021021700, 2.5.0.dev2021021800, 2.5.0.dev2021021900, 2.5.0.dev2021022000, 2.5.0.dev2021022100, 2.5.0.dev2021022200, 2.5.0.dev2021022300, 2.5.0.dev2021022317, 2.5.0.dev2021022400, 2.5.0.dev2021022411, 2.5.0.dev2021022500, 2.5.0.dev2021022600, 2.5.0.dev2021022700, 2.5.0.dev2021022800, 2.5.0.dev2021030100, 2.5.0.dev2021030200, 2.5.0.dev2021030300, 2.5.0.dev2021030400, 2.5.0.dev2021030500, 2.5.0.dev2021030600, 2.5.0.dev2021030700, 2.5.0.dev2021030800, 2.5.0.dev2021030900, 2.5.0.dev2021031000, 2.5.0.dev2021031100, 2.5.0.dev2021031200, 2.5.0.dev2021031300, 2.5.0.dev2021031400, 2.5.0.dev2021031500, 2.5.0.dev2021031600, 2.5.0.dev2021031700, 2.5.0.dev2021031800, 2.5.0.dev2021032213, 2.5.0.dev2021032300, 2.5.0.dev2021032413, 2.5.0.dev2021032500, 2.5.0.dev2021032600, 2.5.0.dev2021032610, 2.5.0.dev2021032700, 2.5.0.dev2021032800, 2.5.0.dev2021032900, 2.6.0.dev2021033000, 2.6.0.dev2021033100, 2.6.0.dev2021040100, 2.6.0.dev2021040200, 2.6.0.dev2021040300, 2.6.0.dev2021040400, 2.6.0.dev2021040500, 2.6.0.dev2021040600, 2.6.0.dev2021040714, 2.6.0.dev2021040800, 2.6.0.dev2021040900, 2.6.0.dev2021041000, 2.6.0.dev2021041100, 2.6.0.dev2021041200, 2.6.0.dev2021041300, 2.6.0.dev2021041400, 2.6.0.dev2021041500, 2.6.0.dev2021041600, 2.6.0.dev2021041700, 2.6.0.dev2021041800, 2.6.0.dev2021041900, 2.6.0.dev2021042000, 2.6.0.dev2021042100, 2.6.0.dev2021042200, 2.6.0.dev2021042300, 2.6.0.dev2021042500, 2.6.0.dev2021042600, 2.6.0.dev2021042700, 2.6.0.dev2021042800, 2.6.0.dev2021042900, 2.6.0.dev2021043000, 2.6.0.dev2021050100, 2.6.0.dev2021050200, 2.6.0.dev2021050300, 2.6.0.dev2021050400, 2.6.0.dev2021050500, 2.6.0.dev2021050600, 2.6.0.dev2021051200, 2.6.0.dev2021051300, 2.6.0.dev2021051400, 2.6.0.dev2021051500, 2.6.0.dev2021051600, 2.6.0.dev2021051700, 2.6.0.dev2021051800, 2.6.0.dev2021051900, 2.6.0.dev2021052000, 2.6.0.dev2021052100, 2.6.0.dev2021052200, 2.6.0.dev2021052300, 2.6.0.dev2021052400, 2.6.0.dev2021052500, 2.6.0.dev2021052600, 2.6.0.dev2021052700, 2.6.0.dev2021060400, 2.6.0.dev2021060500, 2.6.0.dev2021060600, 2.6.0.dev2021060700, 2.6.0.dev2021060800, 2.6.0.dev2021060900, 2.6.0.dev2021061000, 2.6.0.dev2021061200, 2.6.0.dev2021061300, 2.6.0.dev2021061400, 2.6.0.dev2021061500, 2.6.0.dev2021061600, 2.6.0.dev2021061700, 2.6.0.dev2021061800, 2.6.0.dev2021061900, 2.6.0.dev2021062000, 2.6.0.dev2021062100, 2.6.0.dev2021062200, 2.6.0.dev2021062300, 2.6.0.dev2021062400\r\nThere are incompatible versions in the resolved dependencies:\r\n\r\n```\r\n</details>\r\n\r\n<details><summary>$ pipenv --support</summary>\r\n\r\nPipenv version: `'2021.5.29'`\r\n\r\nPipenv location: `'/home/anthony/.local/lib/python3.7/site-packages/pipenv'`\r\n\r\nPython location: `'/usr/bin/python3.7'`\r\n\r\nPython installations found:\r\n\r\n  - `3.9.5`: `/usr/bin/python3.9`\r\n  - `3.9.5`: `/bin/python3.9`\r\n  - `3.8.5`: `/usr/bin/python3.8`\r\n  - `3.8.5`: `/usr/bin/python3`\r\n  - `3.8.5`: `/bin/python3.8`\r\n  - `3.8.5`: `/bin/python3`\r\n  - `3.7.10`: `/usr/bin/python3.7`\r\n  - `3.7.10`: `/usr/bin/python3.7m`\r\n  - `3.7.10`: `/bin/python3.7`\r\n  - `3.7.10`: `/bin/python3.7m`\r\n  - `2.7.18`: `/usr/bin/python2.7`\r\n  - `2.7.18`: `/usr/bin/python2`\r\n  - `2.7.18`: `/bin/python2.7`\r\n  - `2.7.18`: `/bin/python2`\r\n\r\nPEP 508 Information:\r\n\r\n```\r\n{'implementation_name': 'cpython',\r\n 'implementation_version': '3.7.10',\r\n 'os_name': 'posix',\r\n 'platform_machine': 'x86_64',\r\n 'platform_python_implementation': 'CPython',\r\n 'platform_release': '5.4.0-73-generic',\r\n 'platform_system': 'Linux',\r\n 'platform_version': '#82-Ubuntu SMP Wed Apr 14 17:39:42 UTC 2021',\r\n 'python_full_version': '3.7.10',\r\n 'python_version': '3.7',\r\n 'sys_platform': 'linux'}\r\n```\r\n\r\nSystem environment variables:\r\n\r\n  - `SHELL`\r\n  - `LSCOLORS`\r\n  - `SESSION_MANAGER`\r\n  - `QT_ACCESSIBILITY`\r\n  - `COLORTERM`\r\n  - `XDG_CONFIG_DIRS`\r\n  - `LESS`\r\n  - `XDG_SESSION_PATH`\r\n  - `GNOME_DESKTOP_SESSION_ID`\r\n  - `GTK_IM_MODULE`\r\n  - `LANGUAGE`\r\n  - `TRICK_CXXFLAGS`\r\n  - `QT4_IM_MODULE`\r\n  - `MANDATORY_PATH`\r\n  - `SSH_AUTH_SOCK`\r\n  - `CINNAMON_VERSION`\r\n  - `XMODIFIERS`\r\n  - `DESKTOP_SESSION`\r\n  - `SSH_AGENT_PID`\r\n  - `OSH`\r\n  - `GTK_MODULES`\r\n  - `XDG_SEAT`\r\n  - `PWD`\r\n  - `LOGNAME`\r\n  - `XDG_SESSION_DESKTOP`\r\n  - `QT_QPA_PLATFORMTHEME`\r\n  - `XDG_SESSION_TYPE`\r\n  - `TRICK_CFLAGS`\r\n  - `GPG_AGENT_INFO`\r\n  - `XAUTHORITY`\r\n  - `XDG_GREETER_DATA_DIR`\r\n  - `GJS_DEBUG_TOPICS`\r\n  - `GDM_LANG`\r\n  - `HOME`\r\n  - `LANG`\r\n  - `LS_COLORS`\r\n  - `XDG_CURRENT_DESKTOP`\r\n  - `VTE_VERSION`\r\n  - `XDG_SEAT_PATH`\r\n  - `GNOME_TERMINAL_SCREEN`\r\n  - `COMP_WORDBREAKS`\r\n  - `CLUTTER_IM_MODULE`\r\n  - `GJS_DEBUG_OUTPUT`\r\n  - `GEM_HOME`\r\n  - `LESSCLOSE`\r\n  - `XDG_SESSION_CLASS`\r\n  - `TERM`\r\n  - `GTK_OVERLAY_SCROLLING`\r\n  - `DEFAULTS_PATH`\r\n  - `LESSOPEN`\r\n  - `MYSQL_PS1`\r\n  - `USER`\r\n  - `GNOME_TERMINAL_SERVICE`\r\n  - `DISPLAY`\r\n  - `SHLVL`\r\n  - `PAGER`\r\n  - `QT_IM_MODULE`\r\n  - `XDG_VTNR`\r\n  - `XDG_SESSION_ID`\r\n  - `LD_LIBRARY_PATH`\r\n  - `LC_CTYPE`\r\n  - `XDG_RUNTIME_DIR`\r\n  - `GTK3_MODULES`\r\n  - `XDG_DATA_DIRS`\r\n  - `PATH`\r\n  - `HISTIGNORE`\r\n  - `GDMSESSION`\r\n  - `DBUS_SESSION_BUS_ADDRESS`\r\n  - `OLDPWD`\r\n  - `_`\r\n  - `PIP_DISABLE_PIP_VERSION_CHECK`\r\n  - `PYTHONDONTWRITEBYTECODE`\r\n  - `PIP_SHIMS_BASE_MODULE`\r\n  - `PIP_PYTHON_PATH`\r\n  - `PYTHONFINDER_IGNORE_UNSUPPORTED`\r\n\r\nPipenv\u2013specific environment variables:\r\n\r\n\r\nDebug\u2013specific environment variables:\r\n\r\n  - `PATH`: `/home/anthony/gems/bin:/home/anthony/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin`\r\n  - `SHELL`: `/bin/bash`\r\n  - `LANG`: `en_US.UTF-8`\r\n  - `PWD`: `/home/anthony/Downloads/test`\r\n\r\n\r\n---------------------------\r\n\r\nContents of `Pipfile` ('/home/anthony/Downloads/test/Pipfile'):\r\n\r\n```toml\r\n[[source]]\r\nurl = \"https://pypi.org/simple\"\r\nverify_ssl = true\r\nname = \"pypi\"\r\n\r\n[packages]\r\ntensorflow = \"*\"\r\n\r\n[dev-packages]\r\n\r\n[requires]\r\npython_version = \"3.7\"\r\n\r\n```\r\n\r\n</details>\r\n", "@Saduf2019 Well actually, I can install it now on my Linux machine by using `pipenv install --pre tensorflow`. However, my Mac still can't install it with this command", "@Anthonyive \r\nCould you please let us know if this problem been there in the mac os on earlier versions of tf", "@Saduf2019 I tested 2.3, 2.4, and 2.5. They all failed for the same reason...", "hi @Anthonyive , Could you please look at [answer](https://github.com/pypa/pipenv/issues/2619#issuecomment-406744930) of this issue. Also please follow the steps for macos [here](https://www.tensorflow.org/install/source)", "@mohantym Thank you. This actually works! I'm using this `pipenv install --verbose https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-2.6.0-cp38-cp38-macosx_10_11_x86_64.whl`.\r\n\r\nDo you know why I can't simply `pipenv install tensorflow`?", "@Anthonyive  ,Please look at this[ comment](https://github.com/pypa/pipenv/issues/2619#issuecomment-410137778) for answer  , For further assistance, please create a new issue . Thanks!", "Thank you!", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50370\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50370\">No</a>\n", "@mohantym the linked comment describes this as an issue with tensorflow. Why do we need a new issue to track it?"]}, {"number": 50369, "title": " error C2664: \u201cbool tensorflow::`anonymous-namespace'", "body": "tensorflow/python/lib/core/bfloat16.cc(635): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(635): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\ntensorflow/python/lib/core/bfloat16.cc(639): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(639): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\ntensorflow/python/lib/core/bfloat16.cc(643): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(643): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\ntensorflow/python/lib/core/bfloat16.cc(646): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(646): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\ntensorflow/python/lib/core/bfloat16.cc(650): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(650): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\ntensorflow/python/lib/core/bfloat16.cc(654): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(654): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 1600.752s, Critical Path: 348.93s\r\nINFO: 566 processes: 566 local.\r\nFAILED: Build did NOT complete successfully\r\n", "comments": ["@XDSwang \r\nWe see that the issue [template](https://github.com/tensorflow/tensorflow/issues/new?assignees=&labels=type%3Abuild%2Finstall&template=10-build-installation-issue.md) has not been filled, could you please do so as it helps us analyse the issue .Thanks", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50369\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50369\">No</a>\n"]}, {"number": 50368, "title": "Dictionary learning using tensorflow", "body": "Hii, experts. I am looking for the implementation of dictionary learning using Tensorflow. Are there any API for the same.Please suggest.", "comments": ["@chiseo36 \r\nPlease go through this example [here](https://keras.io/examples/vision/metric_learning/), as metric learning is a form of dictionary learning.\r\nKindly move this issue to close status and in case of any further queries open an stackoverflow/tf discussion forum issue as this is not a bug or a feat request. ", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n"]}, {"number": 50367, "title": "Improved scikit-learn compatibility", "body": "When using a KerasRegressor / KerasClassifier inside a scikit-learn ensemble model (Voting/Stacking/Bagging), an error is raised because such model requires its base estimators to have the attribute `_estimator_type`, which can be either `\"regressor\"` or `\"classifier\"`. The addition fixes this issue.", "comments": ["@EdoardoBotta Thank you for the PR! would you please provide a colab notebook that reproduces the error?", "https://colab.research.google.com/drive/1mzbRXyWmTD6rqchfRPnf1uSGp0v5Zkij?usp=sharing", "We are planning to remove the sklearn API support in Keras.\r\nHere is an open-source replacement for this feature.\r\nhttps://github.com/adriangb/scikeras"]}, {"number": 50366, "title": "Add 'supported formats' to ValueError", "body": "While using ` tf.keras.preprocessing.image_dataset_from_directory ` I got a Value Error \"No images Found\". \r\nThat happened  because i had images in .ppm format, which is not supported (duh!..).  Wasted quite some time. So, to **clarify** I added a line about required image formats in `tensorflow/python/keras/preprocessing/image_dataset.py/image_dataset_from_directory`` raise ValueError`.\r\nSlicing is to get rid of brakets and make it look pretty.\r\n\r\np.s that's my first ever contribution.", "comments": ["\nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n\n:memo: **Please visit <https://cla.developers.google.com/> to sign.**\n\nOnce you've signed (or fixed any issues), please reply here with `@googlebot I signed it!` and we'll verify it.\n\n----\n\n#### What to do if you already signed the CLA\n\n##### Individual signers\n\n*   It's possible we don't have your GitHub username or you're using a different email address on your commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n\n##### Corporate signers\n\n*   Your company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to [go/cla#troubleshoot](http://go/cla#troubleshoot) ([Public version](https://opensource.google/docs/cla/#troubleshoot)).\n*   The email used to register you as an authorized contributor must be the email used for the Git commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).\n*   The email used to register you as an authorized contributor must also be [attached to your GitHub account](https://github.com/settings/emails).\n\t\t\n\n\u2139\ufe0f **Googlers: [Go here](https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fpull%2F50366) for more info**.\n\n<!-- need_sender_cla -->", "@googlebot I signed it!", "Thanks for the PR! This has been fixed separately. Please note that Keras development has moved to the repo keras-team/keras; going forward any PR should be directed there."]}, {"number": 50365, "title": "[WIP][MLIR][DISC] Add device type info to memref's address space in lmhlo dialect", "body": "We are porting our MLIR-based dynamic shape compiler to tf community (From OP def, Patttern, to Optimization pass, etc).\r\n\r\nThere will be 3 PRs to process memory allocation for dynamic shape. 1) Mark shape calculation Ops by Op attribute and insert D2H and H2D Op in mhlo dialect; 2) Add device type info to memref's address space in lmhlo dialect; 3) Convert for device alloc/dealloc with memref's address space.\r\n\r\nThis PR mainly is to add device type info to memref's address space in lmhlo dialect.\r\n\r\nRelated discussion is [here](https://llvm.discourse.group/t/placement-representation-in-tensor-world-buffer-world/3502/6).", "comments": ["@azazhu  Can you please check @joker-eph's comments and resolve conflicts?. Thanks!", "> @azazhu Can you please check @joker-eph's comments and resolve conflicts?. Thanks!\r\n\r\nSure,  there are 3 PRs about processing memory allocation for dynamic shape. I am now working on refining first one (This is second PR).", "@azazhu  Can you please check @sanjoy's comments and resolve conflicts?. Thanks!", "Sorry for late response, We are working on internal porting(to make sure final porting can e2e run) based on tot TF, which takes more time than we expected. We will continue updating this PR once internal verification finished.", "@azazhu  Any update on this PR? Please. Thanks!"]}, {"number": 50362, "title": "[Go] use GOOS to distinguish between platforms", "body": "Running `go generate` within `tensorflow/go/op` executes `tensorflow/go/genop/generate.sh` superfluously (twice). This is because `tensorflow/go/genop/generate.win.go` does not follow golang [build contraints](https://golang.org/pkg/go/build/#hdr-Build_Constraints) which, for file suffixes, require an underscore and the full OS name of `windows` (e.g., `generate_windows.go`).  Thus, `go generate` runs `tensorflow/go/genop/generate.go` and `tensorflow/go/genop/generate.win.go` on any platform.\r\n\r\nIt is more direct to remove the build constraint and instead distinguish between platforms within the shell script as `go env GOOS` provides the platform name.  This also allows the script to be called directly with GOOS set as an environment variable.", "comments": []}, {"number": 50361, "title": "my model can be loaded but when I send request to do the predict I got some errors", "body": "The error I got:\r\nFile \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 2447, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1952, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/usr/local/lib/python3.8/site-packages/flask_cors/extension.py\", line 165, in wrapped_function\r\n    return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1821, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/_compat.py\", line 39, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1950, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/app.py\", line 1936, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/usr/local/lib/python3.8/site-packages/simple_tensorflow_serving/server.py\", line 380, in decorated\r\n    return f(*decorator_args, **decorator_kwargs)\r\n  File \"/usr/local/lib/python3.8/site-packages/simple_tensorflow_serving/server.py\", line 180, in inference\r\n    response = jsonify(json_result)\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/json/__init__.py\", line 370, in jsonify\r\n    dumps(data, indent=indent, separators=separators) + \"\\n\",\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/json/__init__.py\", line 211, in dumps\r\n    rv = _json.dumps(obj, **kwargs)\r\n  File \"/usr/local/Cellar/python@3.8/3.8.5/Frameworks/Python.framework/Versions/3.8/lib/python3.8/json/__init__.py\", line 234, in dumps\r\n    return cls(\r\n  File \"/usr/local/Cellar/python@3.8/3.8.5/Frameworks/Python.framework/Versions/3.8/lib/python3.8/json/encoder.py\", line 199, in encode\r\n    chunks = self.iterencode(o, _one_shot=True)\r\n  File \"/usr/local/Cellar/python@3.8/3.8.5/Frameworks/Python.framework/Versions/3.8/lib/python3.8/json/encoder.py\", line 257, in iterencode\r\n    return _iterencode(o, 0)\r\n  File \"/usr/local/lib/python3.8/site-packages/flask/json/__init__.py\", line 100, in default\r\n    return _json.JSONEncoder.default(self, o)\r\n  File \"/usr/local/Cellar/python@3.8/3.8.5/Frameworks/Python.framework/Versions/3.8/lib/python3.8/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type bytes is not JSON serializable\r\n\r\n\r\nThe request:\r\n{\r\n  \"model_name\": \"default\",\r\n  \"model_version\": 1,\r\n  \"data\": {\r\n      \"inputs\":[\"\",\"\",\"\"]\r\n    }\r\n}\r\n\r\nI feel have difficulties to find the correct data structure, may I get some help from you?", "comments": []}, {"number": 50360, "title": "[MLIR][DISC] Add LhloFusionInliner Pass", "body": "This pass inlines the body contents of lmhlo.fusion_op. \r\nTypically it should work after the body has been lowered into loops. For disc, it works after LhloLegalizeRootsToParallelLoops &  InputInlineFusion in #50102 .", "comments": ["> I think you'll need a CMake change as well\r\n\r\nDone. Thanks, i missed it."]}, {"number": 50359, "title": "AttributeError: 'BinaryAccuracy' object has no attribute 'reset_state'", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Manjaro Linux 21.0.5 (Ornara)\r\n- TensorFlow installed from (source or binary): binary (using conda)\r\n- TensorFlow version (use command below): 2.4.1\r\n- Python version: 3.9.5\r\n- GCC/Compiler version (if compiling from source): python compiler version: GCC 7.5.0, (compiler section shows c++ (GCC) 10.2.0)\r\n- CUDA/cuDNN version: 11.2\r\n- GPU model and memory: Quadro K2200\r\n\r\nTested in another system:\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Fedora release 34\r\n- TensorFlow installed from (source or binary): binary (using conda)\r\n- TensorFlow version (use command below): 2.4.1\r\n- Python version: 3.9.5\r\n- GCC/Compiler version (if compiling from source): python compiler version: GCC 7.5.0, (compiler section shows c++ (GCC) 11.1.1)\r\n\r\n\r\n\r\n**Describe the current behavior**\r\n\r\n**`reset_state()` for `tf.keras.metrics.BinaryAccuracy` does not work.** \r\n\r\nMy current code:\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nm = tf.keras.metrics.BinaryAccuracy()\r\nm.update_state([[1], [1], [0], [0]], [[0.98], [1], [0], [0.6]])\r\nm.result().numpy()\r\n\r\nm.reset_state()\r\nm.update_state([[1], [1], [0], [0]], [[0.98], [1], [0], [0.6]], sample_weight=[1, 0, 0, 1])\r\nm.result().numpy()\r\n```\r\n\r\nAnd the corresponding result:\r\n\r\n```\r\n2021-06-18 22:33:53.388589: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set\r\n2021-06-18 22:33:53.388807: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA\r\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\r\n2021-06-18 22:33:53.390306: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.\r\nTraceback (most recent call last):\r\n  File \"/home/subrata/Researches/MRI/cGAN_2D_test_old/reset_test_problem.py\", line 8, in <module>\r\n    m.reset_state()\r\nAttributeError: 'BinaryAccuracy' object has no attribute 'reset_state'\r\n```\r\n\r\n**Describe the expected behavior**\r\nThe official [documentation](https://www.tensorflow.org/api_docs/python/tf/keras/metrics/BinaryAccuracy) shows that this code should basically give:\r\n```\r\n0.75\r\n0.5 \r\n```\r\n\r\n**[Contributing](https://www.tensorflow.org/community/contribute)**\r\n\r\n- Do you want to contribute a PR? (yes/no): no\r\n\r\n**Standalone code to reproduce the issue**\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nm = tf.keras.metrics.BinaryAccuracy()\r\nm.update_state([[1], [1], [0], [0]], [[0.98], [1], [0], [0.6]])\r\nm.result().numpy()\r\n\r\nm.reset_state()\r\nm.update_state([[1], [1], [0], [0]], [[0.98], [1], [0], [0.6]], sample_weight=[1, 0, 0, 1])\r\nm.result().numpy()\r\n```\r\n\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n\r\nThe existing versions managed by conda \r\n(generated using `conda list --export`,\r\nand virtual en can be generated using the channel `conda-forge`\r\n`conda create --name workingenv --file <following as a file>  -c conda-forge`)\r\n```\r\n# This file may be used to create an environment using:\r\n# $ conda create --name <env> --file <this file>\r\n# platform: linux-64\r\n_libgcc_mutex=0.1=main\r\n_openmp_mutex=4.5=1_gnu\r\n_tflow_select=2.3.0=mkl\r\nabsl-py=0.12.0=py39h06a4308_0\r\naiohttp=3.7.4=py39h27cfd23_1\r\nastor=0.8.1=py39h06a4308_0\r\nastunparse=1.6.3=py_0\r\nasync-timeout=3.0.1=py39h06a4308_0\r\nattrs=21.2.0=pyhd3eb1b0_0\r\nblas=1.0=mkl\r\nblinker=1.4=py39h06a4308_0\r\nbrotlipy=0.7.0=py39h27cfd23_1003\r\nc-ares=1.17.1=h27cfd23_0\r\nca-certificates=2021.5.25=h06a4308_1\r\ncachetools=4.2.2=pyhd3eb1b0_0\r\ncertifi=2021.5.30=py39h06a4308_0\r\ncffi=1.14.5=py39h261ae71_0\r\nchardet=3.0.4=py39h06a4308_1003\r\nclick=8.0.1=pyhd3eb1b0_0\r\ncoverage=5.5=py39h27cfd23_2\r\ncryptography=3.4.7=py39hd23ed53_0\r\ncycler=0.10.0=py39h06a4308_0\r\ncython=0.29.23=py39h2531618_0\r\ndbus=1.13.18=hb2f20db_0\r\nexpat=2.4.1=h2531618_2\r\nfontconfig=2.13.1=h6c09931_0\r\nfreetype=2.10.4=h5ab3b9f_0\r\ngast=0.4.0=py_0\r\nglib=2.68.2=h36276a3_0\r\ngoogle-auth=1.31.0=pyhd3eb1b0_0\r\ngoogle-auth-oauthlib=0.4.1=py_2\r\ngoogle-pasta=0.2.0=py_0\r\ngrpcio=1.36.1=py39h2157cd5_1\r\ngst-plugins-base=1.14.0=h8213a91_2\r\ngstreamer=1.14.0=h28cd5cc_2\r\nh5py=2.10.0=py39hec9cf62_0\r\nhdf5=1.10.6=hb1b8bf9_0\r\nicu=58.2=he6710b0_3\r\nidna=2.10=pyhd3eb1b0_0\r\nimportlib-metadata=3.10.0=py39h06a4308_0\r\nintel-openmp=2021.2.0=h06a4308_610\r\njpeg=9b=h024ee3a_2\r\nkeras=2.4.3=0\r\nkeras-base=2.4.3=py_0\r\nkeras-preprocessing=1.1.2=pyhd3eb1b0_0\r\nkiwisolver=1.3.1=py39h2531618_0\r\nlcms2=2.12=h3be6417_0\r\nld_impl_linux-64=2.35.1=h7274673_9\r\nlibffi=3.3=he6710b0_2\r\nlibgcc-ng=9.3.0=h5101ec6_17\r\nlibgfortran-ng=7.5.0=ha8ba4b0_17\r\nlibgfortran4=7.5.0=ha8ba4b0_17\r\nlibgomp=9.3.0=h5101ec6_17\r\nlibpng=1.6.37=hbc83047_0\r\nlibprotobuf=3.14.0=h8c45485_0\r\nlibstdcxx-ng=9.3.0=hd4cf53a_17\r\nlibtiff=4.2.0=h85742a9_0\r\nlibuuid=1.0.3=h1bed415_2\r\nlibwebp-base=1.2.0=h27cfd23_0\r\nlibxcb=1.14=h7b6447c_0\r\nlibxml2=2.9.10=hb55368b_3\r\nlz4-c=1.9.3=h2531618_0\r\nmarkdown=3.3.4=py39h06a4308_0\r\nmatplotlib=3.3.4=py39h06a4308_0\r\nmatplotlib-base=3.3.4=py39h62a2d02_0\r\nmkl=2021.2.0=h06a4308_296\r\nmkl-service=2.3.0=py39h27cfd23_1\r\nmkl_fft=1.3.0=py39h42c9631_2\r\nmkl_random=1.2.1=py39ha9443f7_2\r\nmultidict=5.1.0=py39h27cfd23_2\r\nncurses=6.2=he6710b0_1\r\nnibabel=3.2.1=pyhd8ed1ab_0\r\nnumpy=1.20.2=py39h2d18471_0\r\nnumpy-base=1.20.2=py39hfae3a4d_0\r\noauthlib=3.1.1=pyhd3eb1b0_0\r\nolefile=0.46=py_0\r\nopenssl=1.1.1k=h27cfd23_0\r\nopt_einsum=3.3.0=pyhd3eb1b0_1\r\npackaging=20.9=pyhd3eb1b0_0\r\npcre=8.44=he6710b0_0\r\npillow=8.2.0=py39he98fc37_0\r\npip=21.1.2=py39h06a4308_0\r\nprotobuf=3.14.0=py39h2531618_1\r\npyasn1=0.4.8=py_0\r\npyasn1-modules=0.2.8=py_0\r\npycparser=2.20=py_2\r\npydicom=2.1.2=pyhd3deb0d_0\r\npydot=1.2.4=py_0\r\npyjwt=2.1.0=py39h06a4308_0\r\npyopenssl=20.0.1=pyhd3eb1b0_1\r\npyparsing=2.4.7=pyhd3eb1b0_0\r\npyqt=5.9.2=py39h2531618_6\r\npysocks=1.7.1=py39h06a4308_0\r\npython=3.9.5=h12debd9_4\r\npython-dateutil=2.8.1=pyhd3eb1b0_0\r\npython-flatbuffers=1.12=pyhd3eb1b0_0\r\npyyaml=5.4.1=py39h27cfd23_1\r\nqt=5.9.7=h5867ecd_1\r\nreadline=8.1=h27cfd23_0\r\nrequests=2.25.1=pyhd3eb1b0_0\r\nrequests-oauthlib=1.3.0=py_0\r\nrsa=4.7.2=pyhd3eb1b0_1\r\nscipy=1.6.2=py39had2a1c9_1\r\nsetuptools=52.0.0=py39h06a4308_0\r\nsip=4.19.13=py39h2531618_0\r\nsix=1.16.0=pyhd3eb1b0_0\r\nsqlite=3.35.4=hdfb4753_0\r\ntensorboard=2.5.0=py_0\r\ntensorboard-plugin-wit=1.6.0=py_0\r\ntensorflow=2.4.1=mkl_py39h4683426_0\r\ntensorflow-base=2.4.1=mkl_py39h43e0292_0\r\ntensorflow-estimator=2.5.0=pyh7b7c402_0\r\ntermcolor=1.1.0=py39h06a4308_1\r\ntk=8.6.10=hbc83047_0\r\ntornado=6.1=py39h27cfd23_0\r\ntyping-extensions=3.7.4.3=hd3eb1b0_0\r\ntyping_extensions=3.7.4.3=pyh06a4308_0\r\ntzdata=2020f=h52ac0ba_0\r\nurllib3=1.26.4=pyhd3eb1b0_0\r\nwerkzeug=1.0.1=pyhd3eb1b0_0\r\nwheel=0.36.2=pyhd3eb1b0_0\r\nwrapt=1.12.1=py39he8ac12f_1\r\nxz=5.2.5=h7b6447c_0\r\nyaml=0.2.5=h7b6447c_0\r\nyarl=1.6.3=py39h27cfd23_0\r\nzipp=3.4.1=pyhd3eb1b0_0\r\nzlib=1.2.11=h7b6447c_3\r\nzstd=1.4.9=haebb681_0\r\n```\r\n\r\n\r\n", "comments": ["I see that there is a subtle difference in the usage of those functions -\r\n\r\nFor TF 2.4.1 you want to use `m.reset_states()`\r\nhttps://www.tensorflow.org/versions/r2.4/api_docs/python/tf/keras/metrics/BinaryAccuracy#reset_states\r\n\r\nTF 2.5.0 has `m.reset_state()`\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/metrics/BinaryAccuracy#reset_state", "Thank you, @ymodak. Your explanation worked. \r\nThese kinds of subtle changes are not always noticeable. \r\nHowever, to the programmers of TensorFlow, please keep these in mind while changing the functions for a different version. ", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50359\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50359\">No</a>\n"]}, {"number": 50358, "title": "How string tensor to numpy array float32?", "body": "tf.Tensor(\r\n[b'[ 0.02097283 -0.00030136  0.02027434  0.01413146 -0.05076262]'\r\n b'[ 0.0262014   0.06108821  0.02988876  0.02189768 -0.10167235]'\r\n b'[ 0.03268104 -0.006452   -0.02572624 -0.02183151 -0.0120374 ]'\r\n b'[ 0.05750999  0.03042973 -0.00485849  0.03983038  0.01241926]'\r\n b'[-0.05423493  0.03896134  0.08271325 -0.00260455 -0.0601045 ]'\r\n b'[-0.05363343  0.0085776   0.06006461 -0.04733948  0.03426042]'\r\n b'[-0.00538311 -0.03473232  0.05594373  0.02615744 -0.00020107]'\r\n b'[-0.09023542 -0.01520202  0.02594413  0.0152848   0.02993004]'\r\n b'[ 0.02597977  0.01155447 -0.03341909  0.01283126 -0.00788336]'\r\n b'[-0.0311645  -0.02193766  0.01195193 -0.00156491  0.02515437]'\r\n b'[-0.02063796 -0.02474995 -0.00826916 -0.07110358 -0.01128928]'\r\n b'[-0.02542101  0.01105374  0.06318881 -0.06937706 -0.01915297]'\r\n b'[-0.09416252  0.00973927  0.03317858  0.06058807 -0.04148066]'\r\n b'[-0.01365746  0.03451785  0.06412476  0.02822566 -0.00999724]'\r\n b'[-0.0171374   0.0715599   0.05882246  0.01296736 -0.00091868]'\r\n b'[ 0.00693085 -0.04560864  0.02032861 -0.04077329 -0.00946539]'\r\n b'[-0.06874597  0.04256656 -0.02906736  0.04013787  0.00206867]'\r\n b'[-0.01034078 -0.05094369  0.08312039 -0.00587852  0.01176884]'\r\n b'[-0.06719685  0.05213002  0.03297217 -0.01096502 -0.0350911 ]'\r\n b'[ 0.05109432  0.02179589  0.05981123  0.00137072 -0.03289427]'\r\n b'[ 0.00146687  0.06880862  0.05646181  0.02786043 -0.03881097]'\r\n b'[-0.02244576  0.0231379   0.06871274 -0.00127656 -0.0272399 ]'\r\n b'[-0.04374747 -0.06226141  0.13758671 -0.00678062 -0.03487266]'\r\n b'[-0.00418507  0.03274211  0.0689674  -0.05106321 -0.03625463]'\r\n b'[-0.03213548  0.00827215  0.00770648 -0.03131473 -0.01863099]'\r\n b'[ 0.06207936  0.00689174  0.10711489 -0.03350456  0.01081521]'\r\n b'[ 0.02757066 -0.0253685   0.12062814 -0.00970585  0.02902891]'\r\n b'[-0.02885368 -0.0160449   0.14081968  0.02503997 -0.00294884]'\r\n b'[ 0.07023901  0.05541587  0.02016265 -0.03657229  0.04771656]'\r\n b'[-0.0209682  -0.0051748   0.09555192  0.02832836 -0.08762222]'\r\n b'[-0.05938871  0.07186659  0.12110886 -0.02638434  0.00429018]'\r\n b'[-0.11481152 -0.04604804  0.11981387 -0.00891783 -0.02516906]'\r\n b'[-0.03681243  0.03241169  0.07067283  0.03979958  0.03641473]'\r\n b'[ 0.08654588 -0.01150938 -0.0563741  -0.02497471  0.04594599]'\r\n b'[-0.03297099  0.01769503  0.11319669  0.01238059  0.0082001 ]'\r\n b'[-0.00865924 -0.01036084  0.01999265 -0.02626343 -0.01680002]'\r\n b'[-0.05190443  0.03164011  0.02040888  0.00856969 -0.0272375 ]'\r\n b'[-0.05195722  0.05240251  0.1554347   0.03092176  0.03021973]'\r\n b'[ 0.02322851 -0.04756063  0.02221033 -0.01971874  0.02247192]'\r\n b'[-0.04352621  0.04046606  0.0664994  -0.04015313 -0.0013613 ]'\r\n b'[-0.03193593 -0.04119597  0.08940079 -0.08665874 -0.01585988]'\r\n b'[-0.03285274 -0.09046161  0.02063147 -0.01080728  0.01723639]'\r\n b'[-0.04092724 -0.00503651  0.04953369  0.02530581 -0.02194984]'\r\n b'[-0.03308328  0.0108201   0.08706747  0.01400463  0.00957526]'\r\n b'[ 0.01701859  0.00838621  0.08922331 -0.00337605  0.02646657]'\r\n b'[-0.06959544  0.04555301  0.02370284  0.01276516  0.03738073]'\r\n b'[-0.01415364  0.02345778  0.13541281  0.00027695  0.03363715]'\r\n b'[-0.06227937  0.01147403  0.04096422  0.06501009 -0.05931246]'\r\n b'[ 0.04575171  0.02199615  0.09396678 -0.03892348 -0.00266673]'\r\n b'[-0.00880066  0.07396847  0.05845954  0.0611381  -0.02724584]'\r\n b'[-0.09053511 -0.07695854  0.08236924 -0.0004557   0.03071151]'\r\n b'[-0.06687004 -0.00884794  0.06785945 -0.01278874  0.00910276]'\r\n b'[-0.06192718  0.04024284  0.04660054  0.03686318 -0.05565461]'\r\n b'[ 0.00812656 -0.03686302  0.09414893  0.02846115 -0.0320286 ]'\r\n b'[ 0.00260613  0.02772786  0.02776031 -0.05296541 -0.06279145]'\r\n b'[ 0.06081159  0.04025939  0.01868677 -0.01511183 -0.06156038]'\r\n b'[ 0.06705007  0.02358671  0.05917825 -0.04668655 -0.01996517]'\r\n b'[-0.02651405 -0.03667055  0.1276829   0.02881959 -0.05748772]'\r\n b'[-0.04663552  0.02453288  0.16361675 -0.04503557 -0.04188378]'\r\n b'[-0.0375299   0.0024564   0.08636113 -0.00160064 -0.00404025]'\r\n b'[ 0.10195461 -0.09637161  0.08657964  0.01170785 -0.00702063]'\r\n b'[-0.00990426  0.01018562  0.051896   -0.02190032  0.01513071]'\r\n b'[-0.01914701  0.08492666  0.0164949   0.04085653  0.01324011]'\r\n b'[ 0.05544649  0.00318151  0.05673654 -0.00993952 -0.02152128]'\r\n b'[-0.0254409   0.01935307  0.01199189 -0.00708791  0.00387142]'\r\n b'[-0.0282771   0.04030829  0.05126983 -0.04400632 -0.0082527 ]'\r\n b'[0.01513346 0.01526676 0.03014831 0.02528955 0.05057558]'\r\n b'[ 0.00170263 -0.05140645  0.01383791  0.1049732  -0.0187094 ]'\r\n b'[-0.05105732 -0.00549103 -0.00211255  0.00382627  0.03240367]'\r\n b'[ 0.08392965  0.05782474  0.04813674 -0.012268   -0.01868831]'\r\n b'[ 0.02100096  0.02253112 -0.01667141 -0.01646966  0.02927297]'\r\n b'[ 0.02955185 -0.0215682   0.06128283 -0.07923301 -0.03955455]'\r\n b'[-0.00260352  0.05469373  0.03105753  0.01570494  0.04612614]'\r\n b'[-0.04520263 -0.01102473  0.04200301  0.00765652  0.02229562]'\r\n b'[-0.03557624  0.02408457  0.04376483  0.01995172  0.03095791]'\r\n b'[-0.02472683  0.05018009  0.05735757 -0.03225219 -0.02325426]'\r\n b'[ 0.01198511  0.07219561 -0.04000699  0.00166795  0.02750094]'\r\n b'[ 0.03821035 -0.05754133  0.05844725 -0.01565812 -0.02900359]'\r\n b'[ 0.00653413  0.05587009  0.01621004 -0.01408313  0.0698965 ]'\r\n b'[ 0.00032702  0.04052418  0.05641509 -0.03344009 -0.03914972]'\r\n b'[-0.04089393 -0.00665233  0.12799472 -0.02873646 -0.00894405]'\r\n b'[-0.01444164 -0.03190748  0.00951358 -0.00564088 -0.03646583]'\r\n b'[ 0.00547115  0.05014327 -0.01592914 -0.00122629  0.04477547]'\r\n b'[-0.01207544  0.00356778  0.00447336 -0.0287638  -0.03753311]'\r\n b'[-0.05884602  0.01072115  0.02425918  0.02255262 -0.01806048]'\r\n b'[-0.01731539 -0.02231116  0.09437364  0.00170555 -0.05407009]'\r\n b'[ 0.06500567  0.01848128 -0.0014751  -0.0306924  -0.02501157]'\r\n b'[-0.05805401 -0.03961165  0.02174086 -0.04895382  0.08139951]'\r\n b'[ 0.00627512 -0.10157526  0.02130324 -0.0502402   0.01576446]'\r\n b'[-0.00976898 -0.05913119  0.04541657  0.05631701  0.05014214]'\r\n b'[ 0.012176    0.01870439 -0.09938233 -0.02261297  0.00181638]'\r\n b'[ 0.00652808 -0.05605447 -0.07694134 -0.0147412  -0.00597148]'\r\n b'[ 0.11674304  0.01894933  0.04533885 -0.06286294 -0.00410459]'\r\n b'[ 0.01085297 -0.01358635  0.0152023   0.02346188 -0.02940939]'\r\n b'[-0.07113044 -0.0611495   0.08770485 -0.06983516 -0.05291767]'\r\n b'[ 0.05899842 -0.01446779  0.07837778 -0.03993104  0.00525863]'\r\n b'[-0.10755081  0.0300941   0.07934867 -0.02394172 -0.02204445]'\r\n b'[-0.0311101   0.04656944  0.03284094 -0.03410514 -0.05289885]'\r\n b'[ 0.08936132  0.01549069 -0.08579474 -0.0308104   0.03784556]'\r\n b'[ 0.00364001 -0.01364339  0.01154843 -0.00796111 -0.04738059]'\r\n b'[-0.03339433 -0.00842785  0.04478682 -0.01196976 -0.04958511]'\r\n b'[-0.03358311  0.04321984  0.05168601 -0.01089774 -0.02395501]'\r\n b'[-0.06558623  0.04269782  0.0612884  -0.05247656 -0.00742848]'\r\n b'[-0.02506015  0.03288777 -0.02826415 -0.03411807  0.02337966]'\r\n b'[-0.0063935  -0.06393326 -0.00221541 -0.00846948 -0.00674942]'\r\n b'[-0.01611812 -0.04033646  0.07721135 -0.03097609 -0.0332734 ]'\r\n b'[ 0.06345142 -0.02645344  0.0762206   0.0113527   0.02931798]'\r\n b'[0.02701272 0.03514359 0.12304931 0.00486567 0.05368165]'\r\n b'[-0.01498978  0.00275506  0.09848753 -0.05815676 -0.02021742]'\r\n b'[-0.07171111 -0.09847055  0.10210885 -0.01390746 -0.01117994]'\r\n b'[ 0.05652616  0.020263    0.08677369  0.04779573 -0.02989006]'\r\n b'[-0.00321592  0.08285369  0.07023705  0.01291879  0.02472301]'\r\n b'[ 0.07298638 -0.01532689  0.02540569 -0.02986414  0.01640994]'\r\n b'[-0.03712279  0.01163841  0.13998468 -0.00304863  0.04347893]'\r\n b'[-0.03525798  0.01185983  0.13191286 -0.01959012  0.03257367]'\r\n b'[-0.04548401 -0.02758195  0.00168344 -0.03186819  0.00271737]'\r\n b'[-0.03803202 -0.00824933  0.06340004 -0.01111551  0.01700836]'\r\n b'[-0.06189108 -0.03465553  0.07799784  0.01622717 -0.03012843]'\r\n b'[ 0.01731179 -0.00914969  0.00600643 -0.04678116  0.02879524]'\r\n b'[-0.01725049  0.02091795  0.11079015  0.04469016  0.03707935]'\r\n b'[-0.04465106  0.02234716  0.06541137  0.01215733 -0.00971021]'\r\n b'[ 0.01089822 -0.01503999 -0.01136935  0.05091227 -0.01141826]'\r\n b'[-0.01596685 -0.01873063  0.05162324  0.04050293 -0.0415377 ]'\r\n b'[ 0.03071246 -0.01387434  0.17381501  0.02932012  0.0157283 ]'\r\n b'[-0.07127521  0.03927163  0.08532428 -0.04077393 -0.05403168]'\r\n b'[-0.06733387  0.01606675 -0.04003966  0.05473982 -0.05073515]'\r\n b'[-0.02546638  0.02652799  0.08205058 -0.01278413 -0.00037502]'\r\n b'[-0.00655765 -0.0049662   0.02634083  0.04414084 -0.00299913]'], shape=(128,), dtype=string)\r\n \r\na embedding columns of Pandas dataframe,  i will do\r\n ds = tf.data.Dataset.from_tensor_slices((dict(df), label))\r\n \r\n [(train_features, label_batch)] = ds.take(1)\r\n            print('Every feature:', list(train_features.keys()))\r\n            print('A batch of feed_embedding:', train_features['feed_embedding'])\r\n            \r\nhow string tensor to numpy array float32?\r\n            ", "comments": ["Have you tried using `tf.strings.to_number` https://www.tensorflow.org/api_docs/python/tf/strings/to_number", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50358\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50358\">No</a>\n"]}, {"number": 50357, "title": "HOW string Tensor  to Numpy array", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tens\r\n[aaa.txt](https://github.com/tensorflow/tensorflow/files/6679901/aaa.txt)\r\norflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):\r\n- Are you willing to contribute it (Yes/No):\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\n**Will this change the current api? How?**\r\n\r\n**Who will benefit with this feature?**\r\n\r\n**Any Other info.**\r\n", "comments": ["@zhonghui5207 \r\n\r\nWe see that the issue template has not been filled, could you please do so as it helps us analyse the issue [tf version, steps followed before you ran into this error or stand alone code to reproduce the issue faced]. Thanks\r\n", "duplicate https://github.com/tensorflow/tensorflow/issues/50358"]}, {"number": 50356, "title": "FAILED: Build did NOT complete successfully", "body": "\r\nI'm using a tested environment in Win10\r\n<!--StartFragment-->\r\ntensorflow-2.2.0 | 3.5-3.8 | MSVC 2019 | Bazel 2.0.0\r\n-- | -- | -- | --\r\nerror occurred\r\n...\\_bazel_dswxxxxx\\evzptwex\\execroot\\org_tensorflow\\external\\eigen_archive\\unsupported\\eigen\\cxx11\\src/Tensor/TensorBlock.h(1028): error C2061: \u8bed\r\n\u6cd5\u9519\u8bef: \u6807\u8bc6\u7b26\u201cKind\u201d\r\n.../_bazel_dswxxxxx\\evzptwex\\execroot\\org_tensorflow\\external\\eigen_archive\\unsupported\\eigen\\cxx11\\src/Tensor/TensorBlock.h(1134): note: \u8bf7\u53c2\u9605\u5bf9\r\n\u8981\u7f16\u8bd1\u7684\u7c7b \u6a21\u677f \u7684\u5b9e\u4f8b\u5316\u201cEigen::internal::StridedLinearBufferCopy<Scalar,IndexType>\u201d\u7684\u5f15\u7528\r\n...\\_bazel_dswxxxxx\\evzptwex\\execroot\\org_tensorflow\\external\\eigen_archive\\unsupported\\eigen\\cxx11\\src/Tensor/TensorBlock.h(1037): error C2061: \u8bed\r\n\u6cd5\u9519\u8bef: \u6807\u8bc6\u7b26\u201cKind\u201d\r\n\r\nwhy?\r\n\r\n\r\n<!--EndFragment-->\r\n\r\n", "comments": ["tensorflow/python/lib/core/bfloat16.cc(654): error C2664: \u201cbool tensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf\r\n61205e9403a18f850441a>::operator ()(const char *,PyUFuncGenericFunction,const std::array<int,3> &) const\u201d: \u65e0\u6cd5\u5c06\u53c2\u6570 2 \u4ece\u201cvoid (\r\n__cdecl *)(char **,npy_intp *,npy_intp *,void *)\u201d\u8f6c\u6362\u4e3a\u201cPyUFuncGenericFunction\u201d\r\ntensorflow/python/lib/core/bfloat16.cc(654): note: \u5728\u5339\u914d\u76ee\u6807\u7c7b\u578b\u7684\u8303\u56f4\u5185\u6ca1\u6709\u5177\u6709\u8be5\u540d\u79f0\u7684\u51fd\u6570\r\ntensorflow/python/lib/core/bfloat16.cc(629): note: \u53c2\u89c1\u201ctensorflow::`anonymous-namespace'::Initialize::<lambda_8175a7cc6bf61205e94\r\n03a18f850441a>::operator ()\u201d\u7684\u58f0\u660e\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n\r\nAll environments were reset and a new error occurred\r\nThe environment version is tested", "@XDSwang ,\r\n\r\nLooks like this is duplicate of issue #50369.Can you please close this issue, since it is already being tracked there? Thanks!", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50356\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50356\">No</a>\n"]}, {"number": 50355, "title": "[determinism] Add d9m-unimplemented exceptions to sparse/sparse matmul", "body": "This current PR is a follow-on to closed PR [47749](https://github.com/tensorflow/tensorflow/pull/47749) (Add GPU determinism for fp types in GPU SparseTensorDenseMatMul). This current PR adds and tests determinism-unimplemented exception-throwing for `tf.sparse.sparse_dense_matmul` when is running on a GPU. This current PR also adds tests for the bit-exact reproducibility (determinism) of `tf.sparse.sparse_dense_matmul` (forward direction only, not gradients) when running a CPU.\r\n\r\nThis PR is related to [RFC: Enabling Determinism in TensorFlow](https://github.com/tensorflow/community/blob/master/rfcs/20210119-determinism.md). For status and history of GPU-determinism for this op, see [here](https://github.com/NVIDIA/framework-determinism/blob/master/tensorflow_status.md#sparse-dense-matmul).\r\n\r\nCC @reedwm, @sanjoy, @nluehr", "comments": []}, {"number": 50354, "title": "Build from source (tensorflow)", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on a mobile device: No mobile \r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version: master \r\n- Python version: 3.8.5\r\n- Installed using virtualenv? pip? conda?: no environment \r\n- Bazel version (if compiling from source): 3.7.2\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:CUDA 11.0, cuDNN 8\r\n- GPU model and memory: RTX 2070 - (FYI, firstly I am trying to install on cpu).\r\n\r\n\r\n\r\n**Describe the problem**\r\n**Provide the exact sequence of commands/steps that you executed before running into the problem**\r\n\r\nI am trying to install tensorflow from the source.  \r\n\r\nhttps://www.tensorflow.org/install/source_windows\r\n\r\n1. Install Bazel and add it to the path \r\n2. Install MSYS2 and add it to the path and did \r\n```\r\npacman -S git patch unzip\r\n```\r\n\r\n![Screenshot 2021-06-19 031324](https://user-images.githubusercontent.com/17668390/122616532-5d1bfe00-d0ac-11eb-9145-de01f950163a.png)\r\n\r\n\r\n## Install Visual C++ Build Tools 2019\r\nNext, as the document says, we need to install \r\n\r\n- Microsoft Visual C++ 2019 Redistributable\r\n- Microsoft Build Tools 2019\r\n\r\nFrom [here](https://visualstudio.microsoft.com/downloads/), I downloaded them and installed and restart the pc anyway. \r\n\r\n\r\n![Screenshot 2021-06-19 031550](https://user-images.githubusercontent.com/17668390/122616761-e29fae00-d0ac-11eb-8f71-6090a24ad2ca.png)\r\n![Screenshot 2021-06-19 031633](https://user-images.githubusercontent.com/17668390/122616768-e4697180-d0ac-11eb-8baa-368f7964d4de.png)\r\n\r\n## TensorFlow\r\n\r\n```\r\ngit clone https://github.com/tensorflow/tensorflow.git\r\n\r\n# download as zip (as a name tensorflow-master.zip\r\n# unizip it and rename only tensorflow and then from CMD\r\n\r\ncd tensorflow\r\n```\r\n\r\n## Configure \r\n\r\nRun the following command \r\n\r\n```\r\npython ./configure.py\r\n```\r\n\r\nand get \r\n\r\n```\r\nD:\\tf_source\\tensorflow>python ./configure.py\r\nYou have bazel 3.7.2 installed.\r\nPlease specify the location of python. [Default is C:\\Users\\innat\\anaconda3\\python.exe]:\r\n\r\n\r\nFound possible Python library paths:\r\n  C:\\Users\\innat\\anaconda3\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Users\\innat\\anaconda3\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]:\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]:\r\nNo CUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is /arch:AVX]:\r\n\r\n\r\nWould you like to override eigen strong inline for some C++ compilation to reduce the compilation time? [Y/n]:\r\nEigen strong inline overridden.\r\n\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]:\r\nNot configuring the WORKSPACE for Android builds.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See .bazelrc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=mkl_aarch64    # Build with oneDNN and Compute Library for the Arm Architecture (ACL).\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\n        --config=numa           # Build with NUMA support.\r\n        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.\r\n        --config=v2             # Build TensorFlow 2.x instead of 1.x.\r\nPreconfigured Bazel build configs to DISABLE default on features:\r\n        --config=nogcp          # Disable GCP support.\r\n        --config=nonccl         # Disable NVIDIA NCCL support.\r\n````\r\n\r\nNext, run the following command \r\n\r\n```\r\nbazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\r\n```\r\nIt gave error as follows \r\n\r\n```\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=136\r\nINFO: Reading rc options for 'build' from d:\\tf_source\\tensorflow\\.bazelrc:\r\n  Inherited 'common' options: --experimental_repo_remote_exec\r\nINFO: Options provided by the client:\r\n  'build' options: --python_path=C:/Users/innat/anaconda3/python.exe\r\nINFO: Reading rc options for 'build' from d:\\tf_source\\tensorflow\\.bazelrc:\r\n  'build' options: --define framework_shared_object=true --java_toolchain=@tf_toolchains//toolchains/java:tf_java_toolchain --host_java_toolchain=@tf_toolchains//toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --noincompatible_prohibit_aapt1 --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true\r\nINFO: Reading rc options for 'build' from d:\\tf_source\\tensorflow\\.tf_configure.bazelrc:\r\n  'build' options: --action_env PYTHON_BIN_PATH=C:/Users/innat/anaconda3/python.exe --action_env PYTHON_LIB_PATH=C:/Users/innat/anaconda3/lib/site-packages --python_path=C:/Users/innat/anaconda3/python.exe --copt=/d2ReducedOptimizeHugeFunctions --host_copt=/d2ReducedOptimizeHugeFunctions --define=override_eigen_strong_inline=true\r\nINFO: Found applicable config definition build:short_logs in file d:\\tf_source\\tensorflow\\.bazelrc: --output_filter=DONT_MATCH_ANYTHING\r\nINFO: Found applicable config definition build:v2 in file d:\\tf_source\\tensorflow\\.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\nINFO: Found applicable config definition build:opt in file d:\\tf_source\\tensorflow\\.tf_configure.bazelrc: --copt=/arch:AVX --host_copt=/arch:AVX\r\nINFO: Found applicable config definition build:windows in file d:\\tf_source\\tensorflow\\.bazelrc: --copt=/W0 --copt=/D_USE_MATH_DEFINES --host_copt=/D_USE_MATH_DEFINES --cxxopt=/std:c++14 --host_cxxopt=/std:c++14 --config=monolithic --copt=-DWIN32_LEAN_AND_MEAN --host_copt=-DWIN32_LEAN_AND_MEAN --copt=-DNOGDI --host_copt=-DNOGDI --copt=/experimental:preprocessor --host_copt=/experimental:preprocessor --linkopt=/DEBUG --host_linkopt=/DEBUG --linkopt=/OPT:REF --host_linkopt=/OPT:REF --linkopt=/OPT:ICF --host_linkopt=/OPT:ICF --verbose_failures --distinct_host_configuration=false\r\nINFO: Found applicable config definition build:monolithic in file d:\\tf_source\\tensorflow\\.bazelrc: --define framework_shared_object=false\r\nDEBUG: C:/users/innat/_bazel_innat/xafk73x4/external/tf_runtime/third_party/cuda/dependencies.bzl:51:10: The following command will download NVIDIA proprietary software. By using the software you agree to comply with the terms of the license agreement that accompanies the software. If you do not agree to the terms of the license agreement, do not use the software.\r\nINFO: Build options --action_env, --copt, --define, and 1 more have changed, discarding analysis cache.\r\nINFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (0 packages loaded, 28806 targets configured).\r\nINFO: Found 1 target...\r\nERROR: D:/tf_source/tensorflow/tensorflow/compiler/mlir/lite/BUILD:170:18: TdGenerate tensorflow/compiler/mlir/lite/transforms/generated_optimize.inc failed (Exit -1073741515): mlir-tblgen.exe failed: error executing command\r\n  cd C:/users/innat/_bazel_innat/xafk73x4/execroot/org_tensorflow\r\nbazel-out/x64_windows-opt-exec-50AE0418/bin/external/llvm-project/mlir/mlir-tblgen.exe -gen-rewriters tensorflow/compiler/mlir/lite/transforms/optimize_patterns.td -I ./ -I bazel-out/x64_windows-opt/bin/./ -I external/llvm-project/mlir/include -I bazel-out/x64_windows-opt/bin/external/llvm-project/mlir/include -I tensorflow/compiler/mlir/lite/transforms -I bazel-out/x64_windows-opt/bin/tensorflow/compiler/mlir/lite/transforms -o bazel-out/x64_windows-opt/bin/tensorflow/compiler/mlir/lite/transforms/generated_optimize.inc\r\nExecution platform: @local_execution_config_platform//:platform\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 877.798s, Critical Path: 174.93s\r\nINFO: 1343 processes: 10 internal, 1333 local.\r\nFAILED: Build did NOT complete successfully\r\n````\r\n\r\nPrecisely the following issue \r\n\r\n```\r\nINFO: Found 1 target...\r\nERROR: D:/tf_source/tensorflow/tensorflow/compiler/mlir/lite/BUILD:170:18: TdGenerate tensorflow/compiler/mlir/lite/transforms/generated_optimize.inc failed (Exit -1073741515): mlir-tblgen.exe failed: error executing command\r\n  cd C:/users/innat/_bazel_innat/xafk73x4/execroot/org_tensorflow\r\nbazel-out/x64_windows-opt-exec-50AE0418/bin/external/llvm-project/mlir/mlir-tblgen.exe -gen-rewriters tensorflow/compiler/mlir/lite/transforms/optimize_patterns.td -I ./ -I bazel-out/x64_windows-opt/bin/./ -I external/llvm-project/mlir/include -I bazel-out/x64_windows-opt/bin/external/llvm-project/mlir/include -I tensorflow/compiler/mlir/lite/transforms -I bazel-out/x64_windows-opt/bin/tensorflow/compiler/mlir/lite/transforms -o bazel-out/x64_windows-opt/bin/tensorflow/compiler/mlir/lite/transforms/generated_optimize.inc\r\nExecution platform: @local_execution_config_platform//:platform\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 877.798s, Critical Path: 174.93s\r\nINFO: 1343 processes: 10 internal, 1333 local.\r\nFAILED: Build did NOT complete successfully\r\n````\r\n\r\n**Any other info/logs**\r\n- I also try the `tensorflow 2.4` branch, it shows a different error. (CPU, GPU both)\r\n- If the master branch is `tf 2.5`, then my CUDA/cuDNN is probably not compatible in case I want to compile with GPU. I've CUDA 8.0 and cuDNN 11.0 for tensorflow 2.4, and tensorflow 2.5 requires CUDA 8.1 and cuDNN 11.2.\r\n- But I want to compile it for CPU from the master branch as I already have tensorflow 2.4 as a separate environment. \r\n\r\n\r\nThe fact is, I need to compile tensorflow (from the master branch) on CPU only. And I've Cuda/cudnn version for tensorflow 2.4. Hope that would not conflict with the master branch of tensorflow. \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "comments": ["2.5 branch and master branch should have the same requirements.\r\n\r\n2.5 branch is in a state where we know the build passes on our supported environment. Can you try from that? From master you might have picked one commit where Windows was broken (quite frequently Windows is broken these days)", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50354\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50354\">No</a>\n"]}, {"number": 50353, "title": "Cannot convert a symbolic Tensor ({}) to a numpy array", "body": "<em>Please make sure that this is a bug. As per our\r\n[GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md),\r\nwe only address code/doc bugs, performance issues, feature requests and\r\nbuild/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Big Sur - 11.4\r\n- binary \r\n- tensorflow_macos\r\n- https://github.com/apple/tensorflow_macos\r\n- TensorFlow version (use command below):\r\n- 2.4.0-rc0\r\n- Python version:\r\n- 3.8.5\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\nAMD Radeon Pro 5700 XT\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\n\r\npython -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"\r\ntf_macos-v0.1-alpha2-AS-67-gf3595294ab 2.4.0-rc0\r\n\r\n**Describe the current behavior**\r\n raise NotImplementedError(\r\n        \"Cannot convert a symbolic Tensor ({}) to a numpy array.\"\r\n        \" This error may indicate that you're trying to pass a Tensor to\"\r\n        \" a NumPy call, which is not supported\".format(self.name))\r\n\r\nThe code is in the GitHub repository Top2vec:\r\n\r\nhttps://github.com/ddangelov/Top2Vec\r\n\r\n<img width=\"1402\" alt=\"Screen Shot 2021-06-18 at 11 50 52 AM\" src=\"https://user-images.githubusercontent.com/3105499/122614172-fca0a880-d03a-11eb-859f-e63156d01a7a.png\">\r\n\r\n@staticmethod\r\n    def _l2_normalize(vectors):\r\n\r\n        if vectors.ndim == 2:\r\n            return normalize(vectors)\r\n        else:\r\n            return normalize(vectors.reshape(1, -1))[0]\r\n\r\n self.word_vectors = self._l2_normalize(np.array(self.embed(self.vocab)))\r\n\r\n\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n", "comments": ["Relevant?\r\n\r\nhttps://stackoverflow.com/questions/58479556/notimplementederror-cannot-convert-a-symbolic-tensor-2nd-target0-to-a-numpy\r\n\r\nhttps://github.com/apple/tensorflow_macos/issues/267\r\n\r\nhttps://github.com/apple/tensorflow_macos/issues/151", "Can you print out what `self.embed(self.vocab)` returns? If its a SymbolicTensor, then this is indeed unsupported and we should figure out if getting back a Symbolic Tensor is expected. I looked at the code and from https://github.com/ddangelov/Top2Vec/blob/master/top2vec/Top2Vec.py#L803 its a bit unclear which self.embed case is this failing for.", "```\r\ntop2vec_trained = Top2Vec(documents=papers_prepared_df.text.tolist(), **embedding_model=\"universal-sentence-encoder-multilingua**l\", speed=\"learn\", workers=6)\r\n\r\nprint(self.embed(self.vocab))\r\nTensor(\"StatefulPartitionedCall:0\", shape=(None, 512), dtype=float32)\r\n\r\nself.embed(self.vocab) = {Tensor: None, 512)} TensorFlow(\"StatefulPartitionedCall_3:0\", shape=(None, 512), dytype=float32)\r\n```\r\n<img width=\"2560\" alt=\"Screen Shot 2021-06-19 at 11 37 58 PM\" src=\"https://user-images.githubusercontent.com/3105499/122664754-23083600-d158-11eb-9022-f470c20c13e4.png\">\r\n", "I tried an Apple Tensorflow 2.5.0 for metal with numpy 1.19.1 version.\r\nhttps://developer.apple.com/metal/tensorflow-plugin/\r\n```\r\n print(self.embed(self.vocab))\r\nTensor(\"StatefulPartitionedCall_1:0\", shape=(None, 512), dtype=float32)\r\n```\r\nIt get's the same exception:\r\n\r\nNotImplementedError: Cannot convert a symbolic Tensor (StatefulPartitionedCall_2:0) to a numpy array. This error may indicate that you're trying to pass a Tensor to a NumPy call, which is not supported\r\n\r\nbtw - you may run into this error on Top2vec:\r\n\r\nhttps://github.com/ddangelov/Top2Vec/issues/72", "Correct me if I'm wrong but seems like https://github.com/ddangelov/Top2Vec/blob/master/top2vec/Top2Vec.py#L818 is where self.embed gets created (a TF hub module)\r\n\r\nI locally tried to reproduce the error\r\n\r\n```\r\nm = hub.load(\"https://tfhub.dev/google/universal-sentence-encoder-multilingual/3\")\r\nenglish_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long walks along the beach with my dog.\"]\r\nr = np.array(m(english_sentences))\r\nprint(r)\r\n```\r\n\r\nCan you just run these commands and see if that works for you?\r\n\r\nWhat version of TF hub are you running? \r\n\r\n", "```\r\n% conda list tensorflow\r\n# packages in environment at /Users/davidlaxer/anaconda3:\r\n#\r\n# Name                    Version                   Build  Channel\r\nmesh-tensorflow           0.1.19                   pypi_0    pypi\r\ntensorflow                2.5.0                    pypi_0    pypi\r\ntensorflow-datasets       4.3.0                    pypi_0    pypi\r\ntensorflow-estimator      2.5.0                    pypi_0    pypi\r\ntensorflow-hub            0.12.0                   pypi_0    pypi\r\ntensorflow-metadata       1.0.0                    pypi_0    pypi\r\ntensorflow-text           2.5.0rc0                 pypi_0    pypi\r\n(base) (tensorflow-metal) davidlaxer@x86_64-apple-darwin13 Top2Vec % ipython\r\n/Users/davidlaxer/anaconda3/lib/python3.8/site-packages/IPython/core/interactiveshell.py:935: UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv.\r\n  warn(\"Attempting to work in a virtualenv. If you encounter problems, please \"\r\nPython 3.8.5 (default, Sep  4 2020, 02:22:02) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.18.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import tensorflow_hub\r\n\r\nIn [2]: m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-enc\r\n   ...: oder-multilingual/3\")\r\n   ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long wa\r\n   ...: lks along the beach with my dog.\"]\r\n   ...: r = np.array(m(english_sentences))\r\n   ...: print(r)\r\n2021-06-20 12:21:23.323164: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\r\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/ops.py in _get_op_def(self, type)\r\n   3957     try:\r\n-> 3958       return self._op_def_cache[type]\r\n   3959     except KeyError:\r\n\r\nKeyError: 'SentencepieceOp'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nNotFoundError                             Traceback (most recent call last)\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/saved_model/load.py in load_internal(export_dir, tags, options, loader_cls, filters)\r\n    904       try:\r\n--> 905         loader = loader_cls(object_graph_proto, saved_model_proto, export_dir,\r\n    906                             ckpt_options, filters)\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/saved_model/load.py in __init__(self, object_graph_proto, saved_model_proto, export_dir, ckpt_options, filters)\r\n    132     self._concrete_functions = (\r\n--> 133         function_deserialization.load_function_def_library(\r\n    134             meta_graph.graph_def.library))\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/saved_model/function_deserialization.py in load_function_def_library(library, load_shared_name_suffix)\r\n    357     with graph.as_default():\r\n--> 358       func_graph = function_def_lib.function_def_to_graph(copy)\r\n    359     _restore_gradient_functions(func_graph, renamed_functions)\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/function_def_to_graph.py in function_def_to_graph(fdef, input_shapes)\r\n     62       input_shapes = input_shapes_attr.list.shape\r\n---> 63   graph_def, nested_to_flat_tensor_name = function_def_to_graph_def(\r\n     64       fdef, input_shapes)\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/function_def_to_graph.py in function_def_to_graph_def(fdef, input_shapes)\r\n    227     else:\r\n--> 228       op_def = default_graph._get_op_def(node_def.op)  # pylint: disable=protected-access\r\n    229 \r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/ops.py in _get_op_def(self, type)\r\n   3961         # pylint: disable=protected-access\r\n-> 3962         pywrap_tf_session.TF_GraphGetOpDef(self._c_graph, compat.as_bytes(type),\r\n   3963                                            buf)\r\n\r\nNotFoundError: Op type not registered 'SentencepieceOp' in binary running on BlueDiamond.local. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nFileNotFoundError                         Traceback (most recent call last)\r\n<ipython-input-2-ca3c857bb309> in <module>\r\n----> 1 m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-encoder-multilingual/3\")\r\n      2 english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long walks along the beach with my dog.\"]\r\n      3 r = np.array(m(english_sentences))\r\n      4 print(r)\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow_hub-0.12.0-py3.8.egg/tensorflow_hub/module_v2.py in load(handle, tags, options)\r\n    104         module_path, tags=tags, options=options)\r\n    105   else:\r\n--> 106     obj = tf.compat.v1.saved_model.load_v2(module_path, tags=tags)\r\n    107   obj._is_hub_module_v1 = is_hub_module_v1  # pylint: disable=protected-access\r\n    108   return obj\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/saved_model/load.py in load(export_dir, tags, options)\r\n    867     ValueError: If `tags` don't match a MetaGraph in the SavedModel.\r\n    868   \"\"\"\r\n--> 869   return load_internal(export_dir, tags, options)[\"root\"]\r\n    870 \r\n    871 \r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/saved_model/load.py in load_internal(export_dir, tags, options, loader_cls, filters)\r\n    906                             ckpt_options, filters)\r\n    907       except errors.NotFoundError as err:\r\n--> 908         raise FileNotFoundError(\r\n    909             str(err) + \"\\n If trying to load on a different device from the \"\r\n    910             \"computational device, consider using setting the \"\r\n\r\nFileNotFoundError: Op type not registered 'SentencepieceOp' in binary running on BlueDiamond.local. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\r\n If trying to load on a different device from the computational device, consider using setting the `experimental_io_device` option on tf.saved_model.LoadOptions to the io_device such as '/job:localhost'.\r\n\r\nIn [3]: \r\n\r\n```", "Yeah I ran into this problem too.. You need to import tensorflow_text to fix that. Can you try again? ", "Same error in an Anaconda environment with Tensorflow 2.4.0rc0.\r\n```\r\n(tensorflow_mac) davidlaxer@x86_64-apple-darwin13 notebooks % conda list tensorflow\r\n# packages in environment at /Users/davidlaxer/anaconda3/envs/tensorflow_mac:\r\n#\r\n# Name                    Version                   Build  Channel\r\ntensorflow                2.4.0rc0                 pypi_0    pypi\r\ntensorflow-addons         0.11.2                   pypi_0    pypi\r\ntensorflow-base           2.4.1            py38h8860697_0    conda-forge\r\ntensorflow-datasets       1.2.0                    py38_0    anaconda\r\ntensorflow-estimator      2.4.0              pyh9656e83_0    conda-forge\r\ntensorflow-hub            0.8.0              pyhe6710b0_0    anaconda\r\ntensorflow-metadata       0.14.0             pyhe6710b0_1    anaconda\r\ntensorflow-text           2.4.3                    pypi_0    pypi\r\n(tensorflow_mac) davidlaxer@x86_64-apple-darwin13 notebooks % \r\n% ipython         \r\nPython 3.8.5 (default, Sep  4 2020, 02:22:02) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.18.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import tensorflow_hub\r\n\r\nIn [2]: m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-enc\r\n   ...: oder-multilingual/3\")\r\n   ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long wa\r\n   ...: lks along the beach with my dog.\"]\r\n   ...: r = np.array(m(english_sentences))\r\n   ...: print(r)\r\n2021-06-20 12:33:27.352294: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set\r\n2021-06-20 12:33:27.352467: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\r\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/ops.py in _get_op_def(self, type)\r\n   3928     try:\r\n-> 3929       return self._op_def_cache[type]\r\n   3930     except KeyError:\r\n\r\nKeyError: 'SentencepieceOp'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nNotFoundError                             Traceback (most recent call last)\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/saved_model/load.py in load_internal(export_dir, tags, options, loader_cls, filters)\r\n    888       try:\r\n--> 889         loader = loader_cls(object_graph_proto, saved_model_proto, export_dir,\r\n    890                             ckpt_options, filters)\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/saved_model/load.py in __init__(self, object_graph_proto, saved_model_proto, export_dir, ckpt_options, filters)\r\n    130     self._concrete_functions = (\r\n--> 131         function_deserialization.load_function_def_library(\r\n    132             meta_graph.graph_def.library))\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/saved_model/function_deserialization.py in load_function_def_library(library, load_shared_name_suffix)\r\n    343     with graph.as_default():\r\n--> 344       func_graph = function_def_lib.function_def_to_graph(copy)\r\n    345     _restore_gradient_functions(func_graph, renamed_functions)\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/function_def_to_graph.py in function_def_to_graph(fdef, input_shapes)\r\n     57       input_shapes = input_shapes_attr.list.shape\r\n---> 58   graph_def, nested_to_flat_tensor_name = function_def_to_graph_def(\r\n     59       fdef, input_shapes)\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/function_def_to_graph.py in function_def_to_graph_def(fdef, input_shapes)\r\n    219     else:\r\n--> 220       op_def = default_graph._get_op_def(node_def.op)  # pylint: disable=protected-access\r\n    221 \r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/ops.py in _get_op_def(self, type)\r\n   3932         # pylint: disable=protected-access\r\n-> 3933         pywrap_tf_session.TF_GraphGetOpDef(self._c_graph, compat.as_bytes(type),\r\n   3934                                            buf)\r\n\r\nNotFoundError: Op type not registered 'SentencepieceOp' in binary running on BlueDiamond.local. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nFileNotFoundError                         Traceback (most recent call last)\r\n<ipython-input-2-ca3c857bb309> in <module>\r\n----> 1 m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-encoder-multilingual/3\")\r\n      2 english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long walks along the beach with my dog.\"]\r\n      3 r = np.array(m(english_sentences))\r\n      4 print(r)\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow_hub/module_v2.py in load(handle, tags)\r\n    100   if tags is None and is_hub_module_v1:\r\n    101       tags = []\r\n--> 102   obj = tf_v1.saved_model.load_v2(module_path, tags=tags)\r\n    103   obj._is_hub_module_v1 = is_hub_module_v1  # pylint: disable=protected-access\r\n    104   return obj\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/saved_model/load.py in load(export_dir, tags, options)\r\n    857     ValueError: If `tags` don't match a MetaGraph in the SavedModel.\r\n    858   \"\"\"\r\n--> 859   return load_internal(export_dir, tags, options)[\"root\"]\r\n    860 \r\n    861 \r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/saved_model/load.py in load_internal(export_dir, tags, options, loader_cls, filters)\r\n    890                             ckpt_options, filters)\r\n    891       except errors.NotFoundError as err:\r\n--> 892         raise FileNotFoundError(\r\n    893             str(err) + \"\\n If trying to load on a different device from the \"\r\n    894             \"computational device, consider using setting the \"\r\n\r\nFileNotFoundError: Op type not registered 'SentencepieceOp' in binary running on BlueDiamond.local. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\r\n If trying to load on a different device from the computational device, consider using setting the `experimental_io_device` option on tf.saved_model.LoadOptions to the io_device such as '/job:localhost'.\r\n\r\nIn [3]: quit()\r\n\r\n```\r\n", "```\r\nIn [4]: import tensorflow_text\r\nIn [5]: import numpy as np\r\n\r\nIn [6]: m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-enc\r\n   ...: oder-multilingual/3\")\r\n   ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long wa\r\n   ...: lks along the beach with my dog.\"]\r\n   ...: r = np.array(m(english_sentences))\r\n   ...: print(r)\r\n[[ 0.1009305  -0.03811244  0.01992671 ...  0.06740665  0.0183861\r\n   0.05333169]\r\n [ 0.03641615 -0.0317799   0.06663751 ...  0.03586746 -0.001629\r\n   0.04395661]\r\n [-0.00552389  0.0059953  -0.01480541 ... -0.03980629  0.03113596\r\n  -0.03667421]]\r\n```", "In Anaconda environment with tensorflow                2.4.0rc0                 \r\n```\r\nIn [5]: m = tensorflow_hub.load(\"https://tfhub.dev/google/universal-sentence-enc\r\n   ...: oder-multilingual/3\")\r\n   ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long wa\r\n   ...: lks along the beach with my dog.\"]\r\n   ...: r = np.array(m(english_sentences))\r\n   ...: print(r)\r\n2021-06-20 12:38:38.000736: I tensorflow/compiler/tf2mlcompute/kernels/mlc_subgraph_op.cc:326] Compute: Failed in processing TensorFlow graph StatefulPartitionedCall/StatefulPartitionedCall/EncoderDNN/CNN_layers/ngram_order_2/MLCSubgraphOp_0_0 with frame_id = 0 and iter_id = 0 with error: Internal: PreprocessForwardOp: Obtained nil MLCTensor for input 0 into n18 = StatefulPartitionedCall/StatefulPartitionedCall/EncoderDNN/CNN_layers/ngram_order_2/Ngram-2-Conv/concat_1 (ConcatV2), whose parent op: n8 = mlcinput_0_0_6 (_Arg) fails to create a MLCTensor. (error will be reported 5 times unless TF_MLC_LOGGING=1).\r\n[[ 0.10093051 -0.03811245  0.01992668 ...  0.06740664  0.01838612\r\n   0.0533317 ]\r\n [ 0.03641616 -0.03177989  0.06663751 ...  0.03586744 -0.00162899\r\n   0.04395661]\r\n [-0.00552389  0.0059953  -0.01480542 ... -0.03980628  0.03113598\r\n  -0.03667421]]\r\n\r\n```", "```\r\nIn [7]: print(m)\r\n<tensorflow.python.saved_model.load.Loader._recreate_base_user_object.<locals>._UserObject object at 0x7fea78930d00>\r\nprint(m(english_sentences))\r\ntf.Tensor(\r\n[[ 0.1009305  -0.03811244  0.01992671 ...  0.06740665  0.0183861\r\n   0.05333169]\r\n [ 0.03641615 -0.0317799   0.06663751 ...  0.03586746 -0.001629\r\n   0.04395661]\r\n [-0.00552389  0.0059953  -0.01480541 ... -0.03980629  0.03113596\r\n  -0.03667421]], shape=(3, 512), dtype=float32)\r\n```\r\n", "@dbl001 ,\r\n\r\nCan you please take a look at this issue which has similar error.[Link1](https://stackoverflow.com/questions/58479556/notimplementederror-cannot-convert-a-symbolic-tensor-2nd-target0-to-a-numpy/58678385#58678385),[Link2](https://www.tensorflow.org/api_docs/python/tf/make_ndarray).\r\nAlso the code provided is fairly complex hence it would be difficult for us to pinpoint the issue. Could you please get the example down to the simplest possible repro? That will allow us to determine the source of the issue easily. Thanks!", "I tried tf.make_ndarray().  Is this exception a clue?\r\n```\r\nself.word_vectors = tf.math.l2_normalize(self.embed(self.vocab))\r\nself.word_vectors = tf.make_ndarray(self.word_vectors)\r\n```\r\nand with previous test case:\r\n```\r\nIn [13]: print(tf.make_ndarray(tf.math.l2_normalize(\r\n    ...: m(english_sentences))))\r\n    ...: \r\n    ...: \r\n    ...: \r\n    ...: \r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-13-7a553c152683> in <module>\r\n----> 1 print(tf.make_ndarray(tf.math.l2_normalize(\r\n      2 m(english_sentences))))\r\n      3 \r\n      4 \r\n      5 \r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/tensor_util.py in MakeNdarray(tensor)\r\n    595 \r\n    596   \"\"\"\r\n--> 597   shape = [d.size for d in tensor.tensor_shape.dim]\r\n    598   num_elements = np.prod(shape, dtype=np.int64)\r\n    599   tensor_dtype = dtypes.as_dtype(tensor.dtype)\r\n\r\n~/anaconda3/lib/python3.8/site-packages/tensorflow-2.5.0-py3.8-macosx-10.9-x86_64.egg/tensorflow/python/framework/ops.py in __getattr__(self, name)\r\n    399         import tensorflow.python.ops.numpy_ops.np_config\r\n    400         np_config.enable_numpy_behavior()\"\"\".format(type(self).__name__, name))\r\n--> 401     self.__getattribute__(name)\r\n    402 \r\n    403   @staticmethod\r\n\r\nAttributeError: 'tensorflow.python.framework.ops.EagerTensor' object has no attribute 'tensor_shape'\r\n\r\n```\r\n<img width=\"2560\" alt=\"Screen Shot 2021-06-19 at 11 37 58 PM\" src=\"https://user-images.githubusercontent.com/3105499/122804107-55ab4f00-d27c-11eb-8cb2-28a6f0da881b.png\">\r\n", "@dbl001 ,\r\n\r\nWithout the reproducible code, it would be difficult for us to debug the issue. In order to expedite the trouble-shooting process, could you please provide a minimal code snippet or colab gist which pinpoint the issue.Thanks!", "I downloaded universal-sentence-encoder_3 and universal-sentence-encoder_4 from\r\nhttps://tfhub.dev/google/universal-sentence-encoder/4\r\n\r\nAny idea why in the examples below universal-sentence-encoder_4 returns a numpy array but\r\nuniversal-sentence-encoder_3 returns: {'outputs': <tf.Tensor: shape=(3, 512), dtype=float32, numpy=...\r\n?  They are both of type numpy.ndarray.  Is _3 a symbolic Tensor?\r\n\r\n```\r\nIn [42]: m = tensorflow_hub.load(\"/Users/davidlaxer/Downloads/universal-sentence\r\n    ...: -encoder_3\")\r\n    ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long w\r\n    ...: alks along the beach with my dog.\"]\r\n    ...: r3 = np.array(m(english_sentences))\r\n    ...: print(r3)\r\n{'outputs': <tf.Tensor: shape=(3, 512), dtype=float32, numpy=\r\narray([[-0.06334164, -0.01812314,  0.03680531, ..., -0.02809388,\r\n         0.02786911, -0.04715428],\r\n       [ 0.01975714, -0.02284616,  0.04316505, ..., -0.01376714,\r\n        -0.00614742, -0.00124967],\r\n       [-0.02169351, -0.003993  ,  0.06716524, ...,  0.05952153,\r\n         0.02262796,  0.03501643]], dtype=float32)>}\r\n\r\nIn [43]: type(r3)\r\nOut[43]: numpy.ndarray\r\n\r\nIn [44]: m = tensorflow_hub.load(\"/Users/davidlaxer/Downloads/universal-sentence\r\n    ...: -encoder_4\")\r\n    ...: english_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long w\r\n    ...: alks along the beach with my dog.\"]\r\n    ...: r4 = np.array(m(english_sentences))\r\n    ...: print(r4)\r\n[[-0.06334164 -0.01812314  0.03680531 ... -0.02809388  0.02786911\r\n  -0.04715428]\r\n [ 0.01975714 -0.02284616  0.04316505 ... -0.01376714 -0.00614742\r\n  -0.00124967]\r\n [-0.02169351 -0.003993    0.06716524 ...  0.05952153  0.02262796\r\n   0.03501643]]\r\n\r\nIn [45]: type(r4)\r\nOut[45]: numpy.ndarray\r\n\r\n```", "How do I add a Jupiter notebook to the issue? E.g. -  'example.ipynb'?\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow_hub as hub\r\nimport tensorflow_text\r\nimport numpy as np\r\nfrom sklearn.preprocessing import normalize\r\n\r\ndef l2_normalize(vectors):\r\n\r\n    if vectors.ndim == 2:\r\n        return normalize(vectors)\r\n    else:\r\n        return normalize(vectors.reshape(1, -1))[0]\r\n\r\nm4 = hub.load(\"/Users/davidlaxer/Downloads/universal-sentence-encoder_4\")\r\nenglish_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long walks along the beach with my dog.\"]\r\nr4 = np.array(m4(english_sentences))\r\nprint(r4)\r\nprint(m4)\r\ntype(r4)\r\ntype(m4)\r\n\r\nm3 = hub.load(\"/Users/davidlaxer/Downloads/universal-sentence-encoder_3\")\r\nenglish_sentences = [\"dog\", \"Puppies are nice.\", \"I enjoy taking long walks along the beach with my dog.\"]\r\nr3 = np.array(m3(english_sentences))\r\nprint(r3)\r\nprint(m3)\r\ntype(r4)\r\ntype(m4)\r\n\r\nl2_normalize(np.array(m3(english_sentences)))\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-51-d33d10ce7494> in <module>\r\n----> 1 l2_normalize(np.array(m3(english_sentences)))\r\n\r\n<ipython-input-33-d2382fc2161e> in l2_normalize(vectors)\r\n      4         return normalize(vectors)\r\n      5     else:\r\n----> 6         return normalize(vectors.reshape(1, -1))[0]\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/scikit_learn-0.24.2-py3.8-macosx-10.9-x86_64.egg/sklearn/utils/validation.py in inner_f(*args, **kwargs)\r\n     61             extra_args = len(args) - len(all_args)\r\n     62             if extra_args <= 0:\r\n---> 63                 return f(*args, **kwargs)\r\n     64 \r\n     65             # extra_args > 0\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/scikit_learn-0.24.2-py3.8-macosx-10.9-x86_64.egg/sklearn/preprocessing/_data.py in normalize(X, norm, axis, copy, return_norm)\r\n   1902         raise ValueError(\"'%d' is not a supported axis\" % axis)\r\n   1903 \r\n-> 1904     X = check_array(X, accept_sparse=sparse_format, copy=copy,\r\n   1905                     estimator='the normalize function', dtype=FLOAT_DTYPES)\r\n   1906     if axis == 0:\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/scikit_learn-0.24.2-py3.8-macosx-10.9-x86_64.egg/sklearn/utils/validation.py in inner_f(*args, **kwargs)\r\n     61             extra_args = len(args) - len(all_args)\r\n     62             if extra_args <= 0:\r\n---> 63                 return f(*args, **kwargs)\r\n     64 \r\n     65             # extra_args > 0\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/scikit_learn-0.24.2-py3.8-macosx-10.9-x86_64.egg/sklearn/utils/validation.py in check_array(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator)\r\n    671                     array = array.astype(dtype, casting=\"unsafe\", copy=False)\r\n    672                 else:\r\n--> 673                     array = np.asarray(array, order=order, dtype=dtype)\r\n    674             except ComplexWarning as complex_warning:\r\n    675                 raise ValueError(\"Complex data not supported\\n\"\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/numpy/core/_asarray.py in asarray(a, dtype, order)\r\n     81 \r\n     82     \"\"\"\r\n---> 83     return array(a, dtype, copy=False, order=order)\r\n     84 \r\n     85 \r\n\r\nTypeError: float() argument must be a string or a number, not 'dict'\r\nl2_normalize(np.array(m4(english_sentences)))\r\n[[-0.06334163 -0.01812313  0.03680531 ... -0.02809387  0.02786911\r\n  -0.04715427]\r\n [ 0.01975715 -0.02284616  0.04316505 ... -0.01376714 -0.00614742\r\n  -0.00124967]\r\n [-0.02169351 -0.003993    0.06716524 ...  0.05952153  0.02262796\r\n   0.03501643]]\r\n\r\nprint(l2_normalize(tf.make_ndarray(tf.make_tensor_proto(m3(english_sentences)))))\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in _AssertCompatible(values, dtype)\r\n    329   try:\r\n--> 330     fn(values)\r\n    331   except ValueError as e:\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in _check_not_tensor(values)\r\n    281 def _check_not_tensor(values):\r\n--> 282   _ = [_check_failed(v) for v in nest.flatten(values)\r\n    283        if isinstance(v, ops.Tensor)]\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in <listcomp>(.0)\r\n    281 def _check_not_tensor(values):\r\n--> 282   _ = [_check_failed(v) for v in nest.flatten(values)\r\n    283        if isinstance(v, ops.Tensor)]\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in _check_failed(v)\r\n    249   # it is safe to use here.\r\n--> 250   raise ValueError(v)\r\n    251 \r\n\r\nValueError: tf.Tensor(\r\n[[-0.06334164 -0.01812314  0.03680531 ... -0.02809388  0.02786911\r\n  -0.04715428]\r\n [ 0.01975714 -0.02284616  0.04316505 ... -0.01376714 -0.00614742\r\n  -0.00124967]\r\n [-0.02169351 -0.003993    0.06716524 ...  0.05952153  0.02262796\r\n   0.03501643]], shape=(3, 512), dtype=float32)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-38-e2630ec1fa0b> in <module>\r\n----> 1 print(l2_normalize(tf.make_ndarray(tf.make_tensor_proto(m3(english_sentences)))))\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in make_tensor_proto(values, dtype, shape, verify_shape, allow_broadcast)\r\n    455       nparray = np.empty(shape, dtype=np_dt)\r\n    456     else:\r\n--> 457       _AssertCompatible(values, dtype)\r\n    458       nparray = np.array(values, dtype=np_dt)\r\n    459       # check to them.\r\n\r\n~/anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/tensor_util.py in _AssertCompatible(values, dtype)\r\n    332     [mismatch] = e.args\r\n    333     if dtype is None:\r\n--> 334       raise TypeError(\"Expected any non-tensor type, got a tensor instead.\")\r\n    335     else:\r\n    336       raise TypeError(\"Expected %s, got %s of type '%s' instead.\" %\r\n\r\nTypeError: Expected any non-tensor type, got a tensor instead.\r\n\r\nprint(l2_normalize(tf.make_ndarray(tf.make_tensor_proto(m4(english_sentences)))))\r\n[[-0.06334163 -0.01812313  0.03680531 ... -0.02809387  0.02786911\r\n  -0.04715427]\r\n [ 0.01975715 -0.02284616  0.04316505 ... -0.01376714 -0.00614742\r\n  -0.00124967]\r\n [-0.02169351 -0.003993    0.06716524 ...  0.05952153  0.02262796\r\n   0.03501643]]\r\n[38]:\r\n\r\n\r\n```", "@dbl001 ,\r\n\r\nThis issue is more suitable for TensorFlow Hub repo. Please post it on [Tensorflow Hub repo](https://github.com/tensorflow/hub/issues). Thanks!", "Ok, tensorflow_hub clarified the issue between the model outputs\r\nSee\r\nhttps://github.com/tensorflow/hub/issues/775\r\n\r\nBut, there's still the \"NotImplementedError: Cannot convert a symbolic Tensor (StatefulPartitionedCall_4:0) to a numpy array. This error may indicate that you're trying to pass a Tensor to a NumPy call, which is not supported\"\r\nwhich appears to be related to the numpy version.\r\n\r\nnumpy 1.19.5 usually works.\r\nnumpy 1.20 & numpy 1.21.0 get the exception,\r\nwhen running numpy.array() on these tensors:\r\n\r\nTensor(\"StatefulPartitionedCall_3:0\", shape=(None, 512), dtype=float32)\r\nTensor(\"StatefulPartitionedCall_4:0\", shape=(None, 512), dtype=float32)\r\n\r\n\r\n", "I was trying to utilize the AMD GPU with tensorflow-macos.\r\n\r\nWARNING:tensorflow:Eager mode uses the CPU. Switching to the CPU.\r\n\r\nThe problem occurs when I run this code:\r\n\r\nfrom tensorflow.python.framework.ops import disable_eager_execution\r\ndisable_eager_execution()\r\n\r\nIf I disable_eager_execution(), the exception is not raised.\r\n```\r\nfrom tensorflow.python.framework.ops import disable_eager_execution\r\n#disable_eager_execution()\r\n\r\nfrom tensorflow.python.compiler.mlcompute import mlcompute\r\nmlcompute.set_mlc_device(device_name='gpu')\r\nprint(\"is_apple_mlc_enabled %s\" % mlcompute.is_apple_mlc_enabled())\r\nprint(\"is_tf_compiled_with_apple_mlc %s\" % mlcompute.is_tf_compiled_with_apple_mlc())\r\n```\r\n... but no GPU!", "Unfortunately we don't officially provide gpu support for macOS\r\nhttps://www.tensorflow.org/install/pip#system-requirements\r\nYou may want to reach out to https://github.com/apple/tensorflow_macos for gpu config questions.", "tensorflow-macos \"has been archived by the owner and is now read-only.\"\r\n\r\n https://github.com/apple/tensorflow_macos\r\n\r\nDoes anyone else supports this version of tensorflow?", "You can try raising your issue on mac developer forum https://developer.apple.com/forums/\r\nAlso revisit the previously raised issues on that forum and see if anything sticks out.\r\n", "If you disable_eager_execution then the tensors returned would be symbolic since you basically end up with v1 graph mode and you'll run into that problem of trying to convert a symbolic tensor to a numpy array which isn't supported. Disabling eager execution won't have an impact on GPU vs CPU either since we don't support GPU on Mac OS. ", "1. I am running tensorflow_macos.  I thought the point was to provide GPU support for M1 and AMD in tensorflow.\r\ne.g.  \r\n```\r\nprint(tensorflow.__version__)\r\n2.4.0-rc0\r\n\r\nfrom tensorflow.python.framework.ops import disable_eager_execution\r\n#disable_eager_execution()\r\n\r\nfrom tensorflow.python.compiler.mlcompute import mlcompute\r\nmlcompute.set_mlc_device(device_name='gpu')\r\nprint(\"is_apple_mlc_enabled %s\" % mlcompute.is_apple_mlc_enabled())\r\nprint(\"is_tf_compiled_with_apple_mlc %s\" % mlcompute.is_tf_compiled_with_apple_mlc())\r\n\r\nis_apple_mlc_enabled True\r\nis_tf_compiled_with_apple_mlc True\r\nWARNING:tensorflow:Eager mode uses the CPU. Switching to the CPU.\r\n2021-06-26 18:21:50,384 - top2vec - INFO - Pre-processing documents for training\r\n```\r\n2. Is there a way to convert a symbolic tensor to a numpy array?\r\nI tried tf.make_ndarray() as well as tf.make_tensor_proto() nothing worked.\r\n3. Can tensorflow_hub return a tensor which can be converted to numpy?\r\n\r\n", "1. Seems like there is some support in TF2.5 - https://developer.apple.com/metal/tensorflow-plugin/ see if that helps\r\n2. and 3. the only way to convert a symbolic tensor to a numpy array is through a session (if you disable eager execution). https://www.tensorflow.org/api_docs/python/tf/compat/v1/Session", "1. I tried TF 2.5, but there are still several unresolved issues with Big Sur.\r\nhttps://github.com/tensorflow/tensorflow/issues/50108\r\n\r\nSpecifically,\r\n```\r\nNotFoundError: dlopen(/Users/davidlaxer/tensorflow-metal/lib/python3.8/site-packages/tensorflow-plugins/libmetal_plugin.dylib, 6): Symbol not found: _TF_AssignUpdateVariable\r\n  Referenced from: /Users/davidlaxer/tensorflow-metal/lib/python3.8/site-packages/tensorflow-plugins/libmetal_plugin.dylib\r\n  Expected in: flat namespace\r\n\r\nIn [3]: quit()\r\n(tensorflow-metal) (base) davidlaxer@x86_64-apple-darwin13 notebooks % nm -n /Users/davidlaxer/tensorflow-metal/lib/python3.8/site-packages/tensorflow-plugins/libmetal_plugin.dylib | grep  _TF_AssignUpdateVariable\r\n\r\n                 U _TF_AssignUpdateVariable\r\n```\r\n\r\nso, I've stuck with:\r\ntf 2.4.0-rc0\r\nnp 1.19.1\r\nhub 0.8.0\r\n2. in Eager Mode is see when I try to change to GPU.\r\nE.g. \r\n```\r\nrom tensorflow.python.compiler.mlcompute import mlcompute\r\nmlcompute.set_mlc_device(device_name='gpu')\r\nprint(\"is_apple_mlc_enabled %s\" % mlcompute.is_apple_mlc_enabled())\r\nprint(\"is_tf_compiled_with_apple_mlc %s\" % mlcompute.is_tf_compiled_with_apple_mlc())\r\nWARNING:tensorflow:Eager mode uses the CPU. Switching to the CPU.\r\nis_apple_mlc_enabled True\r\nis_tf_compiled_with_apple_mlc True\r\n```\r\n3. Can TF 'eager mode' utilize the GPU with 2.5 or versions other then tensorflow_mac (e.g. 2.4.0-rc0)?", "I ran Jax lib tests on this version of tensorflow_mac and had related error(s):\r\nE.g.\r\n>     return ops.EagerTensor(value, ctx.device_name, dtype)\r\nE     ValueError: Failed to convert a NumPy array to a Tensor (Unsupported numpy type: NPY_USERDEF).\r\n\r\n```\r\nIn [2]: print(tensorflow.__version__)\r\n2.4.0-rc0\r\n\r\nJAX_ENABLE_X64=1 JAX_NUM_GENERATED_CASES=25 pytest -n auto tests\r\n\r\n=================================== FAILURES ===================================\r\n__________________ DLPackTest.testTensorFlowToJax_bfloat16[] ___________________\r\n[gw7] darwin -- Python 3.8.5 /Users/davidlaxer/anaconda3/envs/tensorflow_mac/bin/python\r\n\r\nself = <array_interoperability_test.DLPackTest testMethod=testTensorFlowToJax_bfloat16[]>\r\nshape = (), dtype = <class 'jax._src.numpy.lax_numpy.bfloat16'>\r\n\r\n    @parameterized.named_parameters(jtu.cases_from_list(\r\n       {\"testcase_name\": \"_{}\".format(\r\n          jtu.format_shape_dtype_string(shape, dtype)),\r\n       \"shape\": shape, \"dtype\": dtype}\r\n       for shape in all_shapes\r\n       for dtype in dlpack_dtypes))\r\n    @unittest.skipIf(not tf, \"Test requires TensorFlow\")\r\n    def testTensorFlowToJax(self, shape, dtype):\r\n      if not config.x64_enabled and dtype in [jnp.int64, jnp.uint64, jnp.float64]:\r\n        raise self.skipTest(\"x64 types are disabled by jax_enable_x64\")\r\n      if (jtu.device_under_test() == \"gpu\" and\r\n          not tf.config.list_physical_devices(\"GPU\")):\r\n        raise self.skipTest(\"TensorFlow not configured with GPU support\")\r\n    \r\n      if jtu.device_under_test() == \"gpu\" and dtype == jnp.int32:\r\n        raise self.skipTest(\"TensorFlow does not place int32 tensors on GPU\")\r\n    \r\n      rng = jtu.rand_default(self.rng())\r\n      np = rng(shape, dtype)\r\n      with tf.device(\"/GPU:0\" if jtu.device_under_test() == \"gpu\" else \"/CPU:0\"):\r\n>       x = tf.identity(tf.constant(np))\r\n\r\ntests/array_interoperability_test.py:119: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:264: in constant\r\n    return _constant_impl(value, dtype, shape, name, verify_shape=False,\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:276: in _constant_impl\r\n    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:301: in _constant_eager_impl\r\n    t = convert_to_eager_tensor(value, ctx, dtype)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nvalue = array(-1.97656, dtype=bfloat16)\r\nctx = <tensorflow.python.eager.context.Context object at 0x7f97090f7310>\r\ndtype = None\r\n\r\n    def convert_to_eager_tensor(value, ctx, dtype=None):\r\n      \"\"\"Converts the given `value` to an `EagerTensor`.\r\n    \r\n      Note that this function could return cached copies of created constants for\r\n      performance reasons.\r\n    \r\n      Args:\r\n        value: value to convert to EagerTensor.\r\n        ctx: value of context.context().\r\n        dtype: optional desired dtype of the converted EagerTensor.\r\n    \r\n      Returns:\r\n        EagerTensor created from value.\r\n    \r\n      Raises:\r\n        TypeError: if `dtype` is not compatible with the type of t.\r\n      \"\"\"\r\n      if isinstance(value, ops.EagerTensor):\r\n        if dtype is not None and value.dtype != dtype:\r\n          raise TypeError(\"Expected tensor with type %r not %r\" % (\r\n              dtype, value.dtype))\r\n        return value\r\n      if dtype is not None:\r\n        try:\r\n          dtype = dtype.as_datatype_enum\r\n        except AttributeError:\r\n          dtype = dtypes.as_dtype(dtype).as_datatype_enum\r\n      ctx.ensure_initialized()\r\n>     return ops.EagerTensor(value, ctx.device_name, dtype)\r\nE     ValueError: Failed to convert a NumPy array to a Tensor (Unsupported numpy type: NPY_USERDEF).\r\n\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:98: ValueError\r\n________________ DLPackTest.testTensorFlowToJax_bfloat16[2,3,4] ________________\r\n[gw6] darwin -- Python 3.8.5 /Users/davidlaxer/anaconda3/envs/tensorflow_mac/bin/python\r\n\r\nself = <array_interoperability_test.DLPackTest testMethod=testTensorFlowToJax_bfloat16[2,3,4]>\r\nshape = (2, 3, 4), dtype = <class 'jax._src.numpy.lax_numpy.bfloat16'>\r\n\r\n    @parameterized.named_parameters(jtu.cases_from_list(\r\n       {\"testcase_name\": \"_{}\".format(\r\n          jtu.format_shape_dtype_string(shape, dtype)),\r\n       \"shape\": shape, \"dtype\": dtype}\r\n       for shape in all_shapes\r\n       for dtype in dlpack_dtypes))\r\n    @unittest.skipIf(not tf, \"Test requires TensorFlow\")\r\n    def testTensorFlowToJax(self, shape, dtype):\r\n      if not config.x64_enabled and dtype in [jnp.int64, jnp.uint64, jnp.float64]:\r\n        raise self.skipTest(\"x64 types are disabled by jax_enable_x64\")\r\n      if (jtu.device_under_test() == \"gpu\" and\r\n          not tf.config.list_physical_devices(\"GPU\")):\r\n        raise self.skipTest(\"TensorFlow not configured with GPU support\")\r\n    \r\n      if jtu.device_under_test() == \"gpu\" and dtype == jnp.int32:\r\n        raise self.skipTest(\"TensorFlow does not place int32 tensors on GPU\")\r\n    \r\n      rng = jtu.rand_default(self.rng())\r\n      np = rng(shape, dtype)\r\n      with tf.device(\"/GPU:0\" if jtu.device_under_test() == \"gpu\" else \"/CPU:0\"):\r\n>       x = tf.identity(tf.constant(np))\r\n\r\ntests/array_interoperability_test.py:119: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:264: in constant\r\n    return _constant_impl(value, dtype, shape, name, verify_shape=False,\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:276: in _constant_impl\r\n    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:301: in _constant_eager_impl\r\n    t = convert_to_eager_tensor(value, ctx, dtype)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nvalue = array([[[0.453125, -3.59375, 5.8125, -4.4375],\r\n        [0.265625, 0.71875, -1.67188, 2.625],\r\n        [-1.36719, -5.812...0.11377],\r\n        [2.875, -1.6875, -3.21875, -1.64062],\r\n        [-2.40625, -1.46875, 2.125, 1.57031]]], dtype=bfloat16)\r\nctx = <tensorflow.python.eager.context.Context object at 0x7fc30851b9a0>\r\ndtype = None\r\n\r\n    def convert_to_eager_tensor(value, ctx, dtype=None):\r\n      \"\"\"Converts the given `value` to an `EagerTensor`.\r\n    \r\n      Note that this function could return cached copies of created constants for\r\n      performance reasons.\r\n    \r\n      Args:\r\n        value: value to convert to EagerTensor.\r\n        ctx: value of context.context().\r\n        dtype: optional desired dtype of the converted EagerTensor.\r\n    \r\n      Returns:\r\n        EagerTensor created from value.\r\n    \r\n      Raises:\r\n        TypeError: if `dtype` is not compatible with the type of t.\r\n      \"\"\"\r\n      if isinstance(value, ops.EagerTensor):\r\n        if dtype is not None and value.dtype != dtype:\r\n          raise TypeError(\"Expected tensor with type %r not %r\" % (\r\n              dtype, value.dtype))\r\n        return value\r\n      if dtype is not None:\r\n        try:\r\n          dtype = dtype.as_datatype_enum\r\n        except AttributeError:\r\n          dtype = dtypes.as_dtype(dtype).as_datatype_enum\r\n      ctx.ensure_initialized()\r\n>     return ops.EagerTensor(value, ctx.device_name, dtype)\r\nE     ValueError: Failed to convert a NumPy array to a Tensor (Unsupported numpy type: NPY_USERDEF).\r\n\r\n../anaconda3/envs/tensorflow_mac/lib/python3.8/site-packages/tensorflow/python/framework/constant_op.py:98: ValueError\r\n=========================== short test summary info ============================\r\nFAILED tests/array_interoperability_test.py::DLPackTest::testTensorFlowToJax_bfloat16[]\r\nFAILED tests/array_interoperability_test.py::DLPackTest::testTensorFlowToJax_bfloat16[2,3,4]\r\n=========== 2 failed, 25095 passed, 815 skipped in 595.09s (0:09:55) ===========\r\n(tensorflow_mac) davidlaxer@x86_64-apple-darwin13 jax % \r\n\r\n```", "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50353\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50353\">No</a>\n"]}, {"number": 50352, "title": "Applying MKL Eager Rewriter to CPU Ops", "body": "Registers the MKL eager rewriter for the POST_PLACEMENT phase, allowing its selective application to ops assigned to a CPU.", "comments": ["@philipphack This is causing the test mkl_eager_op_rewrite_test to fail. Can you take a look? Command to reproduce:\r\nbazel --config=mkl -c opt //tensorflow/core/common_runtime/eager:mkl_eager_op_rewrite_test\r\nThe change seems to be fine but you may need to add POST_PLACEMENT [here](https://github.com/tensorflow/tensorflow/blob/3e182f12fe6be0e30b18d48b68b5aa478b169f37/tensorflow/core/common_runtime/eager/mkl_eager_op_rewrite_test.cc#L64) and [here](https://github.com/tensorflow/tensorflow/blob/3e182f12fe6be0e30b18d48b68b5aa478b169f37/tensorflow/core/common_runtime/eager/execute.cc#L1495).", "@mahmoud-abuzaina: Thanks for the note. After modifying the test to run the rewriters for the POST_PLACEMENT phase, the float part passes, but I still see failures for the bfloat16 portion. Possibly something you might want to investigate. ", "@philipphack Thanks for making the change. Bfloat16 is probably coming because CPU was used does not support that data type. That is expected. The PR looks ok to me now.", "CC @penpornk "]}, {"number": 50351, "title": "Tensorflow master build fails on s390x arch due to boringssl issues", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version:\r\n- Python version:\r\n- Installed using virtualenv? pip? conda?:\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n", "comments": ["The problem seems to occur when `@boringssl//crypto` build is triggered.  As per this [issue](https://github.com/tensorflow/tensorflow/issues/14039) - this should not happen when `aws` build is disabled.  However, it seem that somehow a new `boringssl` dependency is introduced somewhere in the recent build causing this problem to resurface.\r\n\r\nHere is the command used to trigger the build:\r\n```\r\n/home/tensorflow# bazel --host_jvm_args=\"-Xms1024m\" --host_jvm_args=\"-Xmx2048m\" build  --define=tensorflow_mkldnn_contraction_kernel=0 --config=noaws //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\nThe resulting error is:\r\n```\r\nINFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (1 packages loaded, 3997 targets configured).\r\nINFO: Found 1 target...\r\nERROR: /root/.cache/bazel/_bazel_root/334416e3a0381b53511e68de49f4ac07/external/boringssl/BUILD:130:11: C++ compilation of rule '@boringssl//:crypto' failed (Exit 1): gcc failed: error executing command /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections ... (remaining 24 argument(s) skipped)\r\nIn file included from external/boringssl/err_data.c:17:0:\r\nexternal/boringssl/src/include/openssl/base.h:122:2: error: #error \"Unknown target CPU\"\r\n #error \"Unknown target CPU\"\r\n  ^~~~~\r\n```\r\n\r\nIs there any other way of disabling `S3/AWS` dependencies from the build?\r\n\r\nThanks.\r\n", "Apologies for not completing the `System Information` section as it was left out due to premature save:\r\n```\r\n    OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n    Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n    TensorFlow installed from (source or binary): Source\r\n    TensorFlow version: 2.5.0\r\n    Python version: 3.6.9\r\n    Installed using virtualenv? pip? conda?: N/A\r\n    Bazel version (if compiling from source): bazel 3.7.2- (@non-git)\r\n    GCC/Compiler version (if compiling from source): gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0\r\n    CUDA/cuDNN version: N/A\r\n    GPU model and memory: N/A\r\n```", "This appears fixed in latest master branch. Closing.", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50351\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50351\">No</a>\n"]}, {"number": 50350, "title": "'tf distributed'", "body": "- Deprecated decorator to all methods", "comments": []}, {"number": 50349, "title": "Conv2D fails with sparse input", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):  Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Centos7\r\n- TensorFlow installed from (source or binary):  Conda install\r\n- TensorFlow version (use command below):  2.5.0-rc3\r\n- Python version: 3.7.5\r\n\r\nI'm not certain if this is a bug or missing feature?  Trying to run sparse data through convolutional layer, but error immediately results:\r\n\r\n```\r\nx = keras.Input(shape=(100,100,2), sparse=True)                        \r\nC = keras.layers.Conv2D(16,(3,3))(x)  \r\n```\r\nError as follows:\r\n\r\n`TypeError: Failed to convert object of type <class 'tensorflow.python.framework.sparse_tensor.SparseTensor'> to Tensor. Contents: SparseTensor(indices=Tensor(\"Placeholder_1:0\", shape=(None, 4), dtype=int64), values=Tensor(\"Placeholder:0\", shape=(None,), dtype=float32), dense_shape=Tensor(\"PlaceholderWithDefault:0\", shape=(4,), dtype=int64)). Consider casting elements to a supported type.`\r\n\r\n\r\n\r\n\r\n", "comments": ["@Mastiff37 \r\nCould you please provide complete code/colab gist in order to expedite the trouble-shooting process.\r\nalso refer similar  [issue](https://github.com/tensorflow/models/issues/6245) and let us know if it helps.Thanks", "All it takes to create the error is to enter those two lines, for example in an ipython terminal.  Do you need more than that?  Because I never got beyond that myself.  Thanks.", "@Mastiff37 \r\n\r\nCould you please refer [this](https://github.com/tensorflow/tensorflow/issues/25980),and let us know if it helps.Thanks\r\n", "Thanks for the reply.  I don't see anything there that exactly applies.  Are you referring to the solutions where the input is manually converted to dense before use?", "@jvishnuvardhan \r\n\r\nI was able to replicate the issue reported.Please find the [gist](https://colab.research.google.com/gist/UsharaniPagadala/286ecb2930df1be64e9743b5bb63566e/untitled117.ipynb#scrollTo=rsUYR9Nhr5p0) here.Thanks", "@Mastiff37 I think `sparse` input is not supported. Some other layers like `Dense` supports `sparse` tensors. You could convert sparse tensors into dense tensors and pass it to the `Conv` layers. Thanks!\r\n\r\nhttps://www.tensorflow.org/guide/sparse_tensor", "Understood.  The desired use case is one in which processing the non-sparse version is impractical.  But maybe this is a feature request rather than an issue.  Or maybe the issue is that a more helpful error message could be provided, indicating lack of support?", "@Mastiff37 Recently keras team improved `layers.preprocessing` code. If the current preprocessing layers are not supporting, then please raise an issue in [keras-team/keras](https://github.com/keras-team/keras/issues). Please note that Keras development moved to another repository to focus entirely on only keras. \r\n\r\nWhen you open a new issue, please provide a standalone code with some toy data to test and understand the issue. Thanks!", "Agree with you on the error message. Will try to update it. Thanks!", "Are you satisfied with the resolution of your issue?\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50349\">Yes</a>\n<a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/50349\">No</a>\n"]}]