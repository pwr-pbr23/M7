[{"number": 22176, "title": "seq2seq.dynamic_decode with float16 inputs on CPU", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Manjaro Linux, testing\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: nice\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.7.0\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: 7.3.1\r\n- **CUDA/cuDNN version**: cuda 9.2.148, cudnn 7.2.1\r\n- **GPU model and memory**: gtx 1080\r\n- **Exact command to reproduce**:\r\nI am using my own setup here:\r\nhttps://github.com/georgesterpu/Sigmedia-AVSR/blob/master/experiment_tcd_audio.py\r\nIf really needed, I could write a minimal example to reproduce the issue.\r\n\r\n### Describe the problem\r\nI have an issue with the code indicated above, when switching to 16 bit precision.\r\nOn the CPU only, the code crashes with the following error:\r\n\r\n```\r\nInvalidArgumentError (see above for traceback): indices[0] = 31 is not in [0, 31)\r\n\t [[Node: Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup/Switch, Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/GatherNd, Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup/axis)]]\r\n``` \r\nThis is supposed to be the embedding lookup of the input ids to a `seq2seq.BasicDecoder` taking a `seq2seq.ScheduledEmbeddingTrainingHelper`. I first created the embedding matrix in float16, then passed it to the `embedding` argument. As a workaround, I've also created it in float32, passing instead a callable that would cast the retrieved vectors to float16, but the error persists.\r\n\r\nThe number `31` is the size of the vocabulary, and no id is above 30. However, even if I increase the size of the embedding matrix, the error would look like this:\r\n`indices[0] = 132 is not in [0, 132)`\r\n\r\nThe same code runs fine on GPU, but I am aware that error reporting is restricted in this case. \r\n\r\nCould you please help me find out where is the problem and how to fix it ?\r\nIs `seq2seq.dynamic_decode` fully supporting float16 data types ?\r\n\r\nThank you\r\n\r\n\r\n### Source code / logs\r\n```\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py\", line 322, in dynamic_decode\r\n    swap_memory=swap_memory)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3232, in while_loop\r\n    return_same_structure)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2952, in BuildLoop\r\n    pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2887, in _BuildLoop\r\n    body_result = body(*packed_vars_for_body)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py\", line 265, in body\r\n    decoder_finished) = decoder.step(time, inputs, state)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/basic_decoder.py\", line 146, in step\r\n    sample_ids=sample_ids)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/helper.py\", line 351, in next_inputs\r\n    all_finished, lambda: base_next_inputs, maybe_sample)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2057, in cond\r\n    orig_res_f, res_f = context_f.BuildCondBranch(false_fn)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1895, in BuildCondBranch\r\n    original_result = fn()\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/helper.py\", line 340, in maybe_sample\r\n    sampled_next_inputs = self._embedding_fn(sample_ids_sampling)\r\n  File \"/run/media/john_tukey/work/phd/65.cleanavsr/Sigmedia-AVSR/avsr/decoder_unimodal.py\", line 454, in <lambda>\r\n    embedding_fun = lambda ids: tf.cast(tf.nn.embedding_lookup(self._embedding_matrix, ids), dtype=self._hparams.dtype)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/embedding_ops.py\", line 310, in embedding_lookup\r\n    transform_fn=None)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/embedding_ops.py\", line 133, in _embedding_lookup_and_transform\r\n    result = _clip(array_ops.gather(params[0], ids, name=name),\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py\", line 2659, in gather\r\n    return gen_array_ops.gather_v2(params, indices, axis, name=name)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 3142, in gather_v2\r\n    \"GatherV2\", params=params, indices=indices, axis=axis, name=name)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): indices[0] = 31 is not in [0, 31)\r\n\t [[Node: Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_HALF, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup/Switch, Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/GatherNd, Decoder/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperNextInputs/cond/embedding_lookup/axis)]]\r\n```\r\n", "comments": ["A similar issue in keras: https://github.com/keras-team/keras/issues/10531", "I have spotted the error, and it is not related to `dynamic_decode`.\r\nIt is apparently related to the Adam optimiser and its default value for the `epsilon` parameter, `1e-8`.\r\nPerhaps `dynamic_decode` is called with unexpected inputs after the first batch is processed."]}, {"number": 22175, "title": "Fix np.float -> np.floating change", "body": "While running core_rnn_cell_test:\r\n```\r\nbazel test -s --verbose_failures --config=opt //tensorflow/contrib/rnn:core_rnn_cell_test\r\n```\r\nNoticed the following warning:\r\n```\r\nFutureWarning: Conversion of the second argument of issubdtype from\r\n`float` to `np.floating` is deprecated. In future, it will be treated\r\nas `np.float64 == np.dtype(float).type`.\r\n```\r\n\r\nThis fix fixes the above warning.\r\n\r\nSigned-off-by: Yong Tang <yong.tang.github@outlook.com>", "comments": []}, {"number": 22174, "title": "tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1", "body": "I'm running a model Lda2vec_tensorflow on a Mac with Tensorflow 1.8 in an anaconda 3.6 virtual environment.  The model runs properly without trying to attach the tensor board debugger.\r\nWhen I attach the debugger I get an abort signal.\r\n\r\n**Have I written custom code**\r\nNo\r\n**OS Platform and Distribution**\r\nOS X 10.11.6\r\n\r\n**TensorFlow installed from**\r\n```\r\n$ conda list tensorflow\r\n# packages in environment at /Users/davidlaxer/anaconda/envs/ai:\r\n#\r\n# Name                    Version                   Build  Channel\r\ntensorflow                1.8.0                    py36_1    condo-forge\r\n```\r\n**TensorFlow version**\r\n1.8.0\r\n\r\n**Bazel version**\r\n[bazel release 0.14.0]\r\n\r\n**CUDA/cuDNN version**\r\nN/A\r\n\r\n**GPU model and memory**\r\nN/A\r\n\r\n**Exact command to reproduce**\r\n```\r\n/Users/davidlaxer/anaconda/envs/ai/bin/python /Applications/PyCharm.app/Contents/helpers/pydev/pydevd.py --multiproc --qt-support=auto --client 127.0.0.1 --port 51376 --file /Users/davidlaxer/Lda2vec-Tensorflow/run_stories.py\r\npydev debugger: process 91253 is connecting\r\n\r\nConnected to pydev debugger (build 182.4129.34)\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n95 ops no flops stats due to incomplete shapes.\r\n```\r\n\r\nNext, click STEP in tensor board debugger:\r\n```\r\n2018-09-10 10:27:19.544078: F tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1\r\nProcess finished with exit code 134 (interrupted by signal 6: SIGABRT)\r\n```\r\n\r\n**Mobile device**\r\nN/A\r\n\r\nHere's my environment:\r\n```\r\n$ cat tf_env.txt \r\n\r\n== cat /etc/issue ===============================================\r\nDarwin David-Laxers-MacBook-Pro.local 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 21 20:07:40 PDT 2018; root:xnu-3248.73.11~1/RELEASE_X86_64 x86_64\r\nMac OS X 10.11.6\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nApple LLVM version 8.0.0 (clang-800.0.42.1)\r\nTarget: x86_64-apple-darwin15.6.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n\r\n== uname -a =====================================================\r\nDarwin David-Laxers-MacBook-Pro.local 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 21 20:07:40 PDT 2018; root:xnu-3248.73.11~1/RELEASE_X86_64 x86_64\r\n\r\n== check pips ===================================================\r\nmsgpack-numpy       0.4.3     \r\nnumpy               1.14.5    \r\nprotobuf            3.6.0     \r\ntensorflow          1.8.0     \r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.8.0\r\ntf.GIT_VERSION = b'v1.8.0-8-g23c2187'\r\ntf.COMPILER_VERSION = b'v1.8.0-8-g23c2187'\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./tf_env_collect.sh: line 105: nvidia-smi: command not found\r\n\r\n\r\n\r\n== cuda libs  ===================================================\r\n(ai) David-Laxers-MacBook-Pro:tools davidlaxer$ \r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\nb'v1.8.0-8-g23c2187' 1.8.0\r\n```\r\n\r\nI'm trying to use the tensorboard debugger to debug the github model Lda2vec_tensorflow model.\r\nI am able to attach the tensorboard debugger to the model, however, when I click 'step' or 'continue,\r\nthe process running the model exits with the following error message :\r\n\r\n95 ops no flops stats due to incomplete shapes.\r\n2018-09-09 11:07:02.150246: F tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1\r\n\r\nProcess finished with exit code 134 (interrupted by signal 6: SIGABRT)\r\n\r\n\r\n### Source code / logs\r\n\r\nThe code to run the Lda2vec_Tensorflow model is here:\r\n\r\nhttps://github.com/nateraw/Lda2vec-Tensorflow\r\n\r\nHere is the code that I use to invoke the tensor board debugger.\r\n\r\nI use port 60664 to attach the debugger:\r\n```\r\nself.sesh = tf.Session(config=self.config)\r\nself.sesh = tf_debug.TensorBoardDebugWrapperSession(self.sesh, 'localhost:6064')\r\n...\r\nrun_metadata = tf.RunMetadata()\r\nself.sesh.run(tf.global_variables_initializer(), options=tf.RunOptions(trace_level=tf.RunOptions.FULL_TRACE, report_tensor_allocations_upon_oom=True),\r\n               run_metadata=run_metadata)\r\n```\r\n![screen shot 2018-09-09 at 11 07 05 am](https://user-images.githubusercontent.com/3105499/45267642-12fa8e00-b425-11e8-8687-abee65c7f1be.png)", "comments": ["Thank you for your post. We noticed you have not filled out the following field in the issue template. Could you update them if they are relevant in your case, or leave them as N/A? Thanks.\nHave I written custom code\nOS Platform and Distribution\nTensorFlow installed from\nTensorFlow version\nBazel version\nCUDA/cuDNN version\nGPU model and memory\nExact command to reproduce\nMobile device", "Thanks for pointing out the missing items for the template.  I have updated the issue.", "I updated the incident with the requested template fields.  Is anything missing?", "@dbl001 Is this still an issue ? We see that you are using old version of tensorflow  1.x which is not actively supported, We recommend that you upgrade to 2.4 or later version and let us know if the issue still persists in newer versions .Please open a new issue in case you face any errors in TF v2, we will get you the right help . Thanks!", "This issue has been automatically marked as stale because it has no recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n"]}, {"number": 22173, "title": "Make BeamSearchDecoder compatible with float16", "body": "Make BeamSearchDecoder compatible with float16 when a non-zero `length_penalty_weight` is used.\r\nAddresses #22172", "comments": ["Nagging Assignee @yifeif: It has been 45 days with no activity and this issue has an assignee. Please update the label and/or status accordingly."]}, {"number": 22172, "title": "seq2seq.BeamSearchDecoder incompatible with float16", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Manjaro Linux, testing\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.7.0\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: 7.3.1\r\n- **CUDA/cuDNN version**: cuda 9.2.148, cudnn 7.2.1\r\n- **GPU model and memory**: gtx 1080\r\n- **Exact command to reproduce**:\r\nI am using my own setup here:\r\nhttps://github.com/georgesterpu/Sigmedia-AVSR/blob/master/experiment_tcd_audio.py\r\nIf really needed, I could write a minimal example to reproduce the issue.\r\n\r\n### Describe the problem\r\nI want to add support for 16 bit precision to our TensorFlow-based speech recognition system.\r\nIt looks like `seq2seq.BeamSearchDecoder` is not compatible with this data type when using the `length_penalty_weight` option. This is because the `_get_scores` function in `beam_search_decoder.py`  has to compute a division between a float16 tensor and the float32 tensor returned by the `_length_penalty` function.\r\n\r\n### Source code / logs\r\n\r\n>   File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py\", line 322, in dynamic_decode\r\n    swap_memory=swap_memory)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3232, in while_loop\r\n    return_same_structure)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2952, in BuildLoop\r\n    pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2887, in _BuildLoop\r\n    body_result = body(*packed_vars_for_body)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3201, in <lambda>\r\n    body = lambda i, lv: (i + 1, orig_body(*lv))\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py\", line 265, in body\r\n    decoder_finished) = decoder.step(time, inputs, state)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\", line 658, in step\r\n    length_penalty_weight=length_penalty_weight)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\", line 720, in _beam_search_step\r\n    length_penalty_weight=length_penalty_weight)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\", line 824, in _get_scores\r\n    return log_probs / length_penalty_\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py\", line 850, in binary_op_wrapper\r\n    return func(x, y, name=name)\r\n  File \"/usr/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py\", line 950, in _truediv_python3\r\n    (x_dtype, y_dtype))\r\nTypeError: x and y must have the same dtype, got tf.float16 != tf.float32\r\n", "comments": ["Sorry, I don't  know this code."]}, {"number": 22171, "title": "Elements of a CsvDataset should be tensors instead of tuples", "body": "------------------------\r\n\r\n### System information\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **Yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Linux Ubuntu 18.04**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **No**\r\n- TensorFlow installed from (source or binary): **source**\r\n- TensorFlow version (use command below): **1.10**\r\n- Python version: **3.6**\r\n- Bazel version (if compiling from source): **0.16.1**\r\n- GCC/Compiler version (if compiling from source): **7.3.0**\r\n- CUDA/cuDNN version: **N/A**\r\n- GPU model and memory: **N/A**\r\n- Exact command to reproduce:\r\n\r\n### Describe the problem\r\nAccording to the [tf.data.Dataset](https://www.tensorflow.org/api_docs/python/tf/data/Dataset) documentation, the elements of a generated dataset are expected to be tensors or sparse tensors. But when you create a [CsvDataset](https://www.tensorflow.org/api_docs/python/tf/contrib/data/CsvDataset), the elements are tuples. As a result, the dataset methods behave strangely.\r\n\r\n### Source code / logs\r\nAssume the file example.csv contains this text:\r\n```\r\n1.0,2.0,3.0\r\n4.0,5.0,6.0\r\n```\r\n\r\nThis code creates a CsvDataset and calls batch to combine elements into batches:\r\n```\r\nds1 = tf.contrib.data.CsvDataset('example.csv', [tf.float32, tf.float32, tf.float32])\r\nds2 = ds1.batch(2)\r\niter = ds2.make_one_shot_iterator()\r\nwith tf.Session() as sess:\r\n    while True:            \r\n        try:\r\n          print(sess.run(iter.get_next()))\r\n        except tf.errors.OutOfRangeError:\r\n          break\r\n```\r\n\r\nThe application prints the following result for ds2:\r\n```(array([1., 4.], dtype=float32), array([2., 5.], dtype=float32), array([3., 6.], dtype=float32))```\r\n\r\nThe elements don't form expected batches because the elements of ds1 are tuples instead of tensors.\r\n", "comments": ["Can you clarify what batching behavior you expect here?", "@mattscar ", "Nagging Assignee @rachellim: It has been 44 days with no activity and this issue has an assignee. Please update the label and/or status accordingly.", "Automatically closing due to lack of recent activity. Please update the issue when new information becomes available, and we will reopen the issue. Thanks!\r\n"]}, {"number": 22170, "title": "edited flat_map description and removed typo", "body": "The examples in interleave are quite helpful. I just added a reference to this example for flat_map", "comments": ["@MarkDaoust I edited the description", "I can't merge this without @mrry's approval, so I'll leave it to him to have a look.", "@mrry Thanks for the feedback. I implemented the suggestions"]}, {"number": 22169, "title": "Possible bug when getting the gradient of unstack", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n\r\nUbuntu 18.04\r\n\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nn/a\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\nbinary\r\n\r\n- **TensorFlow version (use command below)**:\r\n\r\nv1.8.0-0-g93bc2e2072 1.8.0\r\n\r\n- **Python version**: Python 3.6.5\r\n- **Bazel version (if compiling from source)**: n/a\r\n- **GCC/Compiler version (if compiling from source)**: n/a\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**: GeForce 1060 6GB\r\n- **Exact command to reproduce**:\r\n\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\nUnable to get the gradient of unstack:\r\n\r\na = tf.constant([[[[0, 8], [1, 9]], [[2, 10], [3, 11]]], [[[4, 12], [5, 13]], [[6, 14], [7, 15]]]])\r\nx, y = tf.unstack(a, axis=3)\r\ng = tf.gradients(x, [a])\r\nsess = tf.Session()\r\nsess.run(g)\r\n\r\nExpected: [[[[[1, 0], [1, 0]], [[1, 0], [1, 0]]], [[[1, 0], [1, 0]], [[1, 0], [1, 0]]]]]\r\n\r\nActual: TypeError: Tensors in list passed to 'values' of 'Pack' Op have types [int32, <NOT CONVERTIBLE TO TENSOR>] that don't all match.\r\n\r\n### Source code / logs\r\n\r\n\r\n\r\n\r\n", "comments": ["@jedld I think you may need to pass a float32 type to `a`:\r\n```\r\na = tf.constant([[[[0, 8], [1, 9]], [[2, 10], [3, 11]]],\r\n                 [[[4, 12], [5, 13]], [[6, 14], [7, 15]]]], tf.float32)\r\n```", "Thanks, I didn't realize it might have issues with int32 data type. II'll close this for now"]}, {"number": 22168, "title": "tensorflow.python.framework.errors_impl.NotFoundError: C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\data\\python\\ops\\..\\..\\_dataset_ops.so not found", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\n- **TensorFlow version (use command below)**:\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n", "comments": ["Traceback (most recent call last):\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2963, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-676782b4ecf9>\", line 1, in <module>\r\n    runfile('C:/Users/Administrator/.PyCharm2018.2/config/scratches/Mnist \u6570\u636e\u96c6.py', wdir='C:/Users/Administrator/.PyCharm2018.2/config/scratches')\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_umd.py\", line 197, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"C:/Users/Administrator/.PyCharm2018.2/config/scratches/Mnist \u6570\u636e\u96c6.py\", line 5, in <module>\r\n    import input_data\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py\", line 20, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\input_data.py\", line 13, in <module>\r\n    from tensorflow.contrib.learn.python.learn.datasets.mnist import read_data_sets\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py\", line 20, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\__init__.py\", line 36, in <module>\r\n    from tensorflow.contrib import data\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py\", line 20, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\data\\__init__.py\", line 71, in <module>\r\n    from tensorflow.contrib.data.python.ops.error_ops import ignore_errors\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py\", line 20, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\data\\python\\ops\\error_ops.py\", line 20, in <module>\r\n    from tensorflow.contrib.data.python.ops import contrib_op_loader  # pylint: disable=unused-import\r\n  File \"C:\\PyCharm 2018.2.2\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py\", line 20, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\data\\python\\ops\\contrib_op_loader.py\", line 24, in <module>\r\n    resource_loader.get_path_to_datafile(\"../../_dataset_ops.so\"))\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\util\\loader.py\", line 56, in load_op_library\r\n    ret = load_library.load_op_library(path)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\load_library.py\", line 56, in load_op_library\r\n    lib_handle = py_tf.TF_LoadLibrary(library_filename)\r\ntensorflow.python.framework.errors_impl.NotFoundError: C:\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\data\\python\\ops\\..\\..\\_dataset_ops.so not found\r\n", "I just want to use\"import input_data\"but.....", "I have 'input_data.py' ,but how to install I don't know. I tried \u201cpip install input_data\" and \"conda install input_data\".\r\n", "but, \"pip install input_data\"\r\n\"Collecting input_data\r\n  Could not find a version that satisfies the requirement input_data (from versions: )\r\nNo matching distribution found for input_data\"\r\nThat's what the computer says.", "and,\"conda install input_data\"\r\nPackagesNotFoundError: The following packages are not available from current channels:\r\n\r\n  - input_data\r\n\r\nCurrent channels:\r\n\r\n  - https://conda.anaconda.org/conda-forge/win-64\r\n  - https://conda.anaconda.org/conda-forge/noarch\r\n  - https://repo.anaconda.com/pkgs/main/win-64\r\n  - https://repo.anaconda.com/pkgs/main/noarch\r\n  - https://repo.anaconda.com/pkgs/free/win-64\r\n  - https://repo.anaconda.com/pkgs/free/noarch\r\n  - https://repo.anaconda.com/pkgs/r/win-64\r\n  - https://repo.anaconda.com/pkgs/r/noarch\r\n  - https://repo.anaconda.com/pkgs/pro/win-64\r\n  - https://repo.anaconda.com/pkgs/pro/noarch\r\n  - https://repo.anaconda.com/pkgs/msys2/win-64\r\n  - https://repo.anaconda.com/pkgs/msys2/noarch\r\n\r\nTo search for alternate channels that may provide the conda package you're\r\nlooking for, navigate to\r\n\r\n    https://anaconda.org\r\n", "What should I do\uff1fcan you help me?", "Nagging Assignee @tatianashp: It has been 30 days with no activity and this issue has an assignee. Please update the label and/or status accordingly.", "Sorry it fell through the cracks. It has been a while so I presume you found a way to work around the issue. If not, please reopen and fill all the information in the template. ", "I have also meet this problem, but I cannot find the _dataset_ops.so file in the E:\\ProgramData\\Anaconda3\\Lib\\site-packages\\tensorflow\\contrib\\ directory. Can any body help me? Thanks."]}, {"number": 22167, "title": "tensorflow/contrib/lite/examples/android/BUILD/android-profile is not a directory", "body": "Hi there. I have installed the latest version of tensorflow and trained SSD quantized model following [this article](https://medium.com/tensorflow/training-and-serving-a-realtime-mobile-object-detector-in-30-minutes-with-cloud-tpus-b78971cf1193) very precisely. After the training was successfully done, I've decided to run the android tflite example project to check how my model (frozen graph) will work with it. I've installed 14b NDK version as it was recommended and I have API level 27.\r\n\r\nThen I run \r\n```\r\nbazel build -c opt --config=android_arm{,64} --cxxopt='--std=c++11' \\\r\n//tensorflow/contrib/lite/examples/android:tflite_demo\r\n```\r\nAnd it compiled successfully without errors. But when I opened the project with Android Studio, I can't sync it with Gradle because there is an error I mentioned above (I will add the screenshot). After any attempts of re-build it says: \"Sync failed. Already finished\"\r\n\r\n<img width=\"830\" alt=\"2018-09-09 10 48 54\" src=\"https://user-images.githubusercontent.com/4061805/45262560-96b27b80-b421-11e8-91c0-ac32e95d1b38.png\">\r\n\r\nWhat should I do?\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: no\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: macOS High Sierra 10.13.4\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.6.4\r\n- **Bazel version (if compiling from source)**: 0.15.2-homebrew\r\n- **GPU model and memory**: Intel Iris Graphics 6100 / 1536 MB\r\n", "comments": ["Nice", "Thanks", "@kate-kate Did you figure it out? I have the same problem with Android Studio (on windows 10)", "@Elites2017 I have just built it on remote pure server and installed files with adb as it was described in [article](https://medium.com/tensorflow/training-and-serving-a-realtime-mobile-object-detector-in-30-minutes-with-cloud-tpus-b78971cf1193)", "@kate-kate I followed the article, but i ended up with the following error:\r\n**Failure [INSTALL_FAILED_NO_MATCHING_ABIS: Failed to extract native libraries, res=-113]**\r\n\r\nin the last step using this command: adb install bazel-bin/tensorflow/contrib/lite/examples/android/tflite_demo.apk", "Having same problems with latest master branch", "@izdi Try launch the app on another version of the android. I think the version was maybe the cause or:\r\n\r\nTry adding this to build.gradle under Android to create apk for each type:\r\n\r\nsplits {\r\n        abi {\r\n            enable true\r\n            reset()\r\n            include 'x86', 'armeabi-v7a', 'x86_64'\r\n            universalApk true\r\n        }\r\n    }", "I locally fixed the issue by renaming the `BUILD` file in the `Android` folder to smth other then BUILD, i.e. `BUILD2`. Not a proper solution but a workaround, that lets me build it at least.", "Nagging Assignee @achowdhery: It has been 14 days with no activity and this issue has an assignee. Please update the label and/or status accordingly.", "This is happening because `gradle` is confusing the `build` directory with the `BUILD` file. By default, gradle stores build output in the `build` directory and also creates and `android-profile` file within it. In this case it's attempting to do that with the `BUILD` file.\r\n\r\nWe need to find a way to have gradle ignore the `BUILD` file, or potentially choose a different build directory.\r\n", "This can be fixed by changing the build directory for gradle using `buildDir` for those running into this. I'm making the change to fix it."]}, {"number": 22166, "title": "After convert a mobilenet_v1 from pb model to lite, the model accuracy reduction for 12%", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:None\r\n- **TensorFlow installed from (source or binary)**:binary\r\n- **TensorFlow version (use command below)**:1.9.0\r\n- **Python version**:2.7\r\n- **Bazel version (if compiling from source)**:1.6.1\r\n- **GCC/Compiler version (if compiling from source)**:5.4.0\r\n- **CUDA/cuDNN version**:9.0/7.1\r\n- **GPU model and memory**:8GB\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\nI converted the pb-formatted mobilenet_v1 to lite with the following code:\r\npython tflite_convert.py \\\r\n--output_file=/data2/LIBY0711/trained_model/quantize_0827/mobilenet_v1_quant_lr_0.005_GD_0.5_decay_int8/pb_model2/sku_classify_scale-66.tflite \\\r\n--graph_def_file=/data2/LIBY0711/trained_model/quantize_0827/mobilenet_v1_quant_lr_0.005_GD_0.5_decay_int8/pb_model2/frozen_inference_graph_skip.pb \\\r\n--inference_type=QUANTIZED_UINT8 \\\r\n--input_shape=1,224,224,3 \\\r\n--input_arrays=input \\\r\n--default_ranges_min=0 \\\r\n--default_ranges_max=6 \\\r\n--output_arrays=MobilenetV1/Predictions/Softmax \\\r\n--mean_values=0 \\\r\n--std_dev_values=1\r\n\r\nHowever, the precision of lite after transformation is 12% lower than that of pb. I don't know if I'm setting the parameters incorrectly what else is going to be the problem, hopefully that's answered\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n", "comments": ["As documented [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/toco/g3doc/cmdline_reference.md) the `default_ranges_min` and `default_ranges_max` can lead to a drop in accuracy:\r\n\r\n> --default_ranges_min, --default_ranges_max. Type: floating-point. Default value for the (min, max) range values used for all arrays without a specified range. Allows user to proceed with quantization of non-quantized or incorrectly-quantized input files. These flags produce models with low accuracy. They are intended for easy experimentation with quantization via \"dummy quantization\".\r\n\r\nHow are you generating the model? Additionally, can you provide the model file to help with debug what the conversion command should be?", "Nagging Assignee @suharshs: It has been 44 days with no activity and this issue has an assignee. Please update the label and/or status accordingly.", "Automatically closing due to lack of recent activity. Please update the issue when new information becomes available, and we will reopen the issue. Thanks!\r\n"]}, {"number": 22165, "title": "TENSORFLOW ISSUES ", "body": "I've been trying to install TensorFlow for the past few hours and keep getting this error:\r\n# >>>>>>>>>>>>>>>>>>>>>> ERROR REPORT <<<<<<<<<<<<<<<<<<<<<<\r\n\r\n    Traceback (most recent call last):\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/exceptions.py\", line 812, in __call__\r\n        return func(*args, **kwargs)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/cli/main.py\", line 78, in _main\r\n        exit_code = do_call(args, p)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/cli/conda_argparse.py\", line 77, in do_call\r\n        exit_code = getattr(module, func_name)(args, parser)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/cli/main_install.py\", line 11, in execute\r\n        install(args, parser, 'install')\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/cli/install.py\", line 253, in install\r\n        handle_txn(unlink_link_transaction, prefix, args, newenv)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/cli/install.py\", line 269, in handle_txn\r\n        unlink_link_transaction.print_transaction_summary()\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/link.py\", line 730, in print_transaction_summary\r\n        legacy_action_groups = self._make_legacy_action_groups()\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/link.py\", line 713, in _make_legacy_action_groups\r\n        self._pfe.prepare()\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/common/io.py\", line 46, in decorated\r\n        return f(*args, **kwds)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 561, in prepare\r\n        for prec in self.link_precs)\r\n      File \"/anaconda2/lib/python2.7/_abcoll.py\", line 571, in update\r\n        for key, value in other:\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 561, in <genexpr>\r\n        for prec in self.link_precs)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 454, in make_actions_for_record\r\n        ), None)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 451, in <genexpr>\r\n        pcrec for pcrec in concat(PackageCacheData(pkgs_dir).query(pref_or_spec)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 452, in <genexpr>\r\n        for pkgs_dir in context.pkgs_dirs)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 125, in query\r\n        return (pcrec for pcrec in itervalues(self._package_cache_records) if pcrec == param)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 221, in _package_cache_records\r\n        self.load()\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 91, in load\r\n        package_cache_record = self._make_single_record(base_name)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/core/package_cache_data.py\", line 350, in _make_single_record\r\n        md5 = compute_md5sum(package_tarball_full_path)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/gateways/disk/read.py\", line 71, in compute_md5sum\r\n        return _digest_path('md5', file_full_path)\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/gateways/disk/read.py\", line 64, in _digest_path\r\n        with open(path, \"rb\") as fh:\r\n      File \"/anaconda2/lib/python2.7/site-packages/conda/common/compat.py\", line 121, in open\r\n        errors=errors, newline=newline, closefd=closefd)\r\n    IOError: [Errno 13] Permission denied: '/anaconda2/pkgs/pyspark-2.3.0-py27_0.tar.bz2'\r\n\r\n`$ /anaconda2/bin/conda install tensorflow`\r\n\r\n  environment variables:\r\n                 CIO_TEST=<not set>\r\n               CONDA_ROOT=/anaconda2\r\n                     PATH=/Library/Frameworks/Python.framework/Versions/3.7/bin:/anaconda2/bin:/\r\n                          Users/asy/Downloads/google-cloud-sdk/bin:/usr/local/bin:/usr/bin:/bin:\r\n                          /usr/sbin:/sbin:/Library/TeX/texbin\r\n       REQUESTS_CA_BUNDLE=<not set>\r\n            SSL_CERT_FILE=<not set>\r\n\r\n     active environment : None\r\n       user config file : /Users/asy/.condarc\r\n populated config files : /Users/asy/.condarc\r\n          conda version : 4.5.0\r\n    conda-build version : 3.0.27\r\n         python version : 2.7.14.final.0\r\n       base environment : /anaconda2  (writable)\r\n           channel URLs : https://repo.anaconda.com/pkgs/main/osx-64\r\n                          https://repo.anaconda.com/pkgs/main/noarch\r\n                          https://repo.anaconda.com/pkgs/free/osx-64\r\n                          https://repo.anaconda.com/pkgs/free/noarch\r\n                          https://repo.anaconda.com/pkgs/r/osx-64\r\n                          https://repo.anaconda.com/pkgs/r/noarch\r\n                          https://repo.anaconda.com/pkgs/pro/osx-64\r\n                          https://repo.anaconda.com/pkgs/pro/noarch\r\n          package cache : /anaconda2/pkgs\r\n                          /Users/asy/.conda/pkgs\r\n       envs directories : /anaconda2/envs\r\n                          /Users/asy/.conda/envs\r\n               platform : osx-64\r\n             user-agent : conda/4.5.0 requests/2.18.4 CPython/2.7.14 Darwin/16.7.0 OSX/10.12.6\r\n                UID:GID : 301705310:285281272\r\n             netrc file : None\r\n           offline mode : False\r\n\r\n This is what happens when I go down the conda route. \r\n\r\nWhen I go through the pip route,  this happens: \r\n\r\nCould not install packages due to an EnvironmentError: [Errno 13] Permission denied: u'/private/var/folders/k7/xthqkfr968g8c83fbtdm1jfc8zq_2y/T/pip-unpack-yhcLfC/tensorflow-1.10.1-cp27-cp27m-macosx_10_11_x86_64.whl'\r\nConsider using the `--user` option or check the permissions. \r\n\r\nPlease assist. \r\n", "comments": ["Thank you for your post. We noticed you have not filled out the following field in the issue template. Could you update them if they are relevant in your case, or leave them as N/A? Thanks.\nHave I written custom code\nOS Platform and Distribution\nTensorFlow installed from\nTensorFlow version\nBazel version\nCUDA/cuDNN version\nGPU model and memory\nExact command to reproduce\nMobile device", "This question is better asked on [StackOverflow](http://stackoverflow.com/questions/tagged/tensorflow) since it is not a bug or feature request. There is also a larger community that reads questions there.\r\n\r\nIf you think we've misinterpreted a bug, please comment again with a clear explanation, as well as all of the information requested in the [issue template](https://github.com/tensorflow/tensorflow/issues/new). Thanks!\r\n"]}, {"number": 22164, "title": "Fix broken link in rnn_colorbot", "body": "The README.md inside rnn_colorbot is broken, this fix fixes the link.", "comments": []}, {"number": 22163, "title": "Changed PWD to pwd for bash examples", "body": "Shell command PWD should be lowercase pwd for it work correct.  Obvious typo corrected.", "comments": []}, {"number": 22161, "title": "ValueError on using tf.contrib.avro with tf.keras", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: RHEL 7\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: Yes\r\n- **TensorFlow version (use command below)**: 1.9.0\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: \r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**: Please see the source below\r\n\r\n### Describe the problem\r\nOn using [tf.contrib.avro](https://github.com/tensorflow/tensorflow/pull/18224) with tf.keras, it throws a ValueError. The dataset created using tf.contrib.avro produces the results correctly but when used as training data for tf.keras.model during fit, it fails saying - `ValueError: Input 0 of layer dense0 is incompatible with the layer: : expected min_ndim=2, found ndim=1. Full shape received: [None]`\r\n\r\n### Source code / logs\r\nHere is the test code to reproduce the error:\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers import Conv1D, MaxPool1D, Flatten, Dense, Dropout, Input, BatchNormalization, concatenate\r\nfrom tensorflow.keras.optimizers import Adam\r\n\r\nfrom tensorflow.contrib.avro.python.parse_avro_record import parse_avro_record\r\nfrom tensorflow.contrib.avro.python.avro_record_dataset import *\r\n\r\n\r\nfrom avro.io import DatumReader, DatumWriter, BinaryDecoder, BinaryEncoder\r\nfrom avro.schema import parse\r\nfrom StringIO import StringIO\r\nfrom fastavro import writer, parse_schema\r\nimport random, json, glob, os\r\n\r\nschema = '''{\"doc\": \"Simple example.\",\r\n             \"namespace\": \"com.linkedin.demo.person\",\r\n             \"type\": \"record\",\r\n             \"name\": \"data_row\",\r\n             \"fields\": [\r\n               {\"name\": \"index\", \"type\": \"long\"},\r\n               {\"name\": \"first_name\", \"type\": \"string\"},\r\n               {\"name\": \"age\", \"type\": \"int\"},\r\n               {\"name\": \"gender\", \"type\": \"int\"}\r\n            ]}'''\r\n\r\ndata = [{'index': 0, 'first_name': \"Karl\", 'age': 22, \"gender\": 0},\r\n        {'index': 1, 'first_name': \"Julia\", 'age': 42, \"gender\": 1},\r\n        {'index': 2, 'first_name': \"Liberty\", 'age': 90, \"gender\": 1}]\r\n\r\nfeatures = {'index': tf.FixedLenFeature([], tf.int64),\r\n            'first_name': tf.FixedLenFeature([], tf.string),\r\n            'age': tf.FixedLenFeature([], tf.int32)}\r\n\r\nRECORDS_PER_FILE = 1000\r\nFEATURE_LIST = [\"index\", \"age\"]\r\nexclude_features = [\"first_name\"]\r\nRESPONSE_FIELD = \"gender\"\r\nDATA_SCHEMA = schema\r\nBATCH_SIZE = 10\r\n\r\ndef data_generator(output_directory, num_files, records_per_file):\r\n    parsed_schema = parse_schema(json.loads(DATA_SCHEMA))\r\n\r\n    for i in range(num_files):\r\n        print(\"Generating file \" + str(i))\r\n        records = [{}] * records_per_file\r\n        for j in range(records_per_file):\r\n            records[j] = {\r\n                \"index\": int( random.random() * 100 ),\r\n                \"first_name\": \"\",\r\n                \"age\": int( random.random() * 95 ),\r\n                \"gender\": int( random.random() * 10 ) % 2\r\n            }\r\n        \r\n        with open( output_directory + str(i) + '.avro', 'wb') as out:\r\n            writer(out, parsed_schema, records)\r\n\r\ndef create_input_fn(data_files, batch_size, num_parallel, shuffle_size, repeat_times=-1):\r\n    \"\"\"Create the input function for training and evaluation.\"\"\"\r\n    \r\n    # Define the function for parsing avro records into TensorFlow tensors (features, label).\r\n    def _parse_function(serialized):\r\n        parser_spec = {f: tf.FixedLenFeature([], tf.float32, default_value=0) for f in FEATURE_LIST}\r\n        parser_spec[RESPONSE_FIELD] = tf.FixedLenFeature([], tf.int32, default_value=0)\r\n        parsed = parse_avro_record(serialized=serialized, schema=DATA_SCHEMA, features=parser_spec)\r\n\r\n        features = {f: parsed[f] for f in FEATURE_LIST if f not in exclude_features}\r\n        label = parsed.pop(RESPONSE_FIELD)\r\n        return features, label\r\n\r\n    # Create the dataset and apply the parse function (must apply batch before parsing).\r\n    dataset = AvroRecordDataset(filenames=data_files)\r\n    dataset = dataset.batch(batch_size).map(_parse_function, num_parallel_calls=num_parallel)\r\n\r\n    if repeat_times is not None:\r\n        dataset = dataset.cache().repeat(repeat_times)\r\n    if shuffle_size is not None:\r\n        dataset = dataset.shuffle(shuffle_size)\r\n        \r\n    dataset = dataset.prefetch(2)\r\n\r\n    return dataset\r\n    \r\ndef deep_model(layer_names):\r\n    inputs = [Input(shape=(1,), name=layer_name) for layer_name in layer_names]\r\n    x = concatenate(inputs, name=\"input_layer\")\r\n    x = Dense(1, activation='relu', name=\"dense0\")(x)\r\n    outputs = Dense(2, activation='softmax')(x)\r\n    \r\n    return tf.keras.Model(inputs, outputs)\r\n\r\ndef test_data_generator(output_directory):\r\n    print(\"Running data generator\")\r\n    data_generator(output_directory, 10, RECORDS_PER_FILE)\r\n\r\ndef train_using_fit(data_dir):\r\n    print(\"Running the training loop using model.fit\")\r\n    files = tf.gfile.Glob(os.path.join(data_dir, \"*.avro\")) # can be generated using data_generator() above\r\n    \r\n    model = deep_model([f for f in FEATURE_LIST if f not in exclude_features])\r\n    optimizer = Adam(lr=0.001, clipvalue=0.5)\r\n    model.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])\r\n    model.summary()\r\n    \r\n    training_dataset = create_input_fn(data_files=files, \r\n                                       batch_size=BATCH_SIZE, num_parallel=5, shuffle_size=None)\r\n    model.fit(\r\n        training_dataset.make_one_shot_iterator(),\r\n        steps_per_epoch=(RECORDS_PER_FILE * len(files)) // BATCH_SIZE,\r\n        epochs=2)\r\n\r\ndef train_using_estimator(data_dir):\r\n    print(\"Running the training loop using keras estimators\")\r\n    files = tf.gfile.Glob(os.path.join(data_dir, \"*.avro\")) # can be generated using data_generator() above\r\n    \r\n    model = deep_model([f for f in FEATURE_LIST if f not in exclude_features])\r\n    optimizer = Adam(lr=0.001, clipvalue=0.5)\r\n    model.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])\r\n    model.summary()\r\n\r\n    training_dataset = create_input_fn(data_files=files, \r\n                                       batch_size=BATCH_SIZE, num_parallel=5, shuffle_size=None)\r\n\r\n    estimator = tf.keras.estimator.model_to_estimator(model) # can provide distributed training strategy\r\n    estimator.train(input_fn=lambda: training_dataset.make_one_shot_iterator().get_next(), max_steps=20)\r\n\r\n\r\ndef main():\r\n    data_dir = \"./data/mock_data/\" # make sure this folder exists\r\n    # test_data_generator(data_dir) # need to run this only once to generate dummy data\r\n    # train_using_fit(data_dir) # approach 1 for training\r\n    train_using_estimator(data_dir) # approach 2 for training\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n", "comments": ["@Nithanaroy Since PR #18224 has not been merged yet, maybe it is better to comment on any issues you may have under the PR #18224? That will likely get the issue raised sooner. \r\n\r\nI will close this issue for now. Please add comment to PR #18224 and thanks for reporting the issue."]}, {"number": 22160, "title": "[nGraph] Added CPU backend", "body": "This pull request adds the support for nGraph CPU backend. The changes are in the following area:\r\n1. tensorflow/workspace.bzl is updated with:\r\n   - A new repository added - Intel TBB (Apache 2.0 license)\r\n   - Updated the version of ngraph and ngraph-tf repositories\r\n2. thirdparty/ngraph/ \r\n   - Updated bazel files for ngraph and ngraph-tf bridge\r\n   - Added bazel build file for building TBB  ", "comments": ["Rasmus, Derek, this adds an (externally maintained) rewriter pass. I wanted to check what the relationship between this and grappler looks like... is there some sort of consolidation planned? Note this shouldn't necessarily affect this PR, but I'd like to know for the future.", "@mrry @rmlarsen please let us know if you have any specific questions about how these passes are implemented. We register a POST_PLACEMENT and a POST_REWRITE_FOR_EXEC pass in this file: https://github.com/NervanaSystems/ngraph-tf/blob/e5c137aa41b9876f36e4f90bd2cfca43eb9b8813/src/ngraph_rewrite_pass.cc#L271\r\n\r\nThe first one is implemented in this file: https://github.com/NervanaSystems/ngraph-tf/blob/e5c137aa41b9876f36e4f90bd2cfca43eb9b8813/src/ngraph_capture_variables.cc#L40\r\n\r\nThe second one (which calls other functions) is here: https://github.com/NervanaSystems/ngraph-tf/blob/e5c137aa41b9876f36e4f90bd2cfca43eb9b8813/src/ngraph_rewrite_pass.cc#L189\r\n", "Hi @avijit-nervana, would you help to fix the CI build failure? One of them is about `do_pip_package_licenses_check`: \r\n```\r\nFAIL: mismatch in packaged licenses and external dependencies\r\nMissing the licenses for the following external dependencies:\r\n@tbb//\r\n```", "@aaroey I am working on the build failure. Hope to push an update soon.", "@aaroey Done. Please let me know if there are other issues. Thanks."]}, {"number": 22159, "title": "Include absl headers in pip package", "body": "PiperOrigin-RevId: 212067303\r\n\r\nCherrypick Austin's change into r1.11", "comments": ["Any idea about the XLA failure?", "I didn't see it, hopefully a rerun helps.", "What about using https://github.com/tensorflow/tensorflow/pull/22061 to gather all the headers then copy those into the pip package?", "This is an issue with setup.py copying the files, more than the bazel dependencies.\r\nEven with your change, we have to have the changes in setup.py to make sure the new files are included in the pip package., otherwise setup.py will ignore the new headers.", "The XLA build failures seem to be fixed by https://github.com/tensorflow/tensorflow/pull/22196, but not the test failure."]}, {"number": 22158, "title": "Unexpected behavior of per_process_gpu_memory_fraction ", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: See below\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: binary (used pip)\r\n- **TensorFlow version (use command below)**:  See below \r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: N/A \r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: See below\r\n- **GPU model and memory**: See below \r\n- **Exact command to reproduce**: Just run the script with python \r\n\r\n### System information from your tf env script:\r\n\r\n== cat /etc/issue ===============================================\r\nLinux ip-172-31-54-194 4.4.0-1062-aws #71-Ubuntu SMP Fri Jun 15 10:07:39 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.4 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux ip-172-31-54-194 4.4.0-1062-aws #71-Ubuntu SMP Fri Jun 15 10:07:39 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy               1.14.5\r\nprotobuf            3.6.0\r\ntensorflow-gpu      1.10.0\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.10.0\r\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34\r\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34\r\nSanity check: array([1], dtype=int32)\r\n/home/ubuntu/anaconda3/envs/tensorflow_p36/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /usr/local/cuda-9.0/lib64:/usr/local/cuda-9.0/extras/CUPTI/lib64:/lib/nccl/cuda-9.0/lib:/usr/lib64/openmpi/lib/:/usr/local/lib:/usr/lib:/usr/local/mpi/lib:/lib/:/usr/lib64/openmpi/lib/:/usr/local/lib:/usr/lib:/usr/local/mpi/lib:/lib/:\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nSat Sep  8 01:19:08 2018\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla V100-SXM2...  On   | 00000000:00:1B.0 Off |                    0 |\r\n| N/A   45C    P0    63W / 300W |      0MiB / 16160MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  Tesla V100-SXM2...  On   | 00000000:00:1C.0 Off |                    0 |\r\n| N/A   42C    P0    38W / 300W |      0MiB / 16160MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  Tesla V100-SXM2...  On   | 00000000:00:1D.0 Off |                    0 |\r\n| N/A   42C    P0    43W / 300W |      0MiB / 16160MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  Tesla V100-SXM2...  On   | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   44C    P0    42W / 300W |      0MiB / 16160MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-9.1/doc/man/man7/libcudart.7\r\n/usr/local/cuda-9.1/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-9.1/lib64/libcudart.so.9.1.85\r\n/usr/local/cuda-9.1/lib64/libcudart_static.a\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-8.0/lib64/libcudart_static.a\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61\r\n/usr/local/cuda-9.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-9.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-9.0/lib64/libcudart.so.9.0.176\r\n/usr/local/cuda-9.0/lib64/libcudart_static.a\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\nI have written a small example that uses per_process_gpu_memory_fraction. I set it to .1 and allow_growth=false (by default). My expectation when I run nvidia-smi during program execution is that I will see a maximum of 10% of the gpu memory being used. During some trial runs of the program though, I have seen it using around 13%. So I am wondering if this is a bug or if it is expected behavior. If it's expected behavior, why is this happening?\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n\r\n### Script to reproduce with:\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nfrom time import sleep\r\n\r\ni = tf.constant(0)\r\nx = tf.constant(10)\r\nr = tf.add(i,x)\r\n\r\n# Use at most 10% of gpu memory \r\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=.1)\r\n\r\n# sleep is used to see what nvidia-smi says for gpu memory usage, \r\n# I expect that it will be at most 10% of gpu memory (which is 1616.0 mib for my gpu)\r\n# but instead I see up to 2120 mib used by the process\r\nwith tf.Session(config=tf.ConfigProto(gpu_options=gpu_options)) as sess:\r\n        sess.run(r);\r\n        sleep(10) \r\n\r\n```\r\n\r\n\r\n", "comments": ["/CC @ekelsen, do you know why this occurs? We allocate 10% of the GPU memory, but the CUDA runtime takes some memory itself, I think.", "unassign", "@reedwm Yeah from my experimentation it seems like allocating cuda contexts takes some memory. Also, some memory is used when initializing cudnn and cublas. I think this mostly accounts for it. Does anyone have any additional insight?", "I think it was resolved. I am closing the issue. If you think I made a mistake, please open another issue. Please open a new ticket if you see similar issue again with new version of TF. Thanks!"]}, {"number": 22157, "title": "Fix int64 failure on GPU for TensorArray", "body": "This fix tries to address the issue raised in #22054 where int64 on GPU results in colocation errors. This fix enables int64 on GPU with TensorArray.\r\n\r\nThis fix fixes #22054.\r\n\r\nSigned-off-by: Yong Tang <yong.tang.github@outlook.com>", "comments": ["Can you add a unit test that only runs if GPU is available?", "(to make sure we don't regress on this in the future)", "Errors look unrelated.  I think this is safe to merge but running kokoro one more time.", "Thanks @ebrevdo. The failure in `Ubuntu Sanity` was pylint:\r\n```\r\nFAIL: Found 1 non-whitelited pylint errors:\r\n69\r\ntensorflow/python/kernel_tests/tensor_array_ops_test.py:1509: [W0311(bad-indentation), ] Bad indentation. Found 7 spaces, expected 6\r\n```\r\n\r\nI have fixed the pylint error and pushed. Thanks for the help!"]}, {"number": 22156, "title": "Install h5py in the docker container.", "body": "PiperOrigin-RevId: 212054037", "comments": []}, {"number": 22155, "title": "Cherry-pick for r1.11: Fix race condition in tfdbg disk usage tracking", "body": "", "comments": []}, {"number": 22154, "title": "R1.11 tfdbg cherry pick", "body": "", "comments": []}, {"number": 22153, "title": "Tensorflow does not work with python 3.7 when using Virtualenv", "body": "I am not sure where it goes wrong, but after reading tons of posts online I figured the combination tensor flow, Virtualenv en python 3.7 is not valid on Mac OSX.\r\nI use python3.6 now and it is fine.\r\nSorry I can not provide more info, I'm broken by the struggle and want to sleep and forget about it.", "comments": ["Thank you for your post. We noticed you have not filled out the following field in the issue template. Could you update them if they are relevant in your case, or leave them as N/A? Thanks.\nHave I written custom code\nOS Platform and Distribution\nTensorFlow installed from\nTensorFlow version\nBazel version\nCUDA/cuDNN version\nGPU model and memory\nExact command to reproduce\nMobile device", "Virtualenv is a red herring, tensorflow does not yet work with python 3.7\r\nWe are waiting for all of our dependencies to merge python 3.7 support.\r\n\r\nClosing as duplicate of https://github.com/tensorflow/tensorflow/issues/20517"]}, {"number": 22152, "title": "Add PyMemberDef for __dict__ on eager tensors.", "body": "This fixes dir() calls on instances of eager tensors so that it correctly\r\naccesses the __dict__ of EagerTensorType.\r\n\r\nEarlier it would fail due to an infinite \"loop\" in subtype_dict: https://github.com/python/cpython/blob/7e610bcdf128f61b925654e4fa80fbac83537d0e/Objects/typeobject.c#L2145\r\n\r\nget_builtin_base_with_dict will return the same type (though I'm not sure this is reasonable behavior given its name).\r\nThe __dict__ getter for the type is subtype_dict creating an infinite tail recursion.\r\n\r\nPiperOrigin-RevId: 212020695", "comments": ["Thanks!"]}, {"number": 22151, "title": "Add TF Lite-disabling variable", "body": "PiperOrigin-RevId: 211906579", "comments": []}, {"number": 22150, "title": "More changes to fix absl rollback", "body": "", "comments": []}, {"number": 22149, "title": "Fix mistake in 1.11 Rollback Cherrypick", "body": "", "comments": []}, {"number": 22148, "title": "Expected dimension in the range [-1, 1), but got 1 [[Node: accuracy_5/ArgMax_1 = ArgMax[T=DT_FLOAT, Tidx=DT_INT32, output_type=DT_INT64, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_y_label_0_1, accuracy_5/ArgMax/dimension)]]", "body": "I am working on luna16 dataset, I use tensorflow CNN code to classify images (cancer/not-cancer [0 or 1]), the code has no problem and runs without any error, but in session when I want to add summary `_, c, summary = sess.run([accuracy, cost, merged_summary], feed_dict={x_img: X, y_label: Y})` I get this error: InvalidArgumentError (see above for traceback): `Expected dimension in the range [-1, 1), but got 1 [[Node: accuracy_5/ArgMax_1 = ArgMax[T=DT_FLOAT, Tidx=DT_INT32, output_type=DT_INT64, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_y_label_0_1, accuracy_5/ArgMax/dimension)]]`\r\nif I remove the merged_summary the code is works fine?\r\n", "comments": ["Thank you for your post. We noticed you have not filled out the following field in the issue template. Could you update them if they are relevant in your case, or leave them as N/A? Thanks.\nHave I written custom code\nOS Platform and Distribution\nTensorFlow installed from\nTensorFlow version\nBazel version\nCUDA/cuDNN version\nGPU model and memory\nExact command to reproduce\nMobile device", "sorry, but where are these fields?", "@HunarAA when you created this issue there was the policy (in the field where you described your issue) where devs asks to specify that information. To ensure you can click \"New issue\" again and read it.\r\nAlso as I see your issue can be not issue at all. In the same policy as I mentioned above the most first sentence is about your case. Such questions you should ask on [stackoverflow](https://stackoverflow.com/questions/tagged/tensorflow).\r\nGood luck!", "@apischan is right on both counts. Closing this since it's not a bug or feature request."]}, {"number": 22147, "title": "Make tf.random_uniform([0], maxval=0, dtype=tf.int32) not crash", "body": "For integers, `tf.random_uniform` enforces a nonempty range with `minval < maxval`.  However, an empty range is fine if we're producing no output values, and this degenerate case occurs naturally for some code patterns.\r\n\r\nThus, `tf.random_uniform` now allows empty ranges for integer random numbers if the output shape is empty.", "comments": ["I believe the Windows and XLA failures are unrelated.", "The [windows bazel error](https://source.cloud.google.com/results/invocations/1bb3a59d-12e6-49c9-a649-89b76f272971/log) looks real.  Could it be related?\r\n\r\n```\r\nERROR: T:/src/github/tensorflow/tensorflow/contrib/resampler/BUILD:51:1: C++ compilation of rule '//tensorflow/contrib/resampler:python/ops/_resampler_ops_gpu' failed (Exit 2): msvc_wrapper_for_nvcc.bat failed: error executing command\r\n  cd T:/tmp/bigvaudl/execroot/org_tensorflow\r\n```", "Nevermind; I'm seeing it on other builds too.", "Does it need some sort of ready-to-merge label?", "Looks like this never got merged, possibly due to the failing unrelated tests.  I rebased and pushed in hopes that the tests will now pass.  As a meta question: why did merging stall for this PR and how can I prevent that in future?", "Add tags force kokoro and merge when tests are done\n\nOn Tue, Sep 18, 2018, 8:00 AM Geoffrey Irving <notifications@github.com>\nwrote:\n\n> Looks like this never got merged, possibly due to the failing unrelated\n> tests. I rebased and pushed in hopes that the tests will now pass. As a\n> meta question: why did merging stall for this PR and how can I prevent that\n> in future?\n>\n> \u2014\n> You are receiving this because your review was requested.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/22147#issuecomment-422428207>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim32NbVhW2J-k5F7CE5D2i4szW4C5ks5ucQqbgaJpZM4WfGC1>\n> .\n>\n", "(if you cant set tags; then ask the assignee to ping the on-call)\n\nOn Tue, Sep 18, 2018 at 9:00 AM, ebrevdo <notifications@github.com> wrote:\n\n> Add tags force kokoro and merge when tests are done\n>\n> On Tue, Sep 18, 2018, 8:00 AM Geoffrey Irving <notifications@github.com>\n> wrote:\n>\n> > Looks like this never got merged, possibly due to the failing unrelated\n> > tests. I rebased and pushed in hopes that the tests will now pass. As a\n> > meta question: why did merging stall for this PR and how can I prevent\n> that\n> > in future?\n> >\n> > \u2014\n> > You are receiving this because your review was requested.\n> > Reply to this email directly, view it on GitHub\n> > <https://github.com/tensorflow/tensorflow/pull/\n> 22147#issuecomment-422428207>,\n> > or mute the thread\n> > <https://github.com/notifications/unsubscribe-auth/ABtim32NbVhW2J-\n> k5F7CE5D2i4szW4C5ks5ucQqbgaJpZM4WfGC1>\n> > .\n> >\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/22147#issuecomment-422449446>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtimyAsCuWn3CKKm7X_sjc8azu533PBks5ucRi2gaJpZM4WfGC1>\n> .\n>\n", "@ebrevdo XLA test still fails in I think the same way.  Can you check whether that failure shows up in other builds as well?", "The failure is test\n`ExhaustiveF32ElementwiseOpTestInstance/ExhaustiveF32ElementwiseOpTest.LogF32/64`.\nI doubt it's related.  If it is we'll check it out internally.  Let's push\nthis one.\n\nOn Tue, Sep 18, 2018 at 9:28 AM, Geoffrey Irving <notifications@github.com>\nwrote:\n\n> @ebrevdo <https://github.com/ebrevdo> XLA test still fails in I think the\n> same way. Can you check whether that failure shows up in other builds as\n> well?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/22147#issuecomment-422458512>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtimwKcxzUfrq7nRoj0PjX-Xt5iuA8Zks5ucR8hgaJpZM4WfGC1>\n> .\n>\n", "@ebrevdo Looks like I'm not authorized to merge.", "Yes; I'm finding the oncall now :)\n\nOn Tue, Sep 18, 2018 at 10:02 AM, Geoffrey Irving <notifications@github.com>\nwrote:\n\n> @ebrevdo <https://github.com/ebrevdo> Looks like I'm not authorized to\n> merge.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/22147#issuecomment-422470992>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim2uMUmGbPxKFn545-Fzd-mIQarzpks5ucScugaJpZM4WfGC1>\n> .\n>\n", "Thank you!\n\nOn Fri, Sep 21, 2018 at 1:42 PM, TensorFlow Copybara <\nnotifications@github.com> wrote:\n\n> Merged #22147 <https://github.com/tensorflow/tensorflow/pull/22147> into\n> master.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/22147#event-1861117002>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim2A_vlHHuniz0KPikybFBDV0zY3Lks5udU9HgaJpZM4WfGC1>\n> .\n>\n"]}, {"number": 22146, "title": "TOCO fails to handle Dilated Convolution properly", "body": "### System information\r\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):N/A\r\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:N/A\r\nTensorFlow installed from (source or binary):source\r\nTensorFlow version (use command below):1.10.0\r\nPython version: 2.7.12\r\nBazel version (if compiling from source):0.15.0\r\nGCC/Compiler version (if compiling from source):5.4.0\r\nCUDA/cuDNN version:N/A\r\nGPU model and memory:N/A\r\nExact command to reproduce:N/A\r\n\r\n### Problem description\r\nI have frozen_model.pb which works well.\r\n\r\nI build toco with command:\r\n`bazel build -c opt //tensorflow/contrib/lite/toco:toco`\r\n \r\nThen i'm trying to convert model to TfLite:\r\n`toco --allow_custom_ops --input_file='frozen_model.pb'  --output_file='wavenet.tflite' --input_arrays='original_input' --input_shapes='1,48000,1' --output_arrays='activation_2/Softmax' --dump_graphviz=graph --dump_graphviz_video=true`\r\n\r\n\r\nand geting error:\r\n\r\n```\r\n2018-09-07 17:45:53.870648: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 412 operators, 674 arrays (0 quantized)\r\n2018-09-07 17:45:53.876846: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 412 operators, 674 arrays (0 quantized)\r\n2018-09-07 17:45:53.877237: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:161] Identified sub-network emulating dilated convolution.\r\n2018-09-07 17:45:53.877266: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:209] Replaced with Dilated Conv2D op outputting \"dilated_conv_2_tanh/convolution/Conv2D\".\r\n2018-09-07 17:45:53.877487: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:161] Identified sub-network emulating dilated convolution.\r\n2018-09-07 17:45:53.877512: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:209] Replaced with Dilated Conv2D op outputting \"dilated_conv_2_sigm/convolution/Conv2D\".\r\n2018-09-07 17:45:53.877852: F tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:116] Check failed: dim_x == dim_y (48002 vs. 48000)Dimensions must match\r\n```\r\n\r\n\r\nThis is Dilated Convolution block in original frozen_model.pb visualized in tensorboard, it has input and output shape [?, 48000, 40]:\r\n\r\n[?, 48000, 40] ->Pad->[?, 48002, 40]->SpaceToBatchND -> ExpandDims -> Conv2D -> Squeeze -> BatchToSpaceND->[?, 48000, 40]\r\n\r\n![img2](https://user-images.githubusercontent.com/673872/45226776-67d4c200-b2c8-11e8-9886-1aa498559a00.png)\r\n\r\n\r\nTOCO tries to substitute with\r\n[?, 48000, 40] ->Pad->[?, 48002, 40]->Reshape -> Conv1x1/S -> Squeze->[?, 48002, 40]\r\n![img3](https://user-images.githubusercontent.com/673872/45227203-cf8b0d00-b2c8-11e8-9092-7a4a94a731c0.png)\r\n\r\nso ouput of resulted block is [?, 48002, 40] instead of [?, 48000, 40], it causes error in subsequent operations.\r\n\r\nI managed to avoid this issue by removing line 102:\r\n`transformations->Add(new IdentifyDilatedConv);`\r\nfrom tensorflow/contrib/lite/toco/toco_tooling.cc and rebuilding TOCO,\r\nbut unfortunately this causes new problems, because some operations like SpaceToBatchND and BatchToSpaceND don't support 3D tensors in current TfLite verison.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "comments": ["Thanks for the report, would it be possible to share the model (or truncated model) which yields this error? Thanks.", "Here is simplified model created in Keras 2.2.2:\r\n\r\n[keras-dilated-conv.tar.gz](https://github.com/tensorflow/tensorflow/files/2367670/keras-dilated-conv.tar.gz)\r\n\r\n![1](https://user-images.githubusercontent.com/673872/45313167-bd160b00-b536-11e8-99a8-4b40255245cb.png)\r\n\r\nimages for converted graph are also in archive\r\n\r\n", "Hello! What's the status of this issue? It seems like I have faced this bug too.", "This error always oppears when you try to convert Keras model with Conv1D when dilation_rate > 1 and padding  != 'same'\r\n\r\nStill on TF 1.13", "@gashmish : Recently i uploaded 2 PRs to address SpaceToBatchND and BatchToSpaceND arbitrary dimension support, i have verified with the model you uploaded in this issue, it works fine. Would you please consider these 2 PRs into your workspace and check with your real time data once. Just need to know if it solves your blocking issue, Thanks!\r\n2 PRs are #27867 & #28179 ", "Hello @ANSHUMAN87 !\r\nI tested your PRs for our model in TF Lite and it works well, great job!\r\n\r\nRegarding current issue, if those PRs are applied, some option for disabling ResolveDilatedConv transflormation in TOCO could solve the problem\r\n\r\nHowever, strainforward disabling ResolveDilatedConv may cause some other errors in subsequent graph nodes, like this:\r\n\r\n`ERROR: tensorflow/lite/kernels/strided_slice.cc:152 op_context.input->type != op_context.output->type (2 != 1)\r\nERROR: Node number 216 (STRIDED_SLICE) failed to prepare.`\r\n\r\nI managed to avoid this by removing Reshape layer in Keras model, but in general there can be other problems\r\n\r\n\r\n", "@gashmish : Thanks a lot for confirming! \r\nI am unsure why you need to disable ResolveDilatedConv().\r\nAs i can reproduce the issue:\r\n\r\n> NumDimensions(op_context.input) != kInputDimensionNum (3 != 4)Node number 1 (SPACE_TO_BATCH_ND) failed to prepare.\r\n\r\nwithout any change in code with the model you shared in zip file earlier.\r\nThen i applied my 2 PRs, and the inference is successful.\r\nPlease let me know if i miss anything.\r\nTIA!", "@ANSHUMAN87, may be it was other model accidentally? By default TOCO tries to substitute dilated convolution subgraph with subgraph without SpaceToBatch and BatchToSpace\r\n\r\nConverting model.pb to model.tflite from attached zip in TF nightly build with command\r\n```\r\ntoco \\\r\n    --graph_def_file='model.pb' \\\r\n    --output_file=\"model.tflite\" \\\r\n    --input_arrays='input' \\\r\n    --input_shapes='1,48000,40' \\\r\n    --output_arrays='dilated_conv_2/Tanh' \\\r\n    --dump_graphviz_video \\\r\n    --dump_graphviz_dir='graph'\r\n```\r\n[toco_AT_IMPORT.dot.pdf](https://github.com/tensorflow/tensorflow/files/3138076/toco_AT_IMPORT.dot.pdf)\r\n[toco_AFTER_TRANSFORMATIONS.dot.pdf](https://github.com/tensorflow/tensorflow/files/3138078/toco_AFTER_TRANSFORMATIONS.dot.pdf)\r\n\r\nIn latest TF version you can use this script to create sample model:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom keras        import backend as K\r\nfrom keras.layers import Input, Conv1D \r\nfrom keras.models import Model\r\n\r\nK.set_learning_phase(False)\r\n\r\ninput  = Input(\r\n    name =  'input',\r\n    shape = (48000, 40))\r\n\r\noutput = Conv1D(\r\n    name          ='dilated_conv_2',\r\n    filters       = 40, \r\n    kernel_size   = 2,\r\n    dilation_rate = 2,\r\n    padding       = 'causal',\r\n    activation    = 'tanh'\r\n)(input)\r\n\r\nmodel = Model(input, output)\r\nmodel.summary()\r\nmodel.save(\"sample.h5\")\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model_file(\"sample.h5\")\r\ntflite_model = converter.convert()\r\nopen(\"sample.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nPoint of current issue is that subgraph substitution in this case works inproperly, so i needed to disable it in TOCO source\r\n\r\n", "@gashmish : I have used tensorflow 1.13 for your model conversion to tflite with the script you shared. It executed perfectly fine. Also i went through the *.dot files you shared, the conversion is perfectly fine. The output shape is supposed to be [?, 48002, 40] as per padding. So still i am not sure where you are facing the issue. Would you please try converting your model using 1.13 version or later, and post your results.", "@ANSHUMAN87: Everything is all right, by \"this issue\" I mean current topic about TOCO converter.\r\n\r\n1) In TF 1.13.1 if I create and convert simple model with above script I get model with Conv2d and without BatchToSpace and SpaceToBatch. Output size is  [?, 48002, 40] instead of  [?, 48000, 40], so my production model will not work. This is ResolveDilatedConv transformation Bug.\r\n\r\n2) If I disable ResolveDilatedConv transformation in toco I get model with BatchToSpace and SpaceToBatch. Then I apply your patches to TF Lite and everything works perfect. \r\n\r\n[Script and resulting models](https://github.com/tensorflow/tensorflow/files/3142712/sample.tar.gz)\r\n\r\nSo my problem is solved, but I still need to disable ResolveDilatedConv in TOCO source by hand, which also caused STRIDED_SLICE problem, which i avoided by also slightly changing or production model. (STRIDED_SLICE problem occures also without your patches and not caused by them)\r\n\r\nRegarding your BatchToSpace and SpaceToBatch ops changes everything works perfectly with our production model.", "@ANSHUMAN87:\r\n\r\n> The output shape is supposed to be [?, 48002, 40] as per padding\r\n\r\nIn original Keras model and in Tensorflow model we get 48000 when using padding='causal'\r\n\r\n```\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput (InputLayer)           (None, 48000, 40)         0         \r\n_________________________________________________________________\r\ndilated_conv_2 (Conv1D)      (None, 48000, 40)         3240      \r\n=================================================================\r\n```\r\n", "@gashmish : I am extremely sorry, i did some misinterpretation of the issue. Now i got the issue clearly.\r\nThere is a missed scenario which need to be handled in ResolveDilatedConv(). I will upload a fix for this and update you on that. Thanks a lot for your detailed reply.\r\n\r\nAlso i am little curious about your STRIDED_SLICE problem. Because no matter you disable as many Transformation like ResolveDilatedConv(), it should not break the Graph in the manner that subsequent Subgraphs will get impacted. If it is okay for you, would you be able to share small piece of code where this scenario is reproducible, i have tried with the steps you mentioned(like disable ResolveDilatedConv(), upload 2 PRs i shared), but did not reproduce.", "@gashmish : I have uploaded fix for your problem, please refer #28410. I have verified. Request you also to verify with this change. And do let me know your results.\r\n\r\nAlso request you to share the code snippet or steps to reproduce STRIDED_SLICE problem. I suspect this could be some other issue. \r\n\r\nThanks a lot!", "@ANSHUMAN87 : thanks for the PR. Hopefully with your change, we'll be able to convert the Wavenet model through TOCO. \r\n\r\n@gashmish: like Jared asked, may i ask for a direct pointer to where you got the Wavenet model from? (e.g. Tensorflow Model Zoo, Github, etc ..). This is an important enough model that there should be conversion test to ensure conversion support stays going forward. If not, it's ok, I can try to find a canonical model online. Hopefully it matches your model closely enough that you won't have similar issues going forward", "@ANSHUMAN87: \r\n~(I temporary removed this post because I think I got incorrect results by mistake, I will update it soon)~\r\n\r\nI tried to test PR [#28410](https://github.com/tensorflow/tensorflow/pull/28410) and it worked well with sample Keras model I posted above. \r\n\r\nThen I tried to convert our full production model and it seems that some DilatedConvs blocks are not substituted and we get BatchToSpace and SpaceToBatch in TF model.\r\nMay be there are some more scenarios not implemented in converter. I need some time to investigate it and I will try to prepare more complete model for testing this issue soon.\r\n(It can be OK because BatchToSpace and SpaceToBatch are also fully implemented now)\r\n\r\n@alanchiao:\r\nModel we using is not original Wavenet, it just has some Dilated Convolution blocks. We can't share entire model right now, I will try to create more verbose model for testing purposes. Generally this converter issue must be related to any Keras model having Conv1D with padding='causal'\r\n\r\n\r\n", "@gashmish: Thanks a lot for confirming. Even i was also suspecting there might be some more cases missed out. If possible please try to share, the cases where it has not converted. Will try to make solution for converter more generic.\r\n  Yes you are right, together 3 PRs #28410, #27867 & #28179 will help the model works fine.\r\n\r\nJust to remind you, are you able to reproduce the STRIDED_SLICE problem? If yes would you please share steps or pseudo code to reproduce it.\r\nThanks a lot for your efforts!", "@ANSHUMAN87:\r\nHere is 2 models in archive, almost identical to what we are using. Input is (48000,) and output is (4,).\r\n[models.tar.gz](https://github.com/tensorflow/tensorflow/files/3152890/models.tar.gz)\r\n\r\nWith 3 RPs applied, running model wavenet_classifier.tflite :\r\n```\r\nERROR: tensorflow/lite/kernels/strided_slice.cc:152 op_context.input->type != op_context.output->type (2 != 1)\r\nERROR: Node number 207 (STRIDED_SLICE) failed to prepare.\r\n```\r\nThis is coused by Keras layer Reshape.\r\n\r\nIn model wavenet_classifier_fixed.tflite Reshape is changed to Squeeze, it runs correctly.\r\n\r\nThank you very much for support!\r\n\r\n", "@gashmish : Please ignore my last comment i have deleted that. \r\nIt was some tool issue.\r\nI am analyzing the issue currently, will update you as soon as possible. Thanks!", "Hello. I believe I have a similar issue. My model based on TCN has 2 issues. **Last of which is probably similar to what is mentioned here (WaveNet is kind of TCN, and my problem occurs with 'causal' padding).** I would highly appreciate an advice.\r\n\r\nFirst my environment:\r\n\r\n> I am working with Pycharm, python3, Keras 2.2.4 tensorflow-gpu 1.12.0\r\n> I have probelm using convert() method in pycharm, just like other people voicing it in https://stackoverflow.com/questions/52599110/tensorflow-tococonverter-gives-toco-from-protos-error , so I have changed a constant in /home/[MYUSER]/.virtualenvs/[MYPROJECTNAME]lib/python3.6/site-packages/tensorflow/contrib/lite/python/lite_constants.py:  EXPERIMENTAL_USE_TOCO_API_DIRECTLY = True\r\n\r\nNow the problems:\r\nI am using keras-tcn library (in version 2.3.5, but newest version has the same problem) from https://github.com/philipperemy/keras-tcn in order to create a Temporal Convolutional Neural Network.\r\nMy model has 2 issues in conversion to TFLite.\r\n\r\n1. This code gets error during conversion, whenever nb_stacks is changed from 2 to 1:\r\n> new_layer = TCN(kernel_size=3,dilations=[1],return_sequences=False,nb_filters=128,nb_stacks=1)(previous_layer)\r\n\r\nError says : \"A merge layer should be called on a list of inputs.\" \r\n\r\n**2. Another error shows up whenever any of the dilations is >1 while simultaneously kernel_size being >1. So for example:**\r\n> new_layer=TCN(kernel_size=3,dilations=[2,4],return_sequences=False,nb_filters=128,nb_stacks=2)(previous_layer)\r\n\r\n**If previous layer had the time dimension equal 31, the error would look like:\r\n\"Check failed: dim_x == dim_y (31 vs. 35)Dimensions must match\"**\r\n\r\nEDIT: Problem does not occur when I set padding to 'same', however it gives completely different logic, not applicable for real-time solution. I really need it working with 'causal' padding.\r\n\r\nWhen is the new set of improvements estimated to show up in release? I will gladly perform an update then. Is there any temporary hack I can apply to go around this issue till then? I really would like to make at least a PoC for now for a demonstration and get the \"official solution\" whenever it is ready.", "@karolbadowski : I will try find a solution for you. By any chance, do you have some small reproducible code or model for your issues? Please share if possible.\r\nAnd if you think it is related, have you tried with the PRs i shared in this issue links?\r\nPlease do let me know the results post the PRs.\r\nThanks!", "@ANSHUMAN87 Hello. For now I use a hack in which I try to express same shape of TCN neural network with usage of \"same\" padding instead of \"causal\". It is not perfect solution, just hack until the issue is fixed.\r\n\r\nI voted here: https://github.com/tensorflow/tensorflow/issues/21526 for your changes to be reviewed (I see that they are awaiting review from someone with write privilages) however I did not have opportunity to try your PR's myself - I use prebuild version of TF-Lite from official installation.\r\n\r\nLightweight example of TCN neural network with \"causal\" padding can be created with usage of this library: https://github.com/philipperemy/keras-tcn by calling constructor of class TCN().\r\n\r\nFor example:\r\n\r\n```\r\ninput_tensor = Input(shape=(31, 1024))  # it would be input of 31 moments in time, each having 1024 features\r\ntemporal_tensor = TCN(kernel_size=3,dilations=[1,2,4,8],return_sequences=False,nb_filters=32)(input_tensor)\r\noutput_tensor = Dense( 1 )(temporal_tensor)\r\nm = Model(inputs=[input_tensor], outputs=[output_tensor])\r\nm.compile(optimizer='adam', loss='mse')\r\n```\r\n\r\nIt will create neural network with dilated convolutions of \"causal\" type of padding.\r\n\r\n**This library has also examples of WaveNet**.\r\n\r\nIt would be very nice to be able to use this library with TFLite without hacks, resulting in model free of memory leaks.", "@karolbadowski : Thanks for sharing details.\r\nI have verified the TCN conversion & Inference in TFLite.\r\nMy 3 PRs #28410, #27867 & #28179 solve the blocking issue you are facing.\r\nSo i would suggest, as it is taking long time to get merged, you can setup one build environment of Tensorflow latest code locally, and merge my 3 PRs mentioned above.\r\nThen you can convert the TCN models and will be able to inference as well.\r\nThat will be just one time effort.\r\n\r\nNOTE: I have used mnist_example TCN to verify my changes, and i believe it coincides with your requirement also.\r\n\r\nPlease let me know if you need anything else, Thanks!", "@ANSHUMAN87 Thanks for the PRs will help with the same issue I'm having too.", "Thank you @ANSHUMAN87 \r\nDo you know if the change is already merged with release version of TensorFlow (if so, since which one)?", "Hello. Do you know for which release version of TensorFlow this change is planned?", "Hi @gashmish ,\r\nWe are checking to see if you still need help on this issue. We recommend that you upgrade to 2.6 which is latest stable version of TF and let us know if the issue still persists in newer versions.  Thanks!", "This issue has been automatically marked as stale because it has no recent activity. It will be closed if no further activity occurs. Thank you.\n", "Closing as stale. Please reopen if you'd like to work on this further.\n", "@mohantym  I notice that this issue happens in TF 2.6 quantization too with atrous convolution. And just for reference I tried with MLIR based converter the model is converted but dilated convolution breaks down into spacetodepth, conv2d and depth to space and then does not apply quantization to conv2d, I am not sure if that is happening because of MLIR conversion or the qat quant nodes are actually not inserted properly. However, I did not have this issue with TF 1.15."]}]